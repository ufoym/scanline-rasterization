#include "filter_bspline2.h"

//=============================================================================//
//================================= Lines =====================================//
//=============================================================================//

static void line_00(double *pixel, double *accum, Curve<2,2> *curve)
{
	const double &p00 = curve->p[0].v[0];
	const double &p01 = curve->p[0].v[1];
	const double &p10 = curve->p[1].v[0];
	const double &p11 = curve->p[1].v[1];
	const double p002 = p00*p00;
	const double p012 = p01*p01;
	const double p102 = p10*p10;
	const double p112 = p11*p11;
	const double p003 = p00*p002;
	const double p013 = p01*p012;
	const double p103 = p10*p102;
	const double p113 = p11*p112;
	*pixel = ((-1.0/720.0)*(p01+(-1.0*p11))*((3.0*p002*p10*((2.0*p012)+(2.0*p01*p11)+p112))+(p003*((10.0*p012)+(4.0*p01*p11)+p112))+(3.0*p00*p102*(p012+(2.0*p01*p11)+(2.0*p112)))+(p103*(p012+(4.0*p01*p11)+(10.0*p112)))));
	*accum = ((1.0/36.0)*((-1.0*p013)+p113));
}
static void line_10(double *pixel, double *accum, Curve<2,2> *curve)
{
	const double &p00 = curve->p[0].v[0];
	const double &p01 = curve->p[0].v[1];
	const double &p10 = curve->p[1].v[0];
	const double &p11 = curve->p[1].v[1];
	const double p002 = p00*p00;
	const double p012 = p01*p01;
	const double p102 = p10*p10;
	const double p112 = p11*p11;
	const double p003 = p00*p002;
	const double p013 = p01*p012;
	const double p103 = p10*p102;
	const double p113 = p11*p112;
	*pixel = ((1.0/720.0)*(p01+(-1.0*p11))*((2.0*p003*((10.0*p012)+(4.0*p01*p11)+p112))+(6.0*p002*((2.0*p012*(-3.0+p10))+(p01*(-3.0+(2.0*p10))*p11)+((-1.0+p10)*p112)))+(3.0*p00*((p012*(-15.0+(-6.0*p10)+(2.0*p102)))+(2.0*p01*(-5.0+(-4.0*p10)+(2.0*p102))*p11)+((-5.0+(-6.0*p10)+(4.0*p102))*p112)))+(p10*((p012*(-15.0+(-6.0*p10)+(2.0*p102)))+(2.0*p01*(-15.0+(-9.0*p10)+(4.0*p102))*p11)+((-45.0+(-36.0*p10)+(20.0*p102))*p112)))));
	*accum = ((1.0/9.0)*((-1.0*p013)+p113));
}
static void line_20(double *pixel, double *accum, Curve<2,2> *curve)
{
	const double &p00 = curve->p[0].v[0];
	const double &p01 = curve->p[0].v[1];
	const double &p10 = curve->p[1].v[0];
	const double &p11 = curve->p[1].v[1];
	const double p002 = p00*p00;
	const double p012 = p01*p01;
	const double p102 = p10*p10;
	const double p112 = p11*p11;
	const double p003 = p00*p002;
	const double p013 = p01*p012;
	const double p103 = p10*p102;
	const double p113 = p11*p112;
	*pixel = ((-1.0/720.0)*(p01+(-1.0*p11))*((p003*((10.0*p012)+(4.0*p01*p11)+p112))+(3.0*p002*((2.0*p012*(-6.0+p10))+(2.0*p01*(-3.0+p10)*p11)+((-2.0+p10)*p112)))+(3.0*p00*((p012*(15.0+(-6.0*p10)+p102))+(2.0*p01*(5.0+(-4.0*p10)+p102)*p11)+((5.0+(-6.0*p10)+(2.0*p102))*p112)))+(p10*((p012*(15.0+(-6.0*p10)+p102))+(2.0*p01*(15.0+(-9.0*p10)+(2.0*p102))*p11)+((45.0+(-36.0*p10)+(10.0*p102))*p112)))));
	*accum = ((1.0/36.0)*((-1.0*p013)+p113));
}
static void line_01(double *pixel, double *accum, Curve<2,2> *curve)
{
	const double &p00 = curve->p[0].v[0];
	const double &p01 = curve->p[0].v[1];
	const double &p10 = curve->p[1].v[0];
	const double &p11 = curve->p[1].v[1];
	const double p002 = p00*p00;
	const double p012 = p01*p01;
	const double p102 = p10*p10;
	const double p112 = p11*p11;
	const double p003 = p00*p002;
	const double p013 = p01*p012;
	const double p103 = p10*p102;
	const double p113 = p11*p112;
	*pixel = ((1.0/720.0)*(p01+(-1.0*p11))*((p003*(-15.0+(20.0*p012)+(8.0*p01*(-3.0+p11))+(-6.0*p11)+(2.0*p112)))+(3.0*p00*p102*(-5.0+(2.0*p012)+(4.0*p01*(-1.0+p11))+(-6.0*p11)+(4.0*p112)))+(3.0*p002*p10*(-5.0+(4.0*p012)+(-4.0*p11)+(2.0*p112)+(p01*(-6.0+(4.0*p11)))))+(p103*(-15.0+(2.0*p012)+(-24.0*p11)+(20.0*p112)+(p01*(-6.0+(8.0*p11)))))));
	*accum = ((1.0/36.0)*(p01+(-1.0*p11))*(-3.0+(2.0*p012)+(-3.0*p11)+(2.0*p112)+(p01*(-3.0+(2.0*p11)))));
}
static void line_11(double *pixel, double *accum, Curve<2,2> *curve)
{
	const double &p00 = curve->p[0].v[0];
	const double &p01 = curve->p[0].v[1];
	const double &p10 = curve->p[1].v[0];
	const double &p11 = curve->p[1].v[1];
	const double p002 = p00*p00;
	const double p012 = p01*p01;
	const double p102 = p10*p10;
	const double p112 = p11*p11;
	const double p003 = p00*p002;
	const double p013 = p01*p012;
	const double p103 = p10*p102;
	const double p113 = p11*p112;
	*pixel = ((-1.0/360.0)*(p01+(-1.0*p11))*((p003*(-15.0+(20.0*p012)+(8.0*p01*(-3.0+p11))+(-6.0*p11)+(2.0*p112)))+(3.0*p00*((p012*(-15.0+(-6.0*p10)+(2.0*p102)))+(2.0*p01*((p10*(5.0+(-4.0*p11)))+(-5.0*(-2.0+p11))+(2.0*p102*(-1.0+p11))))+(p10*(10.0+(10.0*p11)+(-6.0*p112)))+(-5.0*(-3.0+(-2.0*p11)+p112))+(p102*(-5.0+(-6.0*p11)+(4.0*p112)))))+(3.0*p002*(10.0+(4.0*p012*(-3.0+p10))+(5.0*p11)+(-2.0*p112)+(p10*(-5.0+(-4.0*p11)+(2.0*p112)))+(p01*(15.0+(-6.0*p11)+(p10*(-6.0+(4.0*p11)))))))+(p10*(45.0+(p012*(-15.0+(-6.0*p10)+(2.0*p102)))+(60.0*p11)+(-45.0*p112)+(p10*(30.0+(45.0*p11)+(-36.0*p112)))+(p102*(-15.0+(-24.0*p11)+(20.0*p112)))+(p01*((-30.0*(-1.0+p11))+(-3.0*p10*(-5.0+(6.0*p11)))+(p102*(-6.0+(8.0*p11)))))))));
	*accum = ((1.0/9.0)*(p01+(-1.0*p11))*(-3.0+(2.0*p012)+(-3.0*p11)+(2.0*p112)+(p01*(-3.0+(2.0*p11)))));
}
static void line_21(double *pixel, double *accum, Curve<2,2> *curve)
{
	const double &p00 = curve->p[0].v[0];
	const double &p01 = curve->p[0].v[1];
	const double &p10 = curve->p[1].v[0];
	const double &p11 = curve->p[1].v[1];
	const double p002 = p00*p00;
	const double p012 = p01*p01;
	const double p102 = p10*p10;
	const double p112 = p11*p11;
	const double p003 = p00*p002;
	const double p013 = p01*p012;
	const double p103 = p10*p102;
	const double p113 = p11*p112;
	*pixel = ((1.0/720.0)*(p01+(-1.0*p11))*((p003*(-15.0+(20.0*p012)+(8.0*p01*(-3.0+p11))+(-6.0*p11)+(2.0*p112)))+(3.0*p00*((2.0*p012*(15.0+(-6.0*p10)+p102))+(4.0*p01*((p10*(5.0+(-4.0*p11)))+(5.0*(-2.0+p11))+(p102*(-1.0+p11))))+(10.0*(-3.0+(-2.0*p11)+p112))+(-4.0*p10*(-5.0+(-5.0*p11)+(3.0*p112)))+(p102*(-5.0+(-6.0*p11)+(4.0*p112)))))+(3.0*p002*(20.0+(4.0*p012*(-6.0+p10))+(10.0*p11)+(-4.0*p112)+(p10*(-5.0+(-4.0*p11)+(2.0*p112)))+(2.0*p01*(15.0+(-6.0*p11)+(p10*(-3.0+(2.0*p11)))))))+(p10*((2.0*p012*(15.0+(-6.0*p10)+p102))+(p10*(60.0+(90.0*p11)+(-72.0*p112)))+(30.0*(-3.0+(-4.0*p11)+(3.0*p112)))+(p102*(-15.0+(-24.0*p11)+(20.0*p112)))+(p01*((60.0*(-1.0+p11))+(-6.0*p10*(-5.0+(6.0*p11)))+(p102*(-6.0+(8.0*p11)))))))));
	*accum = ((1.0/36.0)*(p01+(-1.0*p11))*(-3.0+(2.0*p012)+(-3.0*p11)+(2.0*p112)+(p01*(-3.0+(2.0*p11)))));
}
static void line_02(double *pixel, double *accum, Curve<2,2> *curve)
{
	const double &p00 = curve->p[0].v[0];
	const double &p01 = curve->p[0].v[1];
	const double &p10 = curve->p[1].v[0];
	const double &p11 = curve->p[1].v[1];
	const double p002 = p00*p00;
	const double p012 = p01*p01;
	const double p102 = p10*p10;
	const double p112 = p11*p11;
	const double p003 = p00*p002;
	const double p013 = p01*p012;
	const double p103 = p10*p102;
	const double p113 = p11*p112;
	*pixel = ((-1.0/720.0)*(p01+(-1.0*p11))*((p003*(15.0+(10.0*p012)+(4.0*p01*(-6.0+p11))+(-6.0*p11)+p112))+(3.0*p002*p10*(5.0+(2.0*p012)+(2.0*p01*(-3.0+p11))+(-4.0*p11)+p112))+(3.0*p00*p102*(5.0+p012+(2.0*p01*(-2.0+p11))+(-6.0*p11)+(2.0*p112)))+(p103*(15.0+p012+(-24.0*p11)+(10.0*p112)+(p01*(-6.0+(4.0*p11)))))));
	*accum = ((-1.0/36.0)*(p01+(-1.0*p11))*(3.0+p012+(p01*(-3.0+p11))+(-3.0*p11)+p112));
}
static void line_12(double *pixel, double *accum, Curve<2,2> *curve)
{
	const double &p00 = curve->p[0].v[0];
	const double &p01 = curve->p[0].v[1];
	const double &p10 = curve->p[1].v[0];
	const double &p11 = curve->p[1].v[1];
	const double p002 = p00*p00;
	const double p012 = p01*p01;
	const double p102 = p10*p10;
	const double p112 = p11*p11;
	const double p003 = p00*p002;
	const double p013 = p01*p012;
	const double p103 = p10*p102;
	const double p113 = p11*p112;
	*pixel = ((1.0/720.0)*(p01+(-1.0*p11))*((2.0*p003*(15.0+(10.0*p012)+(4.0*p01*(-6.0+p11))+(-6.0*p11)+p112))+(6.0*p002*(-10.0+(2.0*p012*(-3.0+p10))+(p01*((-3.0*(-5.0+p11))+(2.0*p10*(-3.0+p11))))+(5.0*p11)+(-1.0*p112)+(p10*(5.0+(-4.0*p11)+p112))))+(3.0*p00*((p012*(-15.0+(-6.0*p10)+(2.0*p102)))+(2.0*p01*((p10*(10.0+(-4.0*p11)))+(-5.0*(-4.0+p11))+(2.0*p102*(-2.0+p11))))+(p10*(-20.0+(20.0*p11)+(-6.0*p112)))+(-5.0*(6.0+(-4.0*p11)+p112))+(2.0*p102*(5.0+(-6.0*p11)+(2.0*p112)))))+(p10*((p012*(-15.0+(-6.0*p10)+(2.0*p102)))+(-15.0*(6.0+(-8.0*p11)+(3.0*p112)))+(-6.0*p10*(10.0+(-15.0*p11)+(6.0*p112)))+(p102*(30.0+(-48.0*p11)+(20.0*p112)))+(2.0*p01*((p10*(15.0+(-9.0*p11)))+(-15.0*(-2.0+p11))+(p102*(-6.0+(4.0*p11)))))))));
	*accum = ((-1.0/9.0)*(p01+(-1.0*p11))*(3.0+p012+(p01*(-3.0+p11))+(-3.0*p11)+p112));
}
static void line_22(double *pixel, double *accum, Curve<2,2> *curve)
{
	const double &p00 = curve->p[0].v[0];
	const double &p01 = curve->p[0].v[1];
	const double &p10 = curve->p[1].v[0];
	const double &p11 = curve->p[1].v[1];
	const double p002 = p00*p00;
	const double p012 = p01*p01;
	const double p102 = p10*p10;
	const double p112 = p11*p11;
	const double p003 = p00*p002;
	const double p013 = p01*p012;
	const double p103 = p10*p102;
	const double p113 = p11*p112;
	*pixel = ((-1.0/720.0)*(p01+(-1.0*p11))*((p003*(15.0+(10.0*p012)+(4.0*p01*(-6.0+p11))+(-6.0*p11)+p112))+(3.0*p002*((2.0*p012*(-6.0+p10))+(2.0*p01*((-3.0*(-5.0+p11))+(p10*(-3.0+p11))))+(-2.0*(10.0+(-5.0*p11)+p112))+(p10*(5.0+(-4.0*p11)+p112))))+(3.0*p00*((p012*(15.0+(-6.0*p10)+p102))+(2.0*p01*((p10*(10.0+(-4.0*p11)))+(5.0*(-4.0+p11))+(p102*(-2.0+p11))))+(p10*(-20.0+(20.0*p11)+(-6.0*p112)))+(5.0*(6.0+(-4.0*p11)+p112))+(p102*(5.0+(-6.0*p11)+(2.0*p112)))))+(p10*((p012*(15.0+(-6.0*p10)+p102))+(15.0*(6.0+(-8.0*p11)+(3.0*p112)))+(-6.0*p10*(10.0+(-15.0*p11)+(6.0*p112)))+(p102*(15.0+(-24.0*p11)+(10.0*p112)))+(2.0*p01*((p10*(15.0+(-9.0*p11)))+(15.0*(-2.0+p11))+(p102*(-3.0+(2.0*p11)))))))));
	*accum = ((-1.0/36.0)*(p01+(-1.0*p11))*(3.0+p012+(p01*(-3.0+p11))+(-3.0*p11)+p112));
}



//=============================================================================//
//=============================== Quadratics ==================================//
//=============================================================================//

static void quad_00(double *pixel, double *accum, Curve<3,2> *curve)
{
	const double &p00 = curve->p[0].v[0];
	const double &p01 = curve->p[0].v[1];
	const double &p10 = curve->p[1].v[0];
	const double &p11 = curve->p[1].v[1];
	const double &p20 = curve->p[2].v[0];
	const double &p21 = curve->p[2].v[1];
	const double p002 = p00*p00;
	const double p012 = p01*p01;
	const double p102 = p10*p10;
	const double p112 = p11*p11;
	const double p202 = p20*p20;
	const double p212 = p21*p21;
	const double p003 = p00*p002;
	const double p013 = p01*p012;
	const double p103 = p10*p102;
	const double p113 = p11*p112;
	const double p203 = p20*p202;
	const double p213 = p21*p212;
	*pixel = ((1.0/166320.0)*((-1.0*p013*((112.0*p103)+(84.0*p102*p20)+(30.0*p10*p202)+(5.0*p203)))+(-3.0*p012*((8.0*p103*((7.0*p11)+p21))+(4.0*p102*p20*((18.0*p11)+(5.0*p21)))+(p203*((10.0*p11)+(7.0*p21)))+(2.0*p10*p202*((20.0*p11)+(9.0*p21)))))+(p003*((-2310.0*p013)+(112.0*p113)+(84.0*p112*p21)+(30.0*p11*p212)+(5.0*p213)+(126.0*p012*((10.0*p11)+p21))+(21.0*p01*((24.0*p112)+(8.0*p11*p21)+p212))))+(-6.0*p01*((8.0*p102*p11*p20*((5.0*p11)+(3.0*p21)))+(4.0*p103*((4.0*p112)+(-1.0*p212)))+(7.0*p203*((2.0*p112)+(4.0*p11*p21)+(3.0*p212)))+(2.0*p10*p202*((18.0*p112)+(21.0*p11*p21)+(7.0*p212)))))+(2.0*((4.0*p103*p21*((12.0*p112)+(21.0*p11*p21)+(14.0*p212)))+(-7.0*p203*((8.0*p113)+(36.0*p112*p21)+(90.0*p11*p212)+(-165.0*p213)))+(-42.0*p10*p202*((2.0*p113)+(4.0*p112*p21)+(-15.0*p213)))+(12.0*p102*p20*((-4.0*p113)+(14.0*p11*p212)+(21.0*p213)))))+(3.0*p002*((-42.0*p013*((10.0*p10)+p20))+(-28.0*p012*((p11*p20)+(-1.0*p10*p21)))+(2.0*p10*((28.0*p113)+(36.0*p112*p21)+(20.0*p11*p212)+(5.0*p213)))+(p20*((8.0*p113)+(20.0*p112*p21)+(18.0*p11*p212)+(7.0*p213)))+(p01*((p20*p21*((12.0*p11)+(5.0*p21)))+(2.0*p10*((56.0*p112)+(42.0*p11*p21)+(9.0*p212)))))))+(-3.0*p00*((7.0*p013*((24.0*p102)+(8.0*p10*p20)+p202))+(p012*((112.0*p102*p11)+(12.0*p10*p20*((7.0*p11)+p21))+(p202*((18.0*p11)+(5.0*p21)))))+(-4.0*p01*((-1.0*p11*p202*((5.0*p11)+(3.0*p21)))+(p102*p21*((12.0*p11)+(5.0*p21)))+(3.0*p10*p20*((-4.0*p112)+p212))))+(-2.0*((2.0*p10*p20*p21*((12.0*p112)+(21.0*p11*p21)+(14.0*p212)))+(2.0*p102*((8.0*p113)+(20.0*p112*p21)+(18.0*p11*p212)+(7.0*p213)))+(p202*((-4.0*p113)+(14.0*p11*p212)+(21.0*p213)))))))));
	*accum = ((1.0/36.0)*((-1.0*p013)+p213));
}
static void quad_10(double *pixel, double *accum, Curve<3,2> *curve)
{
	const double &p00 = curve->p[0].v[0];
	const double &p01 = curve->p[0].v[1];
	const double &p10 = curve->p[1].v[0];
	const double &p11 = curve->p[1].v[1];
	const double &p20 = curve->p[2].v[0];
	const double &p21 = curve->p[2].v[1];
	const double p002 = p00*p00;
	const double p012 = p01*p01;
	const double p102 = p10*p10;
	const double p112 = p11*p11;
	const double p202 = p20*p20;
	const double p212 = p21*p21;
	const double p003 = p00*p002;
	const double p013 = p01*p012;
	const double p103 = p10*p102;
	const double p113 = p11*p112;
	const double p203 = p20*p202;
	const double p213 = p21*p212;
	*pixel = ((1.0/166320.0)*((-792.0*p113*p20)+(-528.0*p10*p113*p20)+(192.0*p102*p113*p20)+(-528.0*p113*p202)+(336.0*p10*p113*p202)+(224.0*p113*p203)+(p013*((224.0*p103)+(84.0*p102*(-11.0+(2.0*p20)))+(6.0*p10*(-495.0+(-66.0*p20)+(10.0*p202)))+(p20*(-495.0+(-66.0*p20)+(10.0*p202)))))+(792.0*p10*p112*p21)+(528.0*p102*p112*p21)+(-192.0*p103*p112*p21)+(-1980.0*p112*p20*p21)+(-528.0*p10*p112*p20*p21)+(-1848.0*p112*p202*p21)+(672.0*p10*p112*p202*p21)+(1008.0*p112*p203*p21)+(1980.0*p10*p11*p212)+(1056.0*p102*p11*p212)+(-336.0*p103*p11*p212)+(-2970.0*p11*p20*p212)+(924.0*p10*p11*p20*p212)+(-672.0*p102*p11*p20*p212)+(-3696.0*p11*p202*p212)+(2520.0*p11*p203*p212)+(2970.0*p10*p213)+(924.0*p102*p213)+(-224.0*p103*p213)+(10395.0*p20*p213)+(3696.0*p10*p20*p213)+(-1008.0*p102*p20*p213)+(8316.0*p202*p213)+(-2520.0*p10*p202*p213)+(-4620.0*p203*p213)+(3.0*p012*((16.0*p103*((7.0*p11)+p21))+(4.0*p102*((4.0*p11*(-22.0+(9.0*p20)))+((-11.0+(10.0*p20))*p21)))+(p20*((p11*(-330.0+(-88.0*p20)+(20.0*p202)))+((-99.0+(-44.0*p20)+(14.0*p202))*p21)))+(p10*((4.0*p11*(-165.0+(-77.0*p20)+(20.0*p202)))+(2.0*(-33.0+(-44.0*p20)+(18.0*p202))*p21)))))+(2.0*p003*((2310.0*p013)+(-112.0*p113)+(-84.0*p112*p21)+(-30.0*p11*p212)+(-5.0*p213)+(-126.0*p012*((10.0*p11)+p21))+(-21.0*p01*((24.0*p112)+(8.0*p11*p21)+p212))))+(6.0*p002*((-8.0*p113*(-11.0+(7.0*p10)+p20))+(42.0*p013*(-33.0+(10.0*p10)+p20))+(-4.0*p112*(-22.0+(18.0*p10)+(5.0*p20))*p21)+(-2.0*p11*(-22.0+(20.0*p10)+(9.0*p20))*p212)+((11.0+(-10.0*p10)+(-7.0*p20))*p213)+(7.0*p012*((4.0*p11*(22.0+p20))+((11.0+(-4.0*p10))*p21)))+(-1.0*p01*((28.0*(-11.0+(4.0*p10))*p112)+(12.0*p11*(-11.0+(7.0*p10)+p20)*p21)+((-22.0+(18.0*p10)+(5.0*p20))*p212)))))+(3.0*p00*((-8.0*p113*(-33.0+(-22.0*p10)+(8.0*p102)+(-2.0*p202)))+(7.0*p013*(-495.0+(48.0*p102)+(16.0*p10*(-11.0+p20))+(-22.0*p20)+(2.0*p202)))+(-4.0*p112*(-99.0+(-88.0*p10)+(40.0*p102)+(-22.0*p20)+(24.0*p10*p20))*p21)+(-2.0*p11*(-165.0+(-154.0*p10)+(72.0*p102)+(-88.0*p20)+(84.0*p10*p20)+(28.0*p202))*p212)+((165.0+(132.0*p10)+(-56.0*p102)+(154.0*p20)+(-112.0*p10*p20)+(-84.0*p202))*p213)+(p012*((2.0*p11*(495.0+(-154.0*p10)+(112.0*p102)+(-88.0*p20)+(84.0*p10*p20)+(18.0*p202)))+((165.0+(44.0*p10)+(-22.0*p20)+(24.0*p10*p20)+(10.0*p202))*p21)))+(p01*((4.0*p112*(165.0+(44.0*p10)+(-22.0*p20)+(24.0*p10*p20)+(10.0*p202)))+(12.0*p11*(33.0+(22.0*p10)+(-8.0*p102)+(2.0*p202))*p21)+((99.0+(88.0*p10)+(-40.0*p102)+(22.0*p20)+(-24.0*p10*p20))*p212)))))+(3.0*p01*((16.0*p103*((4.0*p112)+(-1.0*p212)))+(4.0*p102*((p112*(-44.0+(40.0*p20)))+(24.0*p11*p20*p21)+(11.0*p212)))+(2.0*p10*((4.0*p112*(-33.0+(-44.0*p20)+(18.0*p202)))+(12.0*p11*p20*(-11.0+(7.0*p20))*p21)+((33.0+(-22.0*p20)+(28.0*p202))*p212)))+(p20*((4.0*p112*(-99.0+(-44.0*p20)+(14.0*p202)))+(4.0*p11*(-99.0+(-66.0*p20)+(28.0*p202))*p21)+((-165.0+(-154.0*p20)+(84.0*p202))*p212)))))));
	*accum = ((1.0/9.0)*((-1.0*p013)+p213));
}
static void quad_20(double *pixel, double *accum, Curve<3,2> *curve)
{
	const double &p00 = curve->p[0].v[0];
	const double &p01 = curve->p[0].v[1];
	const double &p10 = curve->p[1].v[0];
	const double &p11 = curve->p[1].v[1];
	const double &p20 = curve->p[2].v[0];
	const double &p21 = curve->p[2].v[1];
	const double p002 = p00*p00;
	const double p012 = p01*p01;
	const double p102 = p10*p10;
	const double p112 = p11*p11;
	const double p202 = p20*p20;
	const double p212 = p21*p21;
	const double p003 = p00*p002;
	const double p013 = p01*p012;
	const double p103 = p10*p102;
	const double p113 = p11*p112;
	const double p203 = p20*p202;
	const double p213 = p21*p212;
	*pixel = ((1.0/166320.0)*((-792.0*p113*p20)+(528.0*p10*p113*p20)+(-96.0*p102*p113*p20)+(528.0*p113*p202)+(-168.0*p10*p113*p202)+(-112.0*p113*p203)+(-1.0*p013*((112.0*p103)+(84.0*p102*(-11.0+p20))+(6.0*p10*(495.0+(-66.0*p20)+(5.0*p202)))+(p20*(495.0+(-66.0*p20)+(5.0*p202)))))+(792.0*p10*p112*p21)+(-528.0*p102*p112*p21)+(96.0*p103*p112*p21)+(-1980.0*p112*p20*p21)+(528.0*p10*p112*p20*p21)+(1848.0*p112*p202*p21)+(-336.0*p10*p112*p202*p21)+(-504.0*p112*p203*p21)+(1980.0*p10*p11*p212)+(-1056.0*p102*p11*p212)+(168.0*p103*p11*p212)+(-2970.0*p11*p20*p212)+(-924.0*p10*p11*p20*p212)+(336.0*p102*p11*p20*p212)+(3696.0*p11*p202*p212)+(-1260.0*p11*p203*p212)+(2970.0*p10*p213)+(-924.0*p102*p213)+(112.0*p103*p213)+(10395.0*p20*p213)+(-3696.0*p10*p20*p213)+(504.0*p102*p20*p213)+(-8316.0*p202*p213)+(1260.0*p10*p202*p213)+(2310.0*p203*p213)+(-3.0*p012*((8.0*p103*((7.0*p11)+p21))+(4.0*p102*((2.0*p11*(-44.0+(9.0*p20)))+((-11.0+(5.0*p20))*p21)))+(p20*((2.0*p11*(165.0+(-44.0*p20)+(5.0*p202)))+((99.0+(-44.0*p20)+(7.0*p202))*p21)))+(2.0*p10*((2.0*p11*(165.0+(-77.0*p20)+(10.0*p202)))+((33.0+(-44.0*p20)+(9.0*p202))*p21)))))+(p003*((-2310.0*p013)+(112.0*p113)+(84.0*p112*p21)+(30.0*p11*p212)+(5.0*p213)+(126.0*p012*((10.0*p11)+p21))+(21.0*p01*((24.0*p112)+(8.0*p11*p21)+p212))))+(-3.0*p002*((-8.0*p113*(-22.0+(7.0*p10)+p20))+(42.0*p013*(-66.0+(10.0*p10)+p20))+(-4.0*p112*(-44.0+(18.0*p10)+(5.0*p20))*p21)+(-2.0*p11*(-44.0+(20.0*p10)+(9.0*p20))*p212)+((22.0+(-10.0*p10)+(-7.0*p20))*p213)+(14.0*p012*((2.0*p11*(44.0+p20))+((11.0+(-2.0*p10))*p21)))+(-1.0*p01*((56.0*(-11.0+(2.0*p10))*p112)+(12.0*p11*(-22.0+(7.0*p10)+p20)*p21)+((-44.0+(18.0*p10)+(5.0*p20))*p212)))))+(-3.0*p00*((-8.0*p113*(33.0+(-22.0*p10)+(4.0*p102)+(-1.0*p202)))+(7.0*p013*(495.0+(24.0*p102)+(8.0*p10*(-22.0+p20))+(-22.0*p20)+p202))+(-4.0*p112*(99.0+(-88.0*p10)+(20.0*p102)+(-22.0*p20)+(12.0*p10*p20))*p21)+(-2.0*p11*(165.0+(-154.0*p10)+(36.0*p102)+(-88.0*p20)+(42.0*p10*p20)+(14.0*p202))*p212)+(-1.0*(165.0+(-132.0*p10)+(28.0*p102)+(-154.0*p20)+(56.0*p10*p20)+(42.0*p202))*p213)+(p012*((2.0*p11*(-495.0+(-154.0*p10)+(56.0*p102)+(-88.0*p20)+(42.0*p10*p20)+(9.0*p202)))+((-165.0+(44.0*p10)+(-22.0*p20)+(12.0*p10*p20)+(5.0*p202))*p21)))+(p01*((4.0*p112*(-165.0+(44.0*p10)+(-22.0*p20)+(12.0*p10*p20)+(5.0*p202)))+(-12.0*p11*(33.0+(-22.0*p10)+(4.0*p102)+(-1.0*p202))*p21)+((-99.0+(88.0*p10)+(-20.0*p102)+(22.0*p20)+(-12.0*p10*p20))*p212)))))+(-3.0*p01*((8.0*p103*((4.0*p112)+(-1.0*p212)))+(4.0*p102*((4.0*p112*(-11.0+(5.0*p20)))+(12.0*p11*p20*p21)+(11.0*p212)))+(p10*((8.0*p112*(33.0+(-44.0*p20)+(9.0*p202)))+(12.0*p11*p20*(-22.0+(7.0*p20))*p21)+(2.0*(-33.0+(-22.0*p20)+(14.0*p202))*p212)))+(p20*((4.0*p112*(99.0+(-44.0*p20)+(7.0*p202)))+(4.0*p11*(99.0+(-66.0*p20)+(14.0*p202))*p21)+((165.0+(-154.0*p20)+(42.0*p202))*p212)))))));
	*accum = ((1.0/36.0)*((-1.0*p013)+p213));
}
static void quad_01(double *pixel, double *accum, Curve<3,2> *curve)
{
	const double &p00 = curve->p[0].v[0];
	const double &p01 = curve->p[0].v[1];
	const double &p10 = curve->p[1].v[0];
	const double &p11 = curve->p[1].v[1];
	const double &p20 = curve->p[2].v[0];
	const double &p21 = curve->p[2].v[1];
	const double p002 = p00*p00;
	const double p012 = p01*p01;
	const double p102 = p10*p10;
	const double p112 = p11*p11;
	const double p202 = p20*p20;
	const double p212 = p21*p21;
	const double p003 = p00*p002;
	const double p013 = p01*p012;
	const double p103 = p10*p102;
	const double p113 = p11*p112;
	const double p203 = p20*p202;
	const double p213 = p21*p212;
	*pixel = ((1.0/166320.0)*((-792.0*p102*p11*p20)+(-528.0*p102*p112*p20)+(192.0*p102*p113*p20)+(-1980.0*p10*p11*p202)+(-1056.0*p10*p112*p202)+(336.0*p10*p113*p202)+(-2970.0*p11*p203)+(-924.0*p112*p203)+(224.0*p113*p203)+(2.0*p013*((112.0*p103)+(84.0*p102*p20)+(30.0*p10*p202)+(5.0*p203)))+(792.0*p103*p21)+(528.0*p103*p11*p21)+(-192.0*p103*p112*p21)+(1980.0*p102*p20*p21)+(528.0*p102*p11*p20*p21)+(2970.0*p10*p202*p21)+(-924.0*p10*p11*p202*p21)+(672.0*p10*p112*p202*p21)+(3465.0*p203*p21)+(-3696.0*p11*p203*p21)+(1008.0*p112*p203*p21)+(528.0*p103*p212)+(-336.0*p103*p11*p212)+(1848.0*p102*p20*p212)+(-672.0*p102*p11*p20*p212)+(3696.0*p10*p202*p212)+(5544.0*p203*p212)+(2520.0*p11*p203*p212)+(-224.0*p103*p213)+(-1008.0*p102*p20*p213)+(-2520.0*p10*p202*p213)+(-4620.0*p203*p213)+(6.0*p012*((8.0*p103*(-11.0+(7.0*p11)+p21))+(4.0*p102*p20*(-22.0+(18.0*p11)+(5.0*p21)))+(p203*(-11.0+(10.0*p11)+(7.0*p21)))+(2.0*p10*p202*(-22.0+(20.0*p11)+(9.0*p21)))))+(p003*((4620.0*p013)+(-224.0*p113)+(-252.0*p012*(22.0+(10.0*p11)+p21))+(-84.0*p112*(-11.0+(2.0*p21)))+(p11*(2970.0+(396.0*p21)+(-60.0*p212)))+(p21*(495.0+(66.0*p21)+(-10.0*p212)))+(-21.0*p01*(165.0+(48.0*p112)+(16.0*p11*(-11.0+p21))+(-22.0*p21)+(2.0*p212)))))+(3.0*p01*((4.0*p102*p20*(-99.0+(-88.0*p11)+(40.0*p112)+(-22.0*p21)+(24.0*p11*p21)))+(8.0*p103*(-33.0+(-22.0*p11)+(8.0*p112)+(-2.0*p212)))+(2.0*p10*p202*(-165.0+(72.0*p112)+(-88.0*p21)+(28.0*p212)+(14.0*p11*(-11.0+(6.0*p21)))))+(p203*(-165.0+(56.0*p112)+(-154.0*p21)+(84.0*p212)+(4.0*p11*(-33.0+(28.0*p21)))))))+(3.0*p002*((84.0*p013*((10.0*p10)+p20))+(-14.0*p012*(((11.0+(-4.0*p11))*p20)+(4.0*p10*(22.0+p21))))+(p20*((-16.0*p113)+(p112*(44.0+(-40.0*p21)))+(p11*(66.0+(88.0*p21)+(-36.0*p212)))+(p21*(99.0+(44.0*p21)+(-14.0*p212)))))+(p10*((-112.0*p113)+(-16.0*p112*(-22.0+(9.0*p21)))+(p11*(660.0+(308.0*p21)+(-80.0*p212)))+(2.0*p21*(165.0+(44.0*p21)+(-10.0*p212)))))+(-1.0*p01*((p20*(165.0+(44.0*p11)+(-22.0*p21)+(24.0*p11*p21)+(10.0*p212)))+(2.0*p10*(495.0+(-154.0*p11)+(112.0*p112)+(-88.0*p21)+(84.0*p11*p21)+(18.0*p212)))))))+(3.0*p00*((14.0*p013*((24.0*p102)+(8.0*p10*p20)+p202))+(2.0*p012*((28.0*p102*(-11.0+(4.0*p11)))+(12.0*p10*p20*(-11.0+(7.0*p11)+p21))+(p202*(-22.0+(18.0*p11)+(5.0*p21)))))+(-4.0*p10*p20*p21*(-99.0+(24.0*p112)+(-66.0*p21)+(28.0*p212)+(6.0*p11*(-11.0+(7.0*p21)))))+(p202*((-44.0*p112)+(16.0*p113)+(p21*(165.0+(154.0*p21)+(-84.0*p212)))+(p11*(-66.0+(44.0*p21)+(-56.0*p212)))))+(-1.0*p01*((p202*(99.0+(88.0*p11)+(-40.0*p112)+(22.0*p21)+(-24.0*p11*p21)))+(12.0*p10*p20*(33.0+(22.0*p11)+(-8.0*p112)+(2.0*p212)))+(4.0*p102*(165.0+(44.0*p11)+(-22.0*p21)+(24.0*p11*p21)+(10.0*p212)))))+(-4.0*p102*((16.0*p113)+(p112*(-44.0+(40.0*p21)))+(p21*(-99.0+(-44.0*p21)+(14.0*p212)))+(p11*(-66.0+(-88.0*p21)+(36.0*p212)))))))));
	*accum = ((1.0/36.0)*((-3.0*p01)+(-3.0*p012)+(2.0*p013)+(p21*(3.0+(3.0*p21)+(-2.0*p212)))));
}
static void quad_11(double *pixel, double *accum, Curve<3,2> *curve)
{
	const double &p00 = curve->p[0].v[0];
	const double &p01 = curve->p[0].v[1];
	const double &p10 = curve->p[1].v[0];
	const double &p11 = curve->p[1].v[1];
	const double &p20 = curve->p[2].v[0];
	const double &p21 = curve->p[2].v[1];
	const double p002 = p00*p00;
	const double p012 = p01*p01;
	const double p102 = p10*p10;
	const double p112 = p11*p11;
	const double p202 = p20*p20;
	const double p212 = p21*p21;
	const double p003 = p00*p002;
	const double p013 = p01*p012;
	const double p103 = p10*p102;
	const double p113 = p11*p112;
	const double p203 = p20*p202;
	const double p213 = p21*p212;
	*pixel = ((1.0/83160.0)*((-6930.0*p11*p20)+(-2772.0*p10*p11*p20)+(792.0*p102*p11*p20)+(-2772.0*p112*p20)+(-1584.0*p10*p112*p20)+(528.0*p102*p112*p20)+(792.0*p113*p20)+(528.0*p10*p113*p20)+(-192.0*p102*p113*p20)+(-5544.0*p11*p202)+(1980.0*p10*p11*p202)+(-1980.0*p112*p202)+(1056.0*p10*p112*p202)+(528.0*p113*p202)+(-336.0*p10*p113*p202)+(2970.0*p11*p203)+(924.0*p112*p203)+(-224.0*p113*p203)+(p013*((-224.0*p103)+(-84.0*p102*(-11.0+(2.0*p20)))+(p10*(2970.0+(396.0*p20)+(-60.0*p202)))+(p20*(495.0+(66.0*p20)+(-10.0*p202)))))+(6930.0*p10*p21)+(2772.0*p102*p21)+(-792.0*p103*p21)+(2772.0*p10*p11*p21)+(1584.0*p102*p11*p21)+(-528.0*p103*p11*p21)+(-792.0*p10*p112*p21)+(-528.0*p102*p112*p21)+(192.0*p103*p112*p21)+(10395.0*p20*p21)+(5544.0*p10*p20*p21)+(-1980.0*p102*p20*p21)+(-5544.0*p11*p20*p21)+(-528.0*p102*p11*p20*p21)+(1980.0*p112*p20*p21)+(528.0*p10*p112*p20*p21)+(6930.0*p202*p21)+(-2970.0*p10*p202*p21)+(-5940.0*p11*p202*p21)+(924.0*p10*p11*p202*p21)+(1848.0*p112*p202*p21)+(-672.0*p10*p112*p202*p21)+(-3465.0*p203*p21)+(3696.0*p11*p203*p21)+(-1008.0*p112*p203*p21)+(5544.0*p10*p212)+(1980.0*p102*p212)+(-528.0*p103*p212)+(-1980.0*p10*p11*p212)+(-1056.0*p102*p11*p212)+(336.0*p103*p11*p212)+(13860.0*p20*p212)+(5940.0*p10*p20*p212)+(-1848.0*p102*p20*p212)+(2970.0*p11*p20*p212)+(-924.0*p10*p11*p20*p212)+(672.0*p102*p11*p20*p212)+(10395.0*p202*p212)+(-3696.0*p10*p202*p212)+(3696.0*p11*p202*p212)+(-5544.0*p203*p212)+(-2520.0*p11*p203*p212)+(-2970.0*p10*p213)+(-924.0*p102*p213)+(224.0*p103*p213)+(-10395.0*p20*p213)+(-3696.0*p10*p20*p213)+(1008.0*p102*p20*p213)+(-8316.0*p202*p213)+(2520.0*p10*p202*p213)+(4620.0*p203*p213)+(p003*((-4620.0*p013)+(224.0*p113)+(252.0*p012*(22.0+(10.0*p11)+p21))+(84.0*p112*(-11.0+(2.0*p21)))+(21.0*p01*(165.0+(48.0*p112)+(16.0*p11*(-11.0+p21))+(-22.0*p21)+(2.0*p212)))+(6.0*p11*(-495.0+(-66.0*p21)+(10.0*p212)))+(p21*(-495.0+(-66.0*p21)+(10.0*p212)))))+(-3.0*p012*((16.0*p103*(-11.0+(7.0*p11)+p21))+(4.0*p102*(165.0+(-44.0*p20)+(4.0*p11*(-22.0+(9.0*p20)))+(-11.0*p21)+(10.0*p20*p21)))+(p20*(462.0+(p11*(-330.0+(-88.0*p20)+(20.0*p202)))+(p20*(99.0+(-44.0*p21)))+(-99.0*p21)+(2.0*p202*(-11.0+(7.0*p21)))))+(2.0*p10*((2.0*p11*(-165.0+(-77.0*p20)+(20.0*p202)))+(-33.0*(-28.0+p21))+(-22.0*p20*(-9.0+(2.0*p21)))+(2.0*p202*(-22.0+(9.0*p21)))))))+(-3.0*p002*((-16.0*p113*(-11.0+(7.0*p10)+p20))+(84.0*p013*(-33.0+(10.0*p10)+p20))+(7.0*p012*(495.0+(-22.0*p20)+(8.0*p11*(22.0+p20))+(22.0*p21)+(-8.0*p10*(22.0+p21))))+(-4.0*p112*(165.0+(-44.0*p21)+(4.0*p10*(-22.0+(9.0*p21)))+(p20*(-11.0+(10.0*p21)))))+(p21*((p10*(330.0+(88.0*p21)+(-20.0*p212)))+(p20*(99.0+(44.0*p21)+(-14.0*p212)))+(11.0*(-42.0+(-9.0*p21)+(2.0*p212)))))+(p11*((p10*(660.0+(308.0*p21)+(-80.0*p212)))+(p20*(66.0+(88.0*p21)+(-36.0*p212)))+(44.0*(-42.0+(-9.0*p21)+(2.0*p212)))))+(-1.0*p01*(-2310.0+(-616.0*p112)+(165.0*p20)+(330.0*p21)+(-22.0*p20*p21)+(-44.0*p212)+(10.0*p20*p212)+(4.0*p11*(495.0+(11.0*p20)+(-66.0*p21)+(6.0*p20*p21)))+(2.0*p10*(495.0+(112.0*p112)+(-88.0*p21)+(18.0*p212)+(14.0*p11*(-11.0+(6.0*p21)))))))))+(-3.0*p01*((8.0*p103*(-33.0+(-22.0*p11)+(8.0*p112)+(-2.0*p212)))+(4.0*p102*((p112*(-44.0+(40.0*p20)))+(11.0*(21.0+p212+(-1.0*p20*(9.0+(2.0*p21)))))+(4.0*p11*(33.0+(p20*(-22.0+(6.0*p21)))))))+(2.0*p10*((4.0*p112*(-33.0+(-44.0*p20)+(18.0*p202)))+(33.0*(35.0+p212))+(-22.0*p20*(-21.0+(-6.0*p21)+p212))+(p202*(-165.0+(-88.0*p21)+(28.0*p212)))+(2.0*p11*(231.0+(-66.0*p20*(-3.0+p21))+(7.0*p202*(-11.0+(6.0*p21)))))))+(p20*((4.0*p112*(-99.0+(-44.0*p20)+(14.0*p202)))+(33.0*(35.0+(14.0*p21)+(-5.0*p212)))+(-22.0*p20*(-21.0+(-15.0*p21)+(7.0*p212)))+(p202*(-165.0+(-154.0*p21)+(84.0*p212)))+(4.0*p11*(231.0+(p20*(99.0+(-66.0*p21)))+(-99.0*p21)+(p202*(-33.0+(28.0*p21)))))))))+(-3.0*p00*((-8.0*p113*(-33.0+(-22.0*p10)+(8.0*p102)+(-2.0*p202)))+(7.0*p013*(-495.0+(48.0*p102)+(16.0*p10*(-11.0+p20))+(-22.0*p20)+(2.0*p202)))+(-4.0*p112*((p102*(-44.0+(40.0*p21)))+(11.0*(21.0+p202+(-9.0*p21)+(-2.0*p20*p21)))+(4.0*p10*(33.0+((-22.0+(6.0*p20))*p21)))))+(-2.0*p11*((-44.0*p20*p21*(-3.0+(2.0*p21)))+(33.0*(35.0+(14.0*p21)+(-5.0*p212)))+(4.0*p102*(-33.0+(-44.0*p21)+(18.0*p212)))+(p202*(33.0+(-22.0*p21)+(28.0*p212)))+(2.0*p10*(231.0+(-66.0*(-3.0+p20)*p21)+(7.0*(-11.0+(6.0*p20))*p212)))))+(p012*(4620.0+(56.0*p102*(-11.0+(4.0*p11)))+(330.0*p20)+(-44.0*p202)+(2.0*p11*(495.0+(-88.0*p20)+(18.0*p202)))+(165.0*p21)+(-22.0*p20*p21)+(10.0*p202*p21)+(4.0*p10*((7.0*p11*(-11.0+(6.0*p20)))+(6.0*p20*(-11.0+p21))+(11.0*(45.0+p21))))))+(p01*((p112*(660.0+(-88.0*p20)+(40.0*p202)))+(4.0*p11*(-462.0+(66.0*p20)+(99.0*p21)+(p202*(-22.0+(6.0*p21)))))+(-4.0*p102*(165.0+(-22.0*p21)+(10.0*p212)+(4.0*p11*(11.0+(6.0*p21)))))+(-11.0*(-315.0+(42.0*p21)+(-9.0*p212)+(p202*(9.0+(2.0*p21)))+(-2.0*p20*(21.0+p212))))+(4.0*p10*((4.0*p112*(11.0+(6.0*p20)))+(-66.0*p11*(p20+(-1.0*p21)))+(22.0*(21.0+(-3.0*p21)+p212))+(-3.0*p20*(33.0+(2.0*p212)))))))+(p21*((p202*(165.0+(154.0*p21)+(-84.0*p212)))+(p102*(396.0+(176.0*p21)+(-56.0*p212)))+(33.0*(-35.0+(-14.0*p21)+(5.0*p212)))+(22.0*p20*(-21.0+(-15.0*p21)+(7.0*p212)))+(-4.0*p10*((-33.0*(-7.0+(-3.0*p21)+p212))+(p20*(-99.0+(-66.0*p21)+(28.0*p212)))))))))));
	*accum = ((1.0/9.0)*((-3.0*p01)+(-3.0*p012)+(2.0*p013)+(p21*(3.0+(3.0*p21)+(-2.0*p212)))));
}
static void quad_21(double *pixel, double *accum, Curve<3,2> *curve)
{
	const double &p00 = curve->p[0].v[0];
	const double &p01 = curve->p[0].v[1];
	const double &p10 = curve->p[1].v[0];
	const double &p11 = curve->p[1].v[1];
	const double &p20 = curve->p[2].v[0];
	const double &p21 = curve->p[2].v[1];
	const double p002 = p00*p00;
	const double p012 = p01*p01;
	const double p102 = p10*p10;
	const double p112 = p11*p11;
	const double p202 = p20*p20;
	const double p212 = p21*p21;
	const double p003 = p00*p002;
	const double p013 = p01*p012;
	const double p103 = p10*p102;
	const double p113 = p11*p112;
	const double p203 = p20*p202;
	const double p213 = p21*p212;
	*pixel = ((1.0/166320.0)*((-13860.0*p11*p20)+(5544.0*p10*p11*p20)+(-792.0*p102*p11*p20)+(-5544.0*p112*p20)+(3168.0*p10*p112*p20)+(-528.0*p102*p112*p20)+(1584.0*p113*p20)+(-1056.0*p10*p113*p20)+(192.0*p102*p113*p20)+(11088.0*p11*p202)+(-1980.0*p10*p11*p202)+(3960.0*p112*p202)+(-1056.0*p10*p112*p202)+(-1056.0*p113*p202)+(336.0*p10*p113*p202)+(-2970.0*p11*p203)+(-924.0*p112*p203)+(224.0*p113*p203)+(2.0*p013*((112.0*p103)+(84.0*p102*(-11.0+p20))+(6.0*p10*(495.0+(-66.0*p20)+(5.0*p202)))+(p20*(495.0+(-66.0*p20)+(5.0*p202)))))+(13860.0*p10*p21)+(-5544.0*p102*p21)+(792.0*p103*p21)+(5544.0*p10*p11*p21)+(-3168.0*p102*p11*p21)+(528.0*p103*p11*p21)+(-1584.0*p10*p112*p21)+(1056.0*p102*p112*p21)+(-192.0*p103*p112*p21)+(20790.0*p20*p21)+(-11088.0*p10*p20*p21)+(1980.0*p102*p20*p21)+(-11088.0*p11*p20*p21)+(528.0*p102*p11*p20*p21)+(3960.0*p112*p20*p21)+(-1056.0*p10*p112*p20*p21)+(-13860.0*p202*p21)+(2970.0*p10*p202*p21)+(11880.0*p11*p202*p21)+(-924.0*p10*p11*p202*p21)+(-3696.0*p112*p202*p21)+(672.0*p10*p112*p202*p21)+(3465.0*p203*p21)+(-3696.0*p11*p203*p21)+(1008.0*p112*p203*p21)+(11088.0*p10*p212)+(-3960.0*p102*p212)+(528.0*p103*p212)+(-3960.0*p10*p11*p212)+(2112.0*p102*p11*p212)+(-336.0*p103*p11*p212)+(27720.0*p20*p212)+(-11880.0*p10*p20*p212)+(1848.0*p102*p20*p212)+(5940.0*p11*p20*p212)+(1848.0*p10*p11*p20*p212)+(-672.0*p102*p11*p20*p212)+(-20790.0*p202*p212)+(3696.0*p10*p202*p212)+(-7392.0*p11*p202*p212)+(5544.0*p203*p212)+(2520.0*p11*p203*p212)+(-5940.0*p10*p213)+(1848.0*p102*p213)+(-224.0*p103*p213)+(-20790.0*p20*p213)+(7392.0*p10*p20*p213)+(-1008.0*p102*p20*p213)+(16632.0*p202*p213)+(-2520.0*p10*p202*p213)+(-4620.0*p203*p213)+(p003*((4620.0*p013)+(-224.0*p113)+(-252.0*p012*(22.0+(10.0*p11)+p21))+(-84.0*p112*(-11.0+(2.0*p21)))+(p11*(2970.0+(396.0*p21)+(-60.0*p212)))+(p21*(495.0+(66.0*p21)+(-10.0*p212)))+(-21.0*p01*(165.0+(48.0*p112)+(16.0*p11*(-11.0+p21))+(-22.0*p21)+(2.0*p212)))))+(6.0*p012*((8.0*p103*(-11.0+(7.0*p11)+p21))+(4.0*p102*(165.0+(-22.0*p20)+(2.0*p11*(-44.0+(9.0*p20)))+(-11.0*p21)+(5.0*p20*p21)))+(p20*(-462.0+(2.0*p11*(165.0+(-44.0*p20)+(5.0*p202)))+(p20*(99.0+(-44.0*p21)))+(99.0*p21)+(p202*(-11.0+(7.0*p21)))))+(2.0*p10*((2.0*p11*(165.0+(-77.0*p20)+(10.0*p202)))+(33.0*(-28.0+p21))+(-22.0*p20*(-9.0+(2.0*p21)))+(p202*(-22.0+(9.0*p21)))))))+(3.0*p002*((-16.0*p113*(-22.0+(7.0*p10)+p20))+(84.0*p013*(-66.0+(10.0*p10)+p20))+(14.0*p012*((4.0*p11*(44.0+p20))+(-11.0*(-45.0+p20+(-2.0*p21)))+(-4.0*p10*(22.0+p21))))+(-4.0*p112*(330.0+(-88.0*p21)+(4.0*p10*(-22.0+(9.0*p21)))+(p20*(-11.0+(10.0*p21)))))+(p21*((p10*(330.0+(88.0*p21)+(-20.0*p212)))+(p20*(99.0+(44.0*p21)+(-14.0*p212)))+(22.0*(-42.0+(-9.0*p21)+(2.0*p212)))))+(p11*((p10*(660.0+(308.0*p21)+(-80.0*p212)))+(p20*(66.0+(88.0*p21)+(-36.0*p212)))+(88.0*(-42.0+(-9.0*p21)+(2.0*p212)))))+(-1.0*p01*(-4620.0+(-1232.0*p112)+(165.0*p20)+(660.0*p21)+(-22.0*p20*p21)+(-88.0*p212)+(10.0*p20*p212)+(4.0*p11*(990.0+(11.0*p20)+(-132.0*p21)+(6.0*p20*p21)))+(2.0*p10*(495.0+(112.0*p112)+(-88.0*p21)+(18.0*p212)+(14.0*p11*(-11.0+(6.0*p21)))))))))+(3.0*p01*((8.0*p103*(-33.0+(-22.0*p11)+(8.0*p112)+(-2.0*p212)))+(4.0*p102*((8.0*p112*(-11.0+(5.0*p20)))+(11.0*(42.0+(-9.0*p20)+(-2.0*p20*p21)+(2.0*p212)))+(8.0*p11*(33.0+(p20*(-11.0+(3.0*p21)))))))+(2.0*p10*((8.0*p112*(33.0+(-44.0*p20)+(9.0*p202)))+(-66.0*(35.0+p212))+(-44.0*p20*(-21.0+(-6.0*p21)+p212))+(p202*(-165.0+(-88.0*p21)+(28.0*p212)))+(2.0*p11*(-462.0+(-132.0*p20*(-3.0+p21))+(7.0*p202*(-11.0+(6.0*p21)))))))+(p20*((8.0*p112*(99.0+(-44.0*p20)+(7.0*p202)))+(66.0*(-35.0+(-14.0*p21)+(5.0*p212)))+(-44.0*p20*(-21.0+(-15.0*p21)+(7.0*p212)))+(p202*(-165.0+(-154.0*p21)+(84.0*p212)))+(4.0*p11*((-66.0*p20*(-3.0+(2.0*p21)))+(66.0*(-7.0+(3.0*p21)))+(p202*(-33.0+(28.0*p21)))))))))+(3.0*p00*((-16.0*p113*(33.0+(-22.0*p10)+(4.0*p102)+(-1.0*p202)))+(14.0*p013*(495.0+(24.0*p102)+(8.0*p10*(-22.0+p20))+(-22.0*p20)+p202))+(-4.0*p112*((p102*(-44.0+(40.0*p21)))+(11.0*(-42.0+p202+(18.0*p21)+(-4.0*p20*p21)))+(8.0*p10*(33.0+((-22.0+(3.0*p20))*p21)))))+(-2.0*p11*((-88.0*p20*p21*(-3.0+(2.0*p21)))+(66.0*(-35.0+(-14.0*p21)+(5.0*p212)))+(4.0*p102*(-33.0+(-44.0*p21)+(18.0*p212)))+(p202*(33.0+(-22.0*p21)+(28.0*p212)))+(4.0*p10*(231.0+(-33.0*(-6.0+p20)*p21)+(7.0*(-11.0+(3.0*p20))*p212)))))+(2.0*p012*(-4620.0+(28.0*p102*(-11.0+(4.0*p11)))+(330.0*p20)+(-22.0*p202)+(2.0*p11*(-495.0+(-88.0*p20)+(9.0*p202)))+(-165.0*p21)+(-22.0*p20*p21)+(5.0*p202*p21)+(4.0*p10*((7.0*p11*(-11.0+(3.0*p20)))+(3.0*p20*(-11.0+p21))+(11.0*(45.0+p21))))))+(-1.0*p01*((-8.0*p112*(-165.0+(-22.0*p20)+(5.0*p202)))+(-8.0*p11*(462.0+(66.0*p20)+(-99.0*p21)+(p202*(-11.0+(3.0*p21)))))+(4.0*p102*(165.0+(-22.0*p21)+(10.0*p212)+(4.0*p11*(11.0+(6.0*p21)))))+(11.0*(630.0+(-84.0*p21)+(18.0*p212)+(p202*(9.0+(2.0*p21)))+(-4.0*p20*(21.0+p212))))+(-4.0*p10*((8.0*p112*(11.0+(3.0*p20)))+(-66.0*p11*(p20+(-2.0*p21)))+(44.0*(21.0+(-3.0*p21)+p212))+(-3.0*p20*(33.0+(2.0*p212)))))))+(p21*((p202*(165.0+(154.0*p21)+(-84.0*p212)))+(p102*(396.0+(176.0*p21)+(-56.0*p212)))+(66.0*(35.0+(14.0*p21)+(-5.0*p212)))+(44.0*p20*(-21.0+(-15.0*p21)+(7.0*p212)))+(-4.0*p10*((-66.0*(-7.0+(-3.0*p21)+p212))+(p20*(-99.0+(-66.0*p21)+(28.0*p212)))))))))));
	*accum = ((1.0/36.0)*((-3.0*p01)+(-3.0*p012)+(2.0*p013)+(p21*(3.0+(3.0*p21)+(-2.0*p212)))));
}
static void quad_02(double *pixel, double *accum, Curve<3,2> *curve)
{
	const double &p00 = curve->p[0].v[0];
	const double &p01 = curve->p[0].v[1];
	const double &p10 = curve->p[1].v[0];
	const double &p11 = curve->p[1].v[1];
	const double &p20 = curve->p[2].v[0];
	const double &p21 = curve->p[2].v[1];
	const double p002 = p00*p00;
	const double p012 = p01*p01;
	const double p102 = p10*p10;
	const double p112 = p11*p11;
	const double p202 = p20*p20;
	const double p212 = p21*p21;
	const double p003 = p00*p002;
	const double p013 = p01*p012;
	const double p103 = p10*p102;
	const double p113 = p11*p112;
	const double p203 = p20*p202;
	const double p213 = p21*p212;
	*pixel = ((1.0/166320.0)*((-792.0*p102*p11*p20)+(528.0*p102*p112*p20)+(-96.0*p102*p113*p20)+(-1980.0*p10*p11*p202)+(1056.0*p10*p112*p202)+(-168.0*p10*p113*p202)+(-2970.0*p11*p203)+(924.0*p112*p203)+(-112.0*p113*p203)+(-1.0*p013*((112.0*p103)+(84.0*p102*p20)+(30.0*p10*p202)+(5.0*p203)))+(792.0*p103*p21)+(-528.0*p103*p11*p21)+(96.0*p103*p112*p21)+(1980.0*p102*p20*p21)+(-528.0*p102*p11*p20*p21)+(2970.0*p10*p202*p21)+(924.0*p10*p11*p202*p21)+(-336.0*p10*p112*p202*p21)+(3465.0*p203*p21)+(3696.0*p11*p203*p21)+(-504.0*p112*p203*p21)+(-528.0*p103*p212)+(168.0*p103*p11*p212)+(-1848.0*p102*p20*p212)+(336.0*p102*p11*p20*p212)+(-3696.0*p10*p202*p212)+(-5544.0*p203*p212)+(-1260.0*p11*p203*p212)+(112.0*p103*p213)+(504.0*p102*p20*p213)+(1260.0*p10*p202*p213)+(2310.0*p203*p213)+(-3.0*p012*((8.0*p103*(-22.0+(7.0*p11)+p21))+(4.0*p102*p20*(-44.0+(18.0*p11)+(5.0*p21)))+(p203*(-22.0+(10.0*p11)+(7.0*p21)))+(2.0*p10*p202*(-44.0+(20.0*p11)+(9.0*p21)))))+(p003*((-2310.0*p013)+(112.0*p113)+(84.0*p112*(-11.0+p21))+(126.0*p012*(44.0+(10.0*p11)+p21))+(21.0*p01*(-165.0+(24.0*p112)+(8.0*p11*(-22.0+p21))+(-22.0*p21)+p212))+(6.0*p11*(495.0+(-66.0*p21)+(5.0*p212)))+(p21*(495.0+(-66.0*p21)+(5.0*p212)))))+(-3.0*p01*((8.0*p103*(33.0+(-22.0*p11)+(4.0*p112)+(-1.0*p212)))+(4.0*p102*p20*(99.0+(20.0*p112)+(-22.0*p21)+(4.0*p11*(-22.0+(3.0*p21)))))+(2.0*p10*p202*(165.0+(36.0*p112)+(-88.0*p21)+(14.0*p212)+(14.0*p11*(-11.0+(3.0*p21)))))+(p203*(165.0+(28.0*p112)+(-154.0*p21)+(42.0*p212)+(4.0*p11*(-33.0+(14.0*p21)))))))+(-3.0*p00*((7.0*p013*((24.0*p102)+(8.0*p10*p20)+p202))+(p012*((56.0*p102*(-11.0+(2.0*p11)))+(12.0*p10*p20*(-22.0+(7.0*p11)+p21))+(p202*(-44.0+(18.0*p11)+(5.0*p21)))))+(-4.0*p10*p20*p21*(99.0+(12.0*p112)+(-66.0*p21)+(14.0*p212)+(3.0*p11*(-22.0+(7.0*p21)))))+(p202*((-44.0*p112)+(8.0*p113)+(p21*(-165.0+(154.0*p21)+(-42.0*p212)))+(p11*(66.0+(44.0*p21)+(-28.0*p212)))))+(p01*((p202*(99.0+(-88.0*p11)+(20.0*p112)+(-22.0*p21)+(12.0*p11*p21)))+(12.0*p10*p20*(33.0+(-22.0*p11)+(4.0*p112)+(-1.0*p212)))+(-4.0*p102*(-165.0+(44.0*p11)+(-22.0*p21)+(12.0*p11*p21)+(5.0*p212)))))+(-4.0*p102*((8.0*p113)+(4.0*p112*(-11.0+(5.0*p21)))+(p21*(99.0+(-44.0*p21)+(7.0*p212)))+(2.0*p11*(33.0+(-44.0*p21)+(9.0*p212)))))))+(-3.0*p002*((42.0*p013*((10.0*p10)+p20))+(-14.0*p012*(((11.0+(-2.0*p11))*p20)+(2.0*p10*(44.0+p21))))+(-1.0*p20*((8.0*p113)+(4.0*p112*(-11.0+(5.0*p21)))+(p21*(99.0+(-44.0*p21)+(7.0*p212)))+(2.0*p11*(33.0+(-44.0*p21)+(9.0*p212)))))+(-2.0*p10*((28.0*p113)+(4.0*p112*(-44.0+(9.0*p21)))+(p21*(165.0+(-44.0*p21)+(5.0*p212)))+(2.0*p11*(165.0+(-77.0*p21)+(10.0*p212)))))+(p01*((-2.0*p10*(-495.0+(56.0*p112)+(-88.0*p21)+(9.0*p212)+(14.0*p11*(-11.0+(3.0*p21)))))+(p20*(165.0+(22.0*p21)+(-5.0*p212)+(-4.0*p11*(11.0+(3.0*p21)))))))))));
	*accum = ((1.0/36.0)*((-3.0*p01)+(3.0*p012)+(-1.0*p013)+(p21*(3.0+(-3.0*p21)+p212))));
}
static void quad_12(double *pixel, double *accum, Curve<3,2> *curve)
{
	const double &p00 = curve->p[0].v[0];
	const double &p01 = curve->p[0].v[1];
	const double &p10 = curve->p[1].v[0];
	const double &p11 = curve->p[1].v[1];
	const double &p20 = curve->p[2].v[0];
	const double &p21 = curve->p[2].v[1];
	const double p002 = p00*p00;
	const double p012 = p01*p01;
	const double p102 = p10*p10;
	const double p112 = p11*p11;
	const double p202 = p20*p20;
	const double p212 = p21*p21;
	const double p003 = p00*p002;
	const double p013 = p01*p012;
	const double p103 = p10*p102;
	const double p113 = p11*p112;
	const double p203 = p20*p202;
	const double p213 = p21*p212;
	*pixel = ((1.0/166320.0)*((-13860.0*p11*p20)+(-5544.0*p10*p11*p20)+(1584.0*p102*p11*p20)+(5544.0*p112*p20)+(3168.0*p10*p112*p20)+(-1056.0*p102*p112*p20)+(-792.0*p113*p20)+(-528.0*p10*p113*p20)+(192.0*p102*p113*p20)+(-11088.0*p11*p202)+(3960.0*p10*p11*p202)+(3960.0*p112*p202)+(-2112.0*p10*p112*p202)+(-528.0*p113*p202)+(336.0*p10*p113*p202)+(5940.0*p11*p203)+(-1848.0*p112*p203)+(224.0*p113*p203)+(p013*((224.0*p103)+(84.0*p102*(-11.0+(2.0*p20)))+(6.0*p10*(-495.0+(-66.0*p20)+(10.0*p202)))+(p20*(-495.0+(-66.0*p20)+(10.0*p202)))))+(13860.0*p10*p21)+(5544.0*p102*p21)+(-1584.0*p103*p21)+(-5544.0*p10*p11*p21)+(-3168.0*p102*p11*p21)+(1056.0*p103*p11*p21)+(792.0*p10*p112*p21)+(528.0*p102*p112*p21)+(-192.0*p103*p112*p21)+(20790.0*p20*p21)+(11088.0*p10*p20*p21)+(-3960.0*p102*p20*p21)+(11088.0*p11*p20*p21)+(1056.0*p102*p11*p20*p21)+(-1980.0*p112*p20*p21)+(-528.0*p10*p112*p20*p21)+(13860.0*p202*p21)+(-5940.0*p10*p202*p21)+(11880.0*p11*p202*p21)+(-1848.0*p10*p11*p202*p21)+(-1848.0*p112*p202*p21)+(672.0*p10*p112*p202*p21)+(-6930.0*p203*p21)+(-7392.0*p11*p203*p21)+(1008.0*p112*p203*p21)+(-11088.0*p10*p212)+(-3960.0*p102*p212)+(1056.0*p103*p212)+(1980.0*p10*p11*p212)+(1056.0*p102*p11*p212)+(-336.0*p103*p11*p212)+(-27720.0*p20*p212)+(-11880.0*p10*p20*p212)+(3696.0*p102*p20*p212)+(-2970.0*p11*p20*p212)+(924.0*p10*p11*p20*p212)+(-672.0*p102*p11*p20*p212)+(-20790.0*p202*p212)+(7392.0*p10*p202*p212)+(-3696.0*p11*p202*p212)+(11088.0*p203*p212)+(2520.0*p11*p203*p212)+(2970.0*p10*p213)+(924.0*p102*p213)+(-224.0*p103*p213)+(10395.0*p20*p213)+(3696.0*p10*p20*p213)+(-1008.0*p102*p20*p213)+(8316.0*p202*p213)+(-2520.0*p10*p202*p213)+(-4620.0*p203*p213)+(2.0*p003*((2310.0*p013)+(-112.0*p113)+(-84.0*p112*(-11.0+p21))+(-126.0*p012*(44.0+(10.0*p11)+p21))+(p21*(-495.0+(66.0*p21)+(-5.0*p212)))+(-21.0*p01*(-165.0+(24.0*p112)+(8.0*p11*(-22.0+p21))+(-22.0*p21)+p212))+(-6.0*p11*(495.0+(-66.0*p21)+(5.0*p212)))))+(3.0*p012*((16.0*p103*(-22.0+(7.0*p11)+p21))+(4.0*p102*(330.0+(-88.0*p20)+(4.0*p11*(-22.0+(9.0*p20)))+(-11.0*p21)+(10.0*p20*p21)))+(p20*(924.0+(p11*(-330.0+(-88.0*p20)+(20.0*p202)))+(-99.0*p21)+(-22.0*p20*(-9.0+(2.0*p21)))+(2.0*p202*(-22.0+(7.0*p21)))))+(2.0*p10*((2.0*p11*(-165.0+(-77.0*p20)+(20.0*p202)))+(-33.0*(-56.0+p21))+(-44.0*p20*(-9.0+p21))+(2.0*p202*(-44.0+(9.0*p21)))))))+(6.0*p002*((-8.0*p113*(-11.0+(7.0*p10)+p20))+(42.0*p013*(-33.0+(10.0*p10)+p20))+(7.0*p012*((4.0*p11*(22.0+p20))+(-4.0*p10*(44.0+p21))+(11.0*(45.0+(-2.0*p20)+p21))))+(-4.0*p112*(165.0+(-22.0*p21)+(p20*(-11.0+(5.0*p21)))+(2.0*p10*(-44.0+(9.0*p21)))))+(-1.0*p21*((-11.0*(42.0+(-9.0*p21)+p212))+(2.0*p10*(165.0+(-44.0*p21)+(5.0*p212)))+(p20*(99.0+(-44.0*p21)+(7.0*p212)))))+(-2.0*p11*((-22.0*(42.0+(-9.0*p21)+p212))+(p20*(33.0+(-44.0*p21)+(9.0*p212)))+(2.0*p10*(165.0+(-77.0*p21)+(10.0*p212)))))+(p01*(-2310.0+(308.0*p112)+(165.0*p20)+(-330.0*p21)+(22.0*p20*p21)+(22.0*p212)+(-5.0*p20*p212)+(-4.0*p11*(495.0+(11.0*p20)+(-33.0*p21)+(3.0*p20*p21)))+(-2.0*p10*(-495.0+(56.0*p112)+(-88.0*p21)+(9.0*p212)+(14.0*p11*(-11.0+(3.0*p21)))))))))+(3.0*p01*((16.0*p103*(33.0+(-22.0*p11)+(4.0*p112)+(-1.0*p212)))+(4.0*p102*((p112*(-44.0+(40.0*p20)))+(11.0*(-42.0+(p20*(18.0+(-4.0*p21)))+p212))+(8.0*p11*(33.0+(p20*(-22.0+(3.0*p21)))))))+(2.0*p10*((4.0*p112*(-33.0+(-44.0*p20)+(18.0*p202)))+(33.0*(-70.0+p212))+(-22.0*p20*(42.0+(-12.0*p21)+p212))+(2.0*p202*(165.0+(-88.0*p21)+(14.0*p212)))+(4.0*p11*(231.0+(-33.0*p20*(-6.0+p21))+(7.0*p202*(-11.0+(3.0*p21)))))))+(p20*((4.0*p112*(-99.0+(-44.0*p20)+(14.0*p202)))+(-33.0*(70.0+(-28.0*p21)+(5.0*p212)))+(-22.0*p20*(42.0+(-30.0*p21)+(7.0*p212)))+(p202*(330.0+(-308.0*p21)+(84.0*p212)))+(4.0*p11*(462.0+(-66.0*p20*(-3.0+p21))+(-99.0*p21)+(p202*(-66.0+(28.0*p21)))))))))+(3.0*p00*((-8.0*p113*(-33.0+(-22.0*p10)+(8.0*p102)+(-2.0*p202)))+(7.0*p013*(-495.0+(48.0*p102)+(16.0*p10*(-11.0+p20))+(-22.0*p20)+(2.0*p202)))+(-4.0*p112*((8.0*p102*(-11.0+(5.0*p21)))+(11.0*(42.0+(2.0*p202)+(-9.0*p21)+(-2.0*p20*p21)))+(8.0*p10*(33.0+((-11.0+(3.0*p20))*p21)))))+(-2.0*p11*((-88.0*p20*(-3.0+p21)*p21)+(-33.0*(70.0+(-28.0*p21)+(5.0*p212)))+(8.0*p102*(33.0+(-44.0*p21)+(9.0*p212)))+(p202*(-66.0+(-44.0*p21)+(28.0*p212)))+(2.0*p10*(-462.0+(-132.0*(-3.0+p20)*p21)+(7.0*(-11.0+(6.0*p20))*p212)))))+(p012*(9240.0+(990.0*p11)+(112.0*p102*(-11.0+(2.0*p11)))+(660.0*p20)+(-176.0*p11*p20)+(-88.0*p202)+(36.0*p11*p202)+(165.0*p21)+(-22.0*p20*p21)+(10.0*p202*p21)+(4.0*p10*((7.0*p11*(-11.0+(6.0*p20)))+(6.0*p20*(-22.0+p21))+(11.0*(90.0+p21))))))+(p01*((p112*(660.0+(-88.0*p20)+(40.0*p202)))+(-8.0*p102*(-165.0+(-22.0*p21)+(5.0*p212)+(4.0*p11*(11.0+(3.0*p21)))))+(4.0*p11*(-924.0+(132.0*p20)+(99.0*p21)+(p202*(-44.0+(6.0*p21)))))+(-11.0*(630.0+(84.0*p21)+(-9.0*p212)+(2.0*p202*(-9.0+(2.0*p21)))+(-2.0*p20*(-42.0+p212))))+(8.0*p10*((2.0*p112*(11.0+(6.0*p20)))+(33.0*p11*((-2.0*p20)+p21))+(-3.0*p20*(-33.0+p212))+(11.0*(-42.0+(-6.0*p21)+p212))))))+(p21*((p202*(-330.0+(308.0*p21)+(-84.0*p212)))+(33.0*(70.0+(-28.0*p21)+(5.0*p212)))+(-8.0*p102*(99.0+(-44.0*p21)+(7.0*p212)))+(22.0*p20*(42.0+(-30.0*p21)+(7.0*p212)))+(-4.0*p10*((-33.0*(14.0+(-6.0*p21)+p212))+(2.0*p20*(99.0+(-66.0*p21)+(14.0*p212)))))))))));
	*accum = ((1.0/9.0)*((-3.0*p01)+(3.0*p012)+(-1.0*p013)+(p21*(3.0+(-3.0*p21)+p212))));
}
static void quad_22(double *pixel, double *accum, Curve<3,2> *curve)
{
	const double &p00 = curve->p[0].v[0];
	const double &p01 = curve->p[0].v[1];
	const double &p10 = curve->p[1].v[0];
	const double &p11 = curve->p[1].v[1];
	const double &p20 = curve->p[2].v[0];
	const double &p21 = curve->p[2].v[1];
	const double p002 = p00*p00;
	const double p012 = p01*p01;
	const double p102 = p10*p10;
	const double p112 = p11*p11;
	const double p202 = p20*p20;
	const double p212 = p21*p21;
	const double p003 = p00*p002;
	const double p013 = p01*p012;
	const double p103 = p10*p102;
	const double p113 = p11*p112;
	const double p203 = p20*p202;
	const double p213 = p21*p212;
	*pixel = ((1.0/166320.0)*((-13860.0*p11*p20)+(5544.0*p10*p11*p20)+(-792.0*p102*p11*p20)+(5544.0*p112*p20)+(-3168.0*p10*p112*p20)+(528.0*p102*p112*p20)+(-792.0*p113*p20)+(528.0*p10*p113*p20)+(-96.0*p102*p113*p20)+(11088.0*p11*p202)+(-1980.0*p10*p11*p202)+(-3960.0*p112*p202)+(1056.0*p10*p112*p202)+(528.0*p113*p202)+(-168.0*p10*p113*p202)+(-2970.0*p11*p203)+(924.0*p112*p203)+(-112.0*p113*p203)+(-1.0*p013*((112.0*p103)+(84.0*p102*(-11.0+p20))+(6.0*p10*(495.0+(-66.0*p20)+(5.0*p202)))+(p20*(495.0+(-66.0*p20)+(5.0*p202)))))+(13860.0*p10*p21)+(-5544.0*p102*p21)+(792.0*p103*p21)+(-5544.0*p10*p11*p21)+(3168.0*p102*p11*p21)+(-528.0*p103*p11*p21)+(792.0*p10*p112*p21)+(-528.0*p102*p112*p21)+(96.0*p103*p112*p21)+(20790.0*p20*p21)+(-11088.0*p10*p20*p21)+(1980.0*p102*p20*p21)+(11088.0*p11*p20*p21)+(-528.0*p102*p11*p20*p21)+(-1980.0*p112*p20*p21)+(528.0*p10*p112*p20*p21)+(-13860.0*p202*p21)+(2970.0*p10*p202*p21)+(-11880.0*p11*p202*p21)+(924.0*p10*p11*p202*p21)+(1848.0*p112*p202*p21)+(-336.0*p10*p112*p202*p21)+(3465.0*p203*p21)+(3696.0*p11*p203*p21)+(-504.0*p112*p203*p21)+(-11088.0*p10*p212)+(3960.0*p102*p212)+(-528.0*p103*p212)+(1980.0*p10*p11*p212)+(-1056.0*p102*p11*p212)+(168.0*p103*p11*p212)+(-27720.0*p20*p212)+(11880.0*p10*p20*p212)+(-1848.0*p102*p20*p212)+(-2970.0*p11*p20*p212)+(-924.0*p10*p11*p20*p212)+(336.0*p102*p11*p20*p212)+(20790.0*p202*p212)+(-3696.0*p10*p202*p212)+(3696.0*p11*p202*p212)+(-5544.0*p203*p212)+(-1260.0*p11*p203*p212)+(2970.0*p10*p213)+(-924.0*p102*p213)+(112.0*p103*p213)+(10395.0*p20*p213)+(-3696.0*p10*p20*p213)+(504.0*p102*p20*p213)+(-8316.0*p202*p213)+(1260.0*p10*p202*p213)+(2310.0*p203*p213)+(p003*((-2310.0*p013)+(112.0*p113)+(84.0*p112*(-11.0+p21))+(126.0*p012*(44.0+(10.0*p11)+p21))+(21.0*p01*(-165.0+(24.0*p112)+(8.0*p11*(-22.0+p21))+(-22.0*p21)+p212))+(6.0*p11*(495.0+(-66.0*p21)+(5.0*p212)))+(p21*(495.0+(-66.0*p21)+(5.0*p212)))))+(-3.0*p012*((8.0*p103*(-22.0+(7.0*p11)+p21))+(4.0*p102*(330.0+(-44.0*p20)+(2.0*p11*(-44.0+(9.0*p20)))+(-11.0*p21)+(5.0*p20*p21)))+(p20*(-924.0+(2.0*p11*(165.0+(-44.0*p20)+(5.0*p202)))+(99.0*p21)+(-22.0*p20*(-9.0+(2.0*p21)))+(p202*(-22.0+(7.0*p21)))))+(2.0*p10*((2.0*p11*(165.0+(-77.0*p20)+(10.0*p202)))+(33.0*(-56.0+p21))+(-44.0*p20*(-9.0+p21))+(p202*(-44.0+(9.0*p21)))))))+(-3.0*p002*((-8.0*p113*(-22.0+(7.0*p10)+p20))+(42.0*p013*(-66.0+(10.0*p10)+p20))+(14.0*p012*((2.0*p11*(44.0+p20))+(-2.0*p10*(44.0+p21))+(11.0*(45.0+(-1.0*p20)+p21))))+(-4.0*p112*(330.0+(-44.0*p21)+(p20*(-11.0+(5.0*p21)))+(2.0*p10*(-44.0+(9.0*p21)))))+(-1.0*p21*((-22.0*(42.0+(-9.0*p21)+p212))+(2.0*p10*(165.0+(-44.0*p21)+(5.0*p212)))+(p20*(99.0+(-44.0*p21)+(7.0*p212)))))+(-2.0*p11*((-44.0*(42.0+(-9.0*p21)+p212))+(p20*(33.0+(-44.0*p21)+(9.0*p212)))+(2.0*p10*(165.0+(-77.0*p21)+(10.0*p212)))))+(p01*(-4620.0+(616.0*p112)+(165.0*p20)+(-660.0*p21)+(22.0*p20*p21)+(44.0*p212)+(-5.0*p20*p212)+(-4.0*p11*(990.0+(11.0*p20)+(-66.0*p21)+(3.0*p20*p21)))+(-2.0*p10*(-495.0+(56.0*p112)+(-88.0*p21)+(9.0*p212)+(14.0*p11*(-11.0+(3.0*p21)))))))))+(-3.0*p01*((8.0*p103*(33.0+(-22.0*p11)+(4.0*p112)+(-1.0*p212)))+(4.0*p102*((4.0*p112*(-11.0+(5.0*p20)))+(11.0*(-42.0+(p20*(9.0+(-2.0*p21)))+p212))+(4.0*p11*(66.0+(p20*(-22.0+(3.0*p21)))))))+(2.0*p10*((4.0*p112*(33.0+(-44.0*p20)+(9.0*p202)))+(-33.0*(-70.0+p212))+(-22.0*p20*(42.0+(-12.0*p21)+p212))+(p202*(165.0+(-88.0*p21)+(14.0*p212)))+(2.0*p11*(-462.0+(-66.0*p20*(-6.0+p21))+(7.0*p202*(-11.0+(3.0*p21)))))))+(p20*((4.0*p112*(99.0+(-44.0*p20)+(7.0*p202)))+(33.0*(70.0+(-28.0*p21)+(5.0*p212)))+(-22.0*p20*(42.0+(-30.0*p21)+(7.0*p212)))+(p202*(165.0+(-154.0*p21)+(42.0*p212)))+(4.0*p11*(-462.0+(-66.0*p20*(-3.0+p21))+(99.0*p21)+(p202*(-33.0+(14.0*p21)))))))))+(-3.0*p00*((-8.0*p113*(33.0+(-22.0*p10)+(4.0*p102)+(-1.0*p202)))+(7.0*p013*(495.0+(24.0*p102)+(8.0*p10*(-22.0+p20))+(-22.0*p20)+p202))+(-4.0*p112*((4.0*p102*(-11.0+(5.0*p21)))+(11.0*(-42.0+p202+(9.0*p21)+(-2.0*p20*p21)))+(4.0*p10*(66.0+((-22.0+(3.0*p20))*p21)))))+(-2.0*p11*((-88.0*p20*(-3.0+p21)*p21)+(33.0*(70.0+(-28.0*p21)+(5.0*p212)))+(4.0*p102*(33.0+(-44.0*p21)+(9.0*p212)))+(p202*(-33.0+(-22.0*p21)+(14.0*p212)))+(2.0*p10*(-462.0+(-66.0*(-6.0+p20)*p21)+(7.0*(-11.0+(3.0*p20))*p212)))))+(p012*(-9240.0+(56.0*p102*(-11.0+(2.0*p11)))+(660.0*p20)+(-44.0*p202)+(2.0*p11*(-495.0+(-88.0*p20)+(9.0*p202)))+(-165.0*p21)+(-22.0*p20*p21)+(5.0*p202*p21)+(4.0*p10*((7.0*p11*(-11.0+(3.0*p20)))+(3.0*p20*(-22.0+p21))+(11.0*(90.0+p21))))))+(p01*((4.0*p112*(-165.0+(-22.0*p20)+(5.0*p202)))+(4.0*p11*(924.0+(132.0*p20)+(-99.0*p21)+(p202*(-22.0+(3.0*p21)))))+(-4.0*p102*(-165.0+(-22.0*p21)+(5.0*p212)+(4.0*p11*(11.0+(3.0*p21)))))+(11.0*(630.0+(p202*(9.0+(-2.0*p21)))+(84.0*p21)+(-9.0*p212)+(2.0*p20*(-42.0+p212))))+(4.0*p10*((4.0*p112*(11.0+(3.0*p20)))+(-66.0*p11*(p20+(-1.0*p21)))+(-3.0*p20*(-33.0+p212))+(22.0*(-42.0+(-6.0*p21)+p212))))))+(-1.0*p21*((33.0*(70.0+(-28.0*p21)+(5.0*p212)))+(4.0*p102*(99.0+(-44.0*p21)+(7.0*p212)))+(-22.0*p20*(42.0+(-30.0*p21)+(7.0*p212)))+(p202*(165.0+(-154.0*p21)+(42.0*p212)))+(4.0*p10*((-33.0*(14.0+(-6.0*p21)+p212))+(p20*(99.0+(-66.0*p21)+(14.0*p212)))))))))));
	*accum = ((1.0/36.0)*((-3.0*p01)+(3.0*p012)+(-1.0*p013)+(p21*(3.0+(-3.0*p21)+p212))));
}


//=============================================================================//
//================================= Cubics ====================================//
//=============================================================================//

static void cube_00(double *pixel, double *accum, Curve<4,2> *curve)
{
	const double &p00 = curve->p[0].v[0];
	const double &p01 = curve->p[0].v[1];
	const double &p10 = curve->p[1].v[0];
	const double &p11 = curve->p[1].v[1];
	const double &p20 = curve->p[2].v[0];
	const double &p21 = curve->p[2].v[1];
	const double &p30 = curve->p[3].v[0];
	const double &p31 = curve->p[3].v[1];
	const double p002 = p00*p00;
	const double p012 = p01*p01;
	const double p102 = p10*p10;
	const double p112 = p11*p11;
	const double p202 = p20*p20;
	const double p212 = p21*p21;
	const double p302 = p30*p30;
	const double p312 = p31*p31;
	const double p003 = p00*p002;
	const double p013 = p01*p012;
	const double p103 = p10*p102;
	const double p113 = p11*p112;
	const double p203 = p20*p202;
	const double p213 = p21*p212;
	const double p303 = p30*p302;
	const double p313 = p31*p312;
	*pixel = ((1.0/49008960.0)*((-10935.0*p102*p113*p20)+(-15309.0*p10*p113*p202)+(-6804.0*p113*p203)+(10935.0*p103*p112*p21)+(-20412.0*p10*p112*p202*p21)+(-15309.0*p112*p203*p21)+(15309.0*p103*p11*p212)+(20412.0*p102*p11*p20*p212)+(-10935.0*p11*p203*p212)+(6804.0*p103*p213)+(15309.0*p102*p20*p213)+(10935.0*p10*p202*p213)+(-5103.0*p102*p113*p30)+(-13608.0*p10*p113*p20*p30)+(-10206.0*p113*p202*p30)+(-6804.0*p102*p112*p21*p30)+(-30618.0*p10*p112*p20*p21*p30)+(-32805.0*p112*p202*p21*p30)+(-21870.0*p10*p11*p20*p212*p30)+(-40095.0*p11*p202*p212*p30)+(3645.0*p102*p213*p30)+(-16038.0*p202*p213*p30)+(-3402.0*p10*p113*p302)+(-6075.0*p113*p20*p302)+(-10935.0*p10*p112*p21*p302)+(-26730.0*p112*p20*p21*p302)+(-13365.0*p10*p11*p212*p302)+(-48114.0*p11*p20*p212*p302)+(-5346.0*p10*p213*p302)+(-34749.0*p20*p213*p302)+(-1485.0*p113*p303)+(-8910.0*p112*p21*p303)+(-23166.0*p11*p212*p303)+(-27027.0*p213*p303)+(-1.0*p013*((27027.0*p103)+(1485.0*p203)+(945.0*p202*p30)+(252.0*p20*p302)+(28.0*p303)+(594.0*p102*((39.0*p20)+(5.0*p30)))+(45.0*p10*((198.0*p202)+(66.0*p20*p30)+(7.0*p302)))))+(5103.0*p103*p112*p31)+(6804.0*p102*p112*p20*p31)+(-3645.0*p112*p203*p31)+(13608.0*p103*p11*p21*p31)+(30618.0*p102*p11*p20*p21*p31)+(21870.0*p10*p11*p202*p21*p31)+(10206.0*p103*p212*p31)+(32805.0*p102*p20*p212*p31)+(40095.0*p10*p202*p212*p31)+(16038.0*p203*p212*p31)+(-7290.0*p10*p112*p20*p30*p31)+(-13365.0*p112*p202*p30*p31)+(7290.0*p102*p11*p21*p30*p31)+(-32076.0*p11*p202*p21*p30*p31)+(13365.0*p102*p212*p30*p31)+(32076.0*p10*p20*p212*p30*p31)+(-4455.0*p10*p112*p302*p31)+(-16038.0*p112*p20*p302*p31)+(-10692.0*p10*p11*p21*p302*p31)+(-69498.0*p11*p20*p21*p302*p31)+(-81081.0*p20*p212*p302*p31)+(-7722.0*p112*p303*p31)+(-54054.0*p11*p21*p303*p31)+(-135135.0*p212*p303*p31)+(3402.0*p103*p11*p312)+(10935.0*p102*p11*p20*p312)+(13365.0*p10*p11*p202*p312)+(5346.0*p11*p203*p312)+(6075.0*p103*p21*p312)+(26730.0*p102*p20*p21*p312)+(48114.0*p10*p202*p21*p312)+(34749.0*p203*p21*p312)+(4455.0*p102*p11*p30*p312)+(10692.0*p10*p11*p20*p30*p312)+(16038.0*p102*p21*p30*p312)+(69498.0*p10*p20*p21*p30*p312)+(81081.0*p202*p21*p30*p312)+(-27027.0*p11*p20*p302*p312)+(27027.0*p10*p21*p302*p312)+(-45045.0*p11*p303*p312)+(-360360.0*p21*p303*p312)+(1485.0*p103*p313)+(8910.0*p102*p20*p313)+(23166.0*p10*p202*p313)+(27027.0*p203*p313)+(7722.0*p102*p30*p313)+(54054.0*p10*p20*p30*p313)+(135135.0*p202*p30*p313)+(45045.0*p10*p302*p313)+(360360.0*p20*p302*p313)+(680680.0*p303*p313)+(p003*((-680680.0*p013)+(27027.0*p113)+(1485.0*p213)+(945.0*p212*p31)+(252.0*p21*p312)+(28.0*p313)+(3003.0*p012*((120.0*p11)+(15.0*p21)+p31))+(594.0*p112*((39.0*p21)+(5.0*p31)))+(45.0*p11*((198.0*p212)+(66.0*p21*p31)+(7.0*p312)))+(33.0*p01*((4095.0*p112)+(234.0*p212)+(60.0*p21*p31)+(5.0*p312)+(78.0*p11*((21.0*p21)+(2.0*p31)))))))+(-3.0*p012*((2025.0*p11*p203)+(1134.0*p203*p21)+(891.0*p103*((13.0*p11)+(2.0*p21)))+(1701.0*p11*p202*p30)+(1260.0*p202*p21*p30)+(588.0*p11*p20*p302)+(567.0*p20*p21*p302)+(84.0*p11*p303)+(105.0*p21*p303)+(252.0*p203*p31)+(378.0*p202*p30*p31)+(225.0*p20*p302*p31)+(55.0*p303*p31)+(3.0*p10*((27.0*p11*((110.0*p202)+(50.0*p20*p30)+(7.0*p302)))+(84.0*p20*p30*((9.0*p21)+(2.0*p31)))+(14.0*p302*((10.0*p21)+(3.0*p31)))+(27.0*p202*((45.0*p21)+(7.0*p31)))))+(27.0*p102*((22.0*p11*((27.0*p20)+(5.0*p30)))+(15.0*p20*((11.0*p21)+p31))+(p30*((45.0*p21)+(7.0*p31)))))))+(3.0*p002*((1782.0*p113*p20)+(4455.0*p112*p20*p21)+(3645.0*p11*p20*p212)+(1134.0*p20*p213)+(405.0*p112*p21*p30)+(567.0*p11*p212*p30)+(252.0*p213*p30)+(-1001.0*p013*((120.0*p10)+(15.0*p20)+p30))+(1215.0*p112*p20*p31)+(2268.0*p11*p20*p21*p31)+(1260.0*p20*p212*p31)+(189.0*p112*p30*p31)+(504.0*p11*p21*p30*p31)+(378.0*p212*p30*p31)+(420.0*p11*p20*p312)+(567.0*p20*p21*p312)+(126.0*p11*p30*p312)+(225.0*p21*p30*p312)+(105.0*p20*p313)+(55.0*p30*p313)+(99.0*p012*((-2.0*p21*p30)+(-13.0*p11*((7.0*p20)+p30))+(2.0*p20*p31)+(13.0*p10*((7.0*p21)+p31))))+(3.0*p10*((3861.0*p113)+(675.0*p213)+(567.0*p212*p31)+(196.0*p21*p312)+(28.0*p313)+(198.0*p112*((27.0*p21)+(5.0*p31)))+(27.0*p11*((110.0*p212)+(50.0*p21*p31)+(7.0*p312)))))+(p01*((1485.0*p20*p212)+(-594.0*p112*p30)+(135.0*p212*p30)+(810.0*p20*p21*p31)+(126.0*p21*p30*p31)+(126.0*p20*p312)+(28.0*p30*p312)+(18.0*p11*((198.0*p20*p21)+(55.0*p20*p31)+(5.0*p30*p31)))+(9.0*p10*((3003.0*p112)+(594.0*p212)+(220.0*p21*p31)+(25.0*p312)+(198.0*p11*((13.0*p21)+(2.0*p31)))))))))+(-3.0*p01*((1701.0*p203*p212)+(3645.0*p202*p212*p30)+(2970.0*p20*p212*p302)+(990.0*p212*p303)+(63.0*p112*((54.0*p203)+(60.0*p202*p30)+(27.0*p20*p302)+(5.0*p303)))+(810.0*p203*p21*p31)+(2970.0*p202*p21*p30*p31)+(3564.0*p20*p21*p302*p31)+(1716.0*p21*p303*p31)+(594.0*p202*p30*p312)+(1287.0*p20*p302*p312)+(1001.0*p303*p312)+(9.0*p103*((594.0*p112)+(-135.0*p212)+(-90.0*p11*p31)+(-126.0*p21*p31)+(-28.0*p312)))+(6.0*p11*((189.0*p203*((4.0*p21)+p31))+(55.0*p303*((3.0*p21)+(2.0*p31)))+(81.0*p202*p30*((14.0*p21)+(5.0*p31)))+(15.0*p20*p302*((45.0*p21)+(22.0*p31)))))+(9.0*p102*((135.0*p112*((11.0*p20)+(3.0*p30)))+(p11*((810.0*p20*p21)+(378.0*p21*p30)+(56.0*p30*p31)))+(-3.0*((-28.0*p212*p30)+(56.0*p20*p21*p31)+(((21.0*p20)+(5.0*p30))*p312)))))+(9.0*p10*((p112*((1215.0*p202)+(756.0*p20*p30)+(140.0*p302)))+(18.0*p20*p21*p30*((21.0*p21)+(10.0*p31)))+(9.0*p202*((28.0*p212)+(-5.0*p312)))+(p302*((135.0*p212)+(110.0*p21*p31)+(22.0*p312)))+(6.0*p11*((42.0*p20*p30*((4.0*p21)+p31))+(7.0*p202*((27.0*p21)+(4.0*p31)))+(3.0*p302*((14.0*p21)+(5.0*p31)))))))))+(-3.0*p00*((1215.0*p113*p202)+(-2268.0*p11*p202*p212)+(-1701.0*p202*p213)+(1134.0*p113*p20*p30)+(1512.0*p112*p20*p21*p30)+(-810.0*p20*p213*p30)+(252.0*p113*p302)+(567.0*p112*p21*p302)+(405.0*p11*p212*p302)+(11.0*p013*((4095.0*p102)+(234.0*p202)+(60.0*p20*p30)+(5.0*p302)+(78.0*p10*((21.0*p20)+(2.0*p30)))))+(-756.0*p112*p202*p31)+(-3402.0*p11*p202*p21*p31)+(-3645.0*p202*p212*p31)+(-1620.0*p11*p20*p21*p30*p31)+(-2970.0*p20*p212*p30*p31)+(135.0*p112*p302*p31)+(-594.0*p212*p302*p31)+(-1215.0*p11*p202*p312)+(-2970.0*p202*p21*p312)+(-990.0*p11*p20*p30*p312)+(-3564.0*p20*p21*p30*p312)+(-198.0*p11*p302*p312)+(-1287.0*p21*p302*p312)+(-990.0*p202*p313)+(-1716.0*p20*p30*p313)+(-1001.0*p302*p313)+(p012*((1485.0*p202*p21)+(810.0*p20*p21*p30)+(126.0*p21*p302)+(9.0*p11*((594.0*p202)+(220.0*p20*p30)+(25.0*p302)))+(297.0*p102*((91.0*p11)+(-2.0*p31)))+(135.0*p202*p31)+(126.0*p20*p30*p31)+(28.0*p302*p31)+(18.0*p10*((198.0*p20*p21)+(55.0*p21*p30)+(99.0*p11*((13.0*p20)+(2.0*p30)))+(5.0*p30*p31)))))+(-9.0*p102*((594.0*p113)+(135.0*p112*((11.0*p21)+(3.0*p31)))+(p11*((1215.0*p212)+(756.0*p21*p31)+(140.0*p312)))+(7.0*((54.0*p213)+(60.0*p212*p31)+(27.0*p21*p312)+(5.0*p313)))))+(-6.0*p10*((-135.0*p113*p30)+(3.0*p20*((252.0*p213)+(378.0*p212*p31)+(225.0*p21*p312)+(55.0*p313)))+(p30*((189.0*p213)+(405.0*p212*p31)+(330.0*p21*p312)+(110.0*p313)))+(3.0*p112*((28.0*p30*p31)+(27.0*p20*((15.0*p21)+(7.0*p31)))))+(9.0*p11*((21.0*p20*((9.0*p212)+(8.0*p21*p31)+(2.0*p312)))+(p30*((28.0*p212)+(42.0*p21*p31)+(15.0*p312)))))))+(-3.0*p01*((-168.0*p20*p212*p30)+(-63.0*p212*p302)+(-9.0*p112*((165.0*p202)+(90.0*p20*p30)+(14.0*p302)))+(168.0*p202*p21*p31)+(-30.0*p21*p302*p31)+(63.0*p202*p312)+(30.0*p20*p30*p312)+(-2.0*p11*((405.0*p202*p21)+(21.0*p302*((4.0*p21)+p31))+(14.0*p20*p30*((27.0*p21)+(4.0*p31)))))+(9.0*p102*((165.0*p212)+(90.0*p21*p31)+(14.0*p312)+(22.0*p11*((18.0*p21)+(5.0*p31)))))+(2.0*p10*((-99.0*p112*((18.0*p20)+(5.0*p30)))+(7.0*p30*p31*((8.0*p21)+(3.0*p31)))+(-270.0*p11*((p21*p30)+(-1.0*p20*p31)))+(p20*((405.0*p212)+(378.0*p21*p31)+(84.0*p312)))))))))));
	*accum = ((1.0/36.0)*((-1.0*p013)+p313));
}
static void cube_10(double *pixel, double *accum, Curve<4,2> *curve)
{
	const double &p00 = curve->p[0].v[0];
	const double &p01 = curve->p[0].v[1];
	const double &p10 = curve->p[1].v[0];
	const double &p11 = curve->p[1].v[1];
	const double &p20 = curve->p[2].v[0];
	const double &p21 = curve->p[2].v[1];
	const double &p30 = curve->p[3].v[0];
	const double &p31 = curve->p[3].v[1];
	const double p002 = p00*p00;
	const double p012 = p01*p01;
	const double p102 = p10*p10;
	const double p112 = p11*p11;
	const double p202 = p20*p20;
	const double p212 = p21*p21;
	const double p302 = p30*p30;
	const double p312 = p31*p31;
	const double p003 = p00*p002;
	const double p013 = p01*p012;
	const double p103 = p10*p102;
	const double p113 = p11*p112;
	const double p203 = p20*p202;
	const double p213 = p21*p212;
	const double p303 = p30*p302;
	const double p313 = p31*p312;
	*pixel = ((1.0/24504480.0)*((-53703.0*p113*p20)+(-33048.0*p10*p113*p20)+(10935.0*p102*p113*p20)+(-24786.0*p113*p202)+(15309.0*p10*p113*p202)+(6804.0*p113*p203)+(53703.0*p10*p112*p21)+(33048.0*p102*p112*p21)+(-10935.0*p103*p112*p21)+(-89505.0*p112*p20*p21)+(-24786.0*p10*p112*p20*p21)+(-49572.0*p112*p202*p21)+(20412.0*p10*p112*p202*p21)+(15309.0*p112*p203*p21)+(89505.0*p10*p11*p212)+(49572.0*p102*p11*p212)+(-15309.0*p103*p11*p212)+(-53703.0*p11*p20*p212)+(24786.0*p10*p11*p20*p212)+(-20412.0*p102*p11*p20*p212)+(-33048.0*p11*p202*p212)+(10935.0*p11*p203*p212)+(53703.0*p10*p213)+(24786.0*p102*p213)+(-6804.0*p103*p213)+(33048.0*p10*p20*p213)+(-15309.0*p102*p20*p213)+(-10935.0*p10*p202*p213)+(-29835.0*p113*p30)+(-16524.0*p10*p113*p30)+(5103.0*p102*p113*p30)+(-24786.0*p113*p20*p30)+(13608.0*p10*p113*p20*p30)+(10206.0*p113*p202*p30)+(-89505.0*p112*p21*p30)+(-33048.0*p10*p112*p21*p30)+(6804.0*p102*p112*p21*p30)+(-77112.0*p112*p20*p21*p30)+(30618.0*p10*p112*p20*p21*p30)+(32805.0*p112*p202*p21*p30)+(-125307.0*p11*p212*p30)+(-22032.0*p10*p11*p212*p30)+(-99144.0*p11*p20*p212*p30)+(21870.0*p10*p11*p20*p212*p30)+(40095.0*p11*p202*p212*p30)+(-83538.0*p213*p30)+(-3645.0*p102*p213*p30)+(-49572.0*p20*p213*p30)+(16038.0*p202*p213*p30)+(-7344.0*p113*p302)+(3402.0*p10*p113*p302)+(6075.0*p113*p20*p302)+(-33048.0*p112*p21*p302)+(10935.0*p10*p112*p21*p302)+(26730.0*p112*p20*p21*p302)+(-66096.0*p11*p212*p302)+(13365.0*p10*p11*p212*p302)+(48114.0*p11*p20*p212*p302)+(-60588.0*p213*p302)+(5346.0*p10*p213*p302)+(34749.0*p20*p213*p302)+(1485.0*p113*p303)+(8910.0*p112*p21*p303)+(23166.0*p11*p212*p303)+(27027.0*p213*p303)+(p013*((27027.0*p103)+(1485.0*p203)+(594.0*p102*(-204.0+(39.0*p20)+(5.0*p30)))+(27.0*p202*(-408.0+(35.0*p30)))+(18.0*p20*(-4641.0+(-204.0*p30)+(14.0*p302)))+(2.0*p30*(-4641.0+(-204.0*p30)+(14.0*p302)))+(9.0*p10*(-46410.0+(990.0*p202)+(-816.0*p30)+(35.0*p302)+(66.0*p20*(-102.0+(5.0*p30)))))))+(29835.0*p10*p112*p31)+(16524.0*p102*p112*p31)+(-5103.0*p103*p112*p31)+(-17901.0*p112*p20*p31)+(8262.0*p10*p112*p20*p31)+(-6804.0*p102*p112*p20*p31)+(-11016.0*p112*p202*p31)+(3645.0*p112*p203*p31)+(107406.0*p10*p11*p21*p31)+(49572.0*p102*p11*p21*p31)+(-13608.0*p103*p11*p21*p31)+(66096.0*p10*p11*p20*p21*p31)+(-30618.0*p102*p11*p20*p21*p31)+(-21870.0*p10*p11*p202*p21*p31)+(125307.0*p10*p212*p31)+(44064.0*p102*p212*p31)+(-10206.0*p103*p212*p31)+(83538.0*p20*p212*p31)+(99144.0*p10*p20*p212*p31)+(-32805.0*p102*p20*p212*p31)+(49572.0*p202*p212*p31)+(-40095.0*p10*p202*p212*p31)+(-16038.0*p203*p212*p31)+(-41769.0*p112*p30*p31)+(-7344.0*p10*p112*p30*p31)+(-33048.0*p112*p20*p30*p31)+(7290.0*p10*p112*p20*p30*p31)+(13365.0*p112*p202*p30*p31)+(-167076.0*p11*p21*p30*p31)+(-7290.0*p102*p11*p21*p30*p31)+(-99144.0*p11*p20*p21*p30*p31)+(32076.0*p11*p202*p21*p30*p31)+(-250614.0*p212*p30*p31)+(33048.0*p10*p212*p30*p31)+(-13365.0*p102*p212*p30*p31)+(-60588.0*p20*p212*p30*p31)+(-32076.0*p10*p20*p212*p30*p31)+(-22032.0*p112*p302*p31)+(4455.0*p10*p112*p302*p31)+(16038.0*p112*p20*p302*p31)+(-121176.0*p11*p21*p302*p31)+(10692.0*p10*p11*p21*p302*p31)+(69498.0*p11*p20*p21*p302*p31)+(-242352.0*p212*p302*p31)+(81081.0*p20*p212*p302*p31)+(7722.0*p112*p303*p31)+(54054.0*p11*p21*p303*p31)+(135135.0*p212*p303*p31)+(41769.0*p10*p11*p312)+(14688.0*p102*p11*p312)+(-3402.0*p103*p11*p312)+(27846.0*p11*p20*p312)+(33048.0*p10*p11*p20*p312)+(-10935.0*p102*p11*p20*p312)+(16524.0*p11*p202*p312)+(-13365.0*p10*p11*p202*p312)+(-5346.0*p11*p203*p312)+(139230.0*p10*p21*p312)+(33048.0*p102*p21*p312)+(-6075.0*p103*p21*p312)+(250614.0*p20*p21*p312)+(115668.0*p10*p20*p21*p312)+(-26730.0*p102*p20*p21*p312)+(121176.0*p202*p21*p312)+(-48114.0*p10*p202*p21*p312)+(-34749.0*p203*p21*p312)+(-83538.0*p11*p30*p312)+(11016.0*p10*p11*p30*p312)+(-4455.0*p102*p11*p30*p312)+(-20196.0*p11*p20*p30*p312)+(-10692.0*p10*p11*p20*p30*p312)+(-417690.0*p21*p30*p312)+(80784.0*p10*p21*p30*p312)+(-16038.0*p102*p21*p30*p312)+(121176.0*p20*p21*p30*p312)+(-69498.0*p10*p20*p21*p30*p312)+(-81081.0*p202*p21*p30*p312)+(-80784.0*p11*p302*p312)+(27027.0*p11*p20*p302*p312)+(-525096.0*p21*p302*p312)+(-27027.0*p10*p21*p302*p312)+(45045.0*p11*p303*p312)+(360360.0*p21*p303*p312)+(83538.0*p10*p313)+(11016.0*p102*p313)+(-1485.0*p103*p313)+(417690.0*p20*p313)+(60588.0*p10*p20*p313)+(-8910.0*p102*p20*p313)+(121176.0*p202*p313)+(-23166.0*p10*p202*p313)+(-27027.0*p203*p313)+(1531530.0*p30*p313)+(80784.0*p10*p30*p313)+(-7722.0*p102*p30*p313)+(525096.0*p20*p30*p313)+(-54054.0*p10*p20*p30*p313)+(-135135.0*p202*p30*p313)+(1225224.0*p302*p313)+(-45045.0*p10*p302*p313)+(-360360.0*p20*p302*p313)+(-680680.0*p303*p313)+(3.0*p012*((-13923.0*p20*p21)+(-4896.0*p202*p21)+(1134.0*p203*p21)+(891.0*p103*((13.0*p11)+(2.0*p21)))+(-4641.0*p21*p30)+(-3366.0*p20*p21*p30)+(1260.0*p202*p21*p30)+(-714.0*p21*p302)+(567.0*p20*p21*p302)+(105.0*p21*p303)+(3.0*p11*((675.0*p203)+(27.0*p202*(-136.0+(21.0*p30)))+(2.0*p30*(-1547.0+(-136.0*p30)+(14.0*p302)))+(2.0*p20*(-7735.0+(-884.0*p30)+(98.0*p302)))))+(-1989.0*p20*p31)+(-918.0*p202*p31)+(252.0*p203*p31)+(-1105.0*p30*p31)+(-918.0*p20*p30*p31)+(378.0*p202*p30*p31)+(-272.0*p302*p31)+(225.0*p20*p302*p31)+(55.0*p303*p31)+(27.0*p102*((22.0*p11*(-68.0+(27.0*p20)+(5.0*p30)))+(3.0*p21*(-68.0+(55.0*p20)+(15.0*p30)))+(((15.0*p20)+(7.0*p30))*p31)))+(3.0*p10*((9.0*p11*(-3094.0+(330.0*p202)+(-272.0*p30)+(21.0*p302)+(6.0*p20*(-238.0+(25.0*p30)))))+(p21*((1215.0*p202)+(108.0*p20*(-34.0+(7.0*p30)))+(2.0*(-1547.0+(-544.0*p30)+(70.0*p302)))))+(3.0*((63.0*p202)+(2.0*p30*(-34.0+(7.0*p30)))+(8.0*p20*(-17.0+(7.0*p30))))*p31)))))+(p003*((680680.0*p013)+(-27027.0*p113)+(-1485.0*p213)+(-945.0*p212*p31)+(-252.0*p21*p312)+(-28.0*p313)+(-3003.0*p012*((120.0*p11)+(15.0*p21)+p31))+(-594.0*p112*((39.0*p21)+(5.0*p31)))+(-45.0*p11*((198.0*p212)+(66.0*p21*p31)+(7.0*p312)))+(-33.0*p01*((4095.0*p112)+(234.0*p212)+(60.0*p21*p31)+(5.0*p312)+(78.0*p11*((21.0*p21)+(2.0*p31)))))))+(3.0*p002*((-297.0*p113*(-68.0+(39.0*p10)+(6.0*p20)))+(2448.0*p213)+(-2025.0*p10*p213)+(-1134.0*p20*p213)+(-252.0*p213*p30)+(1001.0*p013*(-408.0+(120.0*p10)+(15.0*p20)+p30))+(2142.0*p212*p31)+(-1701.0*p10*p212*p31)+(-1260.0*p20*p212*p31)+(-378.0*p212*p30*p31)+(816.0*p21*p312)+(-588.0*p10*p21*p312)+(-567.0*p20*p21*p312)+(-225.0*p21*p30*p312)+(136.0*p313)+(-84.0*p10*p313)+(-105.0*p20*p313)+(-55.0*p30*p313)+(33.0*p012*((39.0*p11*(136.0+(7.0*p20)+p30))+(p21*(816.0+(-273.0*p10)+(6.0*p30)))+((68.0+(-39.0*p10)+(-6.0*p20))*p31)))+(-27.0*p112*((3.0*p21*(-272.0+(198.0*p10)+(55.0*p20)+(5.0*p30)))+((-136.0+(110.0*p10)+(45.0*p20)+(7.0*p30))*p31)))+(-3.0*p11*((27.0*p212*(-136.0+(110.0*p10)+(45.0*p20)+(7.0*p30)))+(6.0*p21*(-272.0+(225.0*p10)+(126.0*p20)+(28.0*p30))*p31)+(7.0*(-34.0+(27.0*p10)+(20.0*p20)+(6.0*p30))*p312)))+(-1.0*p01*((27.0*p212*(-272.0+(198.0*p10)+(55.0*p20)+(5.0*p30)))+(297.0*p112*((91.0*p10)+(-2.0*(136.0+p30))))+(18.0*p21*(-136.0+(110.0*p10)+(45.0*p20)+(7.0*p30))*p31)+((-272.0+(225.0*p10)+(126.0*p20)+(28.0*p30))*p312)+(18.0*p11*((33.0*(-68.0+(39.0*p10)+(6.0*p20))*p21)+((-272.0+(198.0*p10)+(55.0*p20)+(5.0*p30))*p31)))))))+(3.0*p00*((9945.0*p213)+(8262.0*p10*p213)+(-3402.0*p102*p213)+(5508.0*p20*p213)+(-4536.0*p10*p20*p213)+(-1701.0*p202*p213)+(1224.0*p213*p30)+(-1134.0*p10*p213*p30)+(-810.0*p20*p213*p30)+(11.0*p013*(-46410.0+(4095.0*p102)+(234.0*p202)+(-204.0*p30)+(5.0*p302)+(78.0*p10*(-204.0+(21.0*p20)+(2.0*p30)))+(12.0*p20*(-204.0+(5.0*p30)))))+(-9.0*p113*(-3094.0+(594.0*p102)+(-135.0*p202)+(136.0*p30)+(-126.0*p20*p30)+(-28.0*p302)+(-18.0*p10*(102.0+(5.0*p30)))))+(13923.0*p212*p31)+(10098.0*p10*p212*p31)+(-3780.0*p102*p212*p31)+(9792.0*p20*p212*p31)+(-6804.0*p10*p20*p212*p31)+(-3645.0*p202*p212*p31)+(3672.0*p212*p30*p31)+(-2430.0*p10*p212*p30*p31)+(-2970.0*p20*p212*p30*p31)+(-594.0*p212*p302*p31)+(9282.0*p21*p312)+(5304.0*p10*p21*p312)+(-1701.0*p102*p21*p312)+(7344.0*p20*p21*p312)+(-4050.0*p10*p20*p21*p312)+(-2970.0*p202*p21*p312)+(4284.0*p21*p30*p312)+(-1980.0*p10*p21*p30*p312)+(-3564.0*p20*p21*p30*p312)+(-1287.0*p21*p302*p312)+(3094.0*p313)+(1224.0*p10*p313)+(-315.0*p102*p313)+(2448.0*p20*p313)+(-990.0*p10*p20*p313)+(-990.0*p202*p313)+(2244.0*p30*p313)+(-660.0*p10*p30*p313)+(-1716.0*p20*p30*p313)+(-1001.0*p302*p313)+(-9.0*p112*((3.0*p21*(-1547.0+(495.0*p102)+(18.0*p10*(-68.0+(15.0*p20)))+(34.0*p30)+(-21.0*p302)+(-8.0*p20*(34.0+(7.0*p30)))))+((-1105.0+(405.0*p102)+(-408.0*p20)+(84.0*p202)+(-34.0*p30)+(-15.0*p302)+(14.0*p10*(-68.0+(27.0*p20)+(4.0*p30))))*p31)))+(p012*((9.0*p21*(3094.0+(-408.0*p20)+(165.0*p202)+(-136.0*p30)+(90.0*p20*p30)+(14.0*p302)+(22.0*p10*(34.0+(18.0*p20)+(5.0*p30)))))+(9.0*p11*(15470.0+(3003.0*p102)+(594.0*p202)+(-476.0*p30)+(25.0*p302)+(44.0*p20*(-68.0+(5.0*p30)))+(66.0*p10*(-68.0+(39.0*p20)+(6.0*p30)))))+((3094.0+(-594.0*p102)+(135.0*p202)+(-136.0*p30)+(126.0*p20*p30)+(28.0*p302)+(18.0*p10*(102.0+(5.0*p30))))*p31)))+(-3.0*p11*((9.0*p212*(-1105.0+(405.0*p102)+(-408.0*p20)+(84.0*p202)+(-34.0*p30)+(-15.0*p302)+(14.0*p10*(-68.0+(27.0*p20)+(4.0*p30)))))+(6.0*p21*((378.0*p102)+(189.0*p202)+(18.0*p20*(-34.0+(5.0*p30)))+(18.0*p10*(-51.0+(28.0*p20)+(7.0*p30)))+(-17.0*(65.0+(8.0*p30))))*p31)+((-1547.0+(420.0*p102)+(405.0*p202)+(-408.0*p30)+(66.0*p302)+(6.0*p10*(-187.0+(126.0*p20)+(45.0*p30)))+(2.0*p20*(-544.0+(165.0*p30))))*p312)))+(p01*((27.0*p112*(3094.0+(-408.0*p20)+(165.0*p202)+(-136.0*p30)+(90.0*p20*p30)+(14.0*p302)+(22.0*p10*(34.0+(18.0*p20)+(5.0*p30)))))+(-9.0*p212*(-1547.0+(495.0*p102)+(18.0*p10*(-68.0+(15.0*p20)))+(34.0*p30)+(-21.0*p302)+(-8.0*p20*(34.0+(7.0*p30)))))+(-6.0*p21*(-1105.0+(405.0*p102)+(-408.0*p20)+(84.0*p202)+(-34.0*p30)+(-15.0*p302)+(14.0*p10*(-68.0+(27.0*p20)+(4.0*p30))))*p31)+(((-378.0*p102)+(-189.0*p202)+(p20*(612.0+(-90.0*p30)))+(-18.0*p10*(-51.0+(28.0*p20)+(7.0*p30)))+(17.0*(65.0+(8.0*p30))))*p312)+(-6.0*p11*((3.0*p21*(-3094.0+(594.0*p102)+(-135.0*p202)+(136.0*p30)+(-126.0*p20*p30)+(-28.0*p302)+(-18.0*p10*(102.0+(5.0*p30)))))+((-1547.0+(495.0*p102)+(18.0*p10*(-68.0+(15.0*p20)))+(34.0*p30)+(-21.0*p302)+(-8.0*p20*(34.0+(7.0*p30))))*p31)))))))+(3.0*p01*((-9945.0*p20*p212)+(-5508.0*p202*p212)+(1701.0*p203*p212)+(-9945.0*p212*p30)+(-8568.0*p20*p212*p30)+(3645.0*p202*p212*p30)+(-3672.0*p212*p302)+(2970.0*p20*p212*p302)+(990.0*p212*p303)+(9.0*p112*((378.0*p203)+(12.0*p202*(-136.0+(35.0*p30)))+(7.0*p30*(-221.0+(-34.0*p30)+(5.0*p302)))+(3.0*p20*(-1547.0+(-374.0*p30)+(63.0*p302)))))+(-3978.0*p20*p21*p31)+(-2448.0*p202*p21*p31)+(810.0*p203*p21*p31)+(-9282.0*p21*p30*p31)+(-7344.0*p20*p21*p30*p31)+(2970.0*p202*p21*p30*p31)+(-4896.0*p21*p302*p31)+(3564.0*p20*p21*p302*p31)+(1716.0*p21*p303*p31)+(-3094.0*p30*p312)+(-1836.0*p20*p30*p312)+(594.0*p202*p30*p312)+(-2244.0*p302*p312)+(1287.0*p20*p302*p312)+(1001.0*p303*p312)+(9.0*p103*((594.0*p112)+(-135.0*p212)+(-90.0*p11*p31)+(-126.0*p21*p31)+(-28.0*p312)))+(6.0*p11*((189.0*p203*((4.0*p21)+p31))+(9.0*p202*((18.0*p21*(-17.0+(7.0*p30)))+((-68.0+(45.0*p30))*p31)))+(p30*((3.0*p21*(-1105.0+(-272.0*p30)+(55.0*p302)))+((-1105.0+(-408.0*p30)+(110.0*p302))*p31)))+(p20*((27.0*p21*(-221.0+(-102.0*p30)+(25.0*p302)))+((-1105.0+(-952.0*p30)+(330.0*p302))*p31)))))+(9.0*p102*((27.0*p112*(-68.0+(55.0*p20)+(15.0*p30)))+(p11*((810.0*p20*p21)+(378.0*p21*p30)+(8.0*(34.0+(7.0*p30))*p31)))+(3.0*((4.0*p212*(34.0+(7.0*p30)))+(-8.0*(-17.0+(7.0*p20))*p21*p31)+((34.0+(-21.0*p20)+(-5.0*p30))*p312)))))+(3.0*p10*((9.0*p212*(221.0+(84.0*p202)+(-136.0*p30)+(45.0*p302)+(6.0*p20*(-17.0+(21.0*p30)))))+(3.0*p112*((1215.0*p202)+(108.0*p20*(-34.0+(7.0*p30)))+(2.0*(-1547.0+(-544.0*p30)+(70.0*p302)))))+(2.0*p21*(1105.0+(-272.0*p30)+(165.0*p302)+(18.0*p20*(17.0+(15.0*p30))))*p31)+(3.0*(221.0+(136.0*p20)+(-45.0*p202)+(22.0*p302))*p312)+(6.0*p11*((18.0*p21*p30*(-34.0+(7.0*p30)))+((221.0+(-136.0*p30)+(45.0*p302))*p31)+(21.0*p202*((27.0*p21)+(4.0*p31)))+(6.0*p20*((12.0*p21*(-17.0+(7.0*p30)))+((-17.0+(21.0*p30))*p31)))))))))));
	*accum = ((1.0/9.0)*((-1.0*p013)+p313));
}
static void cube_20(double *pixel, double *accum, Curve<4,2> *curve)
{
	const double &p00 = curve->p[0].v[0];
	const double &p01 = curve->p[0].v[1];
	const double &p10 = curve->p[1].v[0];
	const double &p11 = curve->p[1].v[1];
	const double &p20 = curve->p[2].v[0];
	const double &p21 = curve->p[2].v[1];
	const double &p30 = curve->p[3].v[0];
	const double &p31 = curve->p[3].v[1];
	const double p002 = p00*p00;
	const double p012 = p01*p01;
	const double p102 = p10*p10;
	const double p112 = p11*p11;
	const double p202 = p20*p20;
	const double p212 = p21*p21;
	const double p302 = p30*p30;
	const double p312 = p31*p31;
	const double p003 = p00*p002;
	const double p013 = p01*p012;
	const double p103 = p10*p102;
	const double p113 = p11*p112;
	const double p203 = p20*p202;
	const double p213 = p21*p212;
	const double p303 = p30*p302;
	const double p313 = p31*p312;
	*pixel = ((1.0/49008960.0)*((-107406.0*p113*p20)+(66096.0*p10*p113*p20)+(-10935.0*p102*p113*p20)+(49572.0*p113*p202)+(-15309.0*p10*p113*p202)+(-6804.0*p113*p203)+(107406.0*p10*p112*p21)+(-66096.0*p102*p112*p21)+(10935.0*p103*p112*p21)+(-179010.0*p112*p20*p21)+(49572.0*p10*p112*p20*p21)+(99144.0*p112*p202*p21)+(-20412.0*p10*p112*p202*p21)+(-15309.0*p112*p203*p21)+(179010.0*p10*p11*p212)+(-99144.0*p102*p11*p212)+(15309.0*p103*p11*p212)+(-107406.0*p11*p20*p212)+(-49572.0*p10*p11*p20*p212)+(20412.0*p102*p11*p20*p212)+(66096.0*p11*p202*p212)+(-10935.0*p11*p203*p212)+(107406.0*p10*p213)+(-49572.0*p102*p213)+(6804.0*p103*p213)+(-66096.0*p10*p20*p213)+(15309.0*p102*p20*p213)+(10935.0*p10*p202*p213)+(-59670.0*p113*p30)+(33048.0*p10*p113*p30)+(-5103.0*p102*p113*p30)+(49572.0*p113*p20*p30)+(-13608.0*p10*p113*p20*p30)+(-10206.0*p113*p202*p30)+(-179010.0*p112*p21*p30)+(66096.0*p10*p112*p21*p30)+(-6804.0*p102*p112*p21*p30)+(154224.0*p112*p20*p21*p30)+(-30618.0*p10*p112*p20*p21*p30)+(-32805.0*p112*p202*p21*p30)+(-250614.0*p11*p212*p30)+(44064.0*p10*p11*p212*p30)+(198288.0*p11*p20*p212*p30)+(-21870.0*p10*p11*p20*p212*p30)+(-40095.0*p11*p202*p212*p30)+(-167076.0*p213*p30)+(3645.0*p102*p213*p30)+(99144.0*p20*p213*p30)+(-16038.0*p202*p213*p30)+(14688.0*p113*p302)+(-3402.0*p10*p113*p302)+(-6075.0*p113*p20*p302)+(66096.0*p112*p21*p302)+(-10935.0*p10*p112*p21*p302)+(-26730.0*p112*p20*p21*p302)+(132192.0*p11*p212*p302)+(-13365.0*p10*p11*p212*p302)+(-48114.0*p11*p20*p212*p302)+(121176.0*p213*p302)+(-5346.0*p10*p213*p302)+(-34749.0*p20*p213*p302)+(-1485.0*p113*p303)+(-8910.0*p112*p21*p303)+(-23166.0*p11*p212*p303)+(-27027.0*p213*p303)+(-1.0*p013*((27027.0*p103)+(1485.0*p203)+(594.0*p102*(-408.0+(39.0*p20)+(5.0*p30)))+(27.0*p202*(-816.0+(35.0*p30)))+(36.0*p20*(4641.0+(-204.0*p30)+(7.0*p302)))+(4.0*p30*(4641.0+(-204.0*p30)+(7.0*p302)))+(9.0*p10*(92820.0+(990.0*p202)+(-1632.0*p30)+(35.0*p302)+(66.0*p20*(-204.0+(5.0*p30)))))))+(59670.0*p10*p112*p31)+(-33048.0*p102*p112*p31)+(5103.0*p103*p112*p31)+(-35802.0*p112*p20*p31)+(-16524.0*p10*p112*p20*p31)+(6804.0*p102*p112*p20*p31)+(22032.0*p112*p202*p31)+(-3645.0*p112*p203*p31)+(214812.0*p10*p11*p21*p31)+(-99144.0*p102*p11*p21*p31)+(13608.0*p103*p11*p21*p31)+(-132192.0*p10*p11*p20*p21*p31)+(30618.0*p102*p11*p20*p21*p31)+(21870.0*p10*p11*p202*p21*p31)+(250614.0*p10*p212*p31)+(-88128.0*p102*p212*p31)+(10206.0*p103*p212*p31)+(167076.0*p20*p212*p31)+(-198288.0*p10*p20*p212*p31)+(32805.0*p102*p20*p212*p31)+(-99144.0*p202*p212*p31)+(40095.0*p10*p202*p212*p31)+(16038.0*p203*p212*p31)+(-83538.0*p112*p30*p31)+(14688.0*p10*p112*p30*p31)+(66096.0*p112*p20*p30*p31)+(-7290.0*p10*p112*p20*p30*p31)+(-13365.0*p112*p202*p30*p31)+(-334152.0*p11*p21*p30*p31)+(7290.0*p102*p11*p21*p30*p31)+(198288.0*p11*p20*p21*p30*p31)+(-32076.0*p11*p202*p21*p30*p31)+(-501228.0*p212*p30*p31)+(-66096.0*p10*p212*p30*p31)+(13365.0*p102*p212*p30*p31)+(121176.0*p20*p212*p30*p31)+(32076.0*p10*p20*p212*p30*p31)+(44064.0*p112*p302*p31)+(-4455.0*p10*p112*p302*p31)+(-16038.0*p112*p20*p302*p31)+(242352.0*p11*p21*p302*p31)+(-10692.0*p10*p11*p21*p302*p31)+(-69498.0*p11*p20*p21*p302*p31)+(484704.0*p212*p302*p31)+(-81081.0*p20*p212*p302*p31)+(-7722.0*p112*p303*p31)+(-54054.0*p11*p21*p303*p31)+(-135135.0*p212*p303*p31)+(83538.0*p10*p11*p312)+(-29376.0*p102*p11*p312)+(3402.0*p103*p11*p312)+(55692.0*p11*p20*p312)+(-66096.0*p10*p11*p20*p312)+(10935.0*p102*p11*p20*p312)+(-33048.0*p11*p202*p312)+(13365.0*p10*p11*p202*p312)+(5346.0*p11*p203*p312)+(278460.0*p10*p21*p312)+(-66096.0*p102*p21*p312)+(6075.0*p103*p21*p312)+(501228.0*p20*p21*p312)+(-231336.0*p10*p20*p21*p312)+(26730.0*p102*p20*p21*p312)+(-242352.0*p202*p21*p312)+(48114.0*p10*p202*p21*p312)+(34749.0*p203*p21*p312)+(-167076.0*p11*p30*p312)+(-22032.0*p10*p11*p30*p312)+(4455.0*p102*p11*p30*p312)+(40392.0*p11*p20*p30*p312)+(10692.0*p10*p11*p20*p30*p312)+(-835380.0*p21*p30*p312)+(-161568.0*p10*p21*p30*p312)+(16038.0*p102*p21*p30*p312)+(-242352.0*p20*p21*p30*p312)+(69498.0*p10*p20*p21*p30*p312)+(81081.0*p202*p21*p30*p312)+(161568.0*p11*p302*p312)+(-27027.0*p11*p20*p302*p312)+(1050192.0*p21*p302*p312)+(27027.0*p10*p21*p302*p312)+(-45045.0*p11*p303*p312)+(-360360.0*p21*p303*p312)+(167076.0*p10*p313)+(-22032.0*p102*p313)+(1485.0*p103*p313)+(835380.0*p20*p313)+(-121176.0*p10*p20*p313)+(8910.0*p102*p20*p313)+(-242352.0*p202*p313)+(23166.0*p10*p202*p313)+(27027.0*p203*p313)+(3063060.0*p30*p313)+(-161568.0*p10*p30*p313)+(7722.0*p102*p30*p313)+(-1050192.0*p20*p30*p313)+(54054.0*p10*p20*p30*p313)+(135135.0*p202*p30*p313)+(-2450448.0*p302*p313)+(45045.0*p10*p302*p313)+(360360.0*p20*p302*p313)+(680680.0*p303*p313)+(-3.0*p012*((27846.0*p20*p21)+(-9792.0*p202*p21)+(1134.0*p203*p21)+(891.0*p103*((13.0*p11)+(2.0*p21)))+(9282.0*p21*p30)+(-6732.0*p20*p21*p30)+(1260.0*p202*p21*p30)+(-1428.0*p21*p302)+(567.0*p20*p21*p302)+(105.0*p21*p303)+(3.0*p11*((675.0*p203)+(27.0*p202*(-272.0+(21.0*p30)))+(4.0*p30*(1547.0+(-136.0*p30)+(7.0*p302)))+(4.0*p20*(7735.0+(-884.0*p30)+(49.0*p302)))))+(3978.0*p20*p31)+(-1836.0*p202*p31)+(252.0*p203*p31)+(2210.0*p30*p31)+(-1836.0*p20*p30*p31)+(378.0*p202*p30*p31)+(-544.0*p302*p31)+(225.0*p20*p302*p31)+(55.0*p303*p31)+(27.0*p102*((22.0*p11*(-136.0+(27.0*p20)+(5.0*p30)))+(3.0*p21*(-136.0+(55.0*p20)+(15.0*p30)))+(((15.0*p20)+(7.0*p30))*p31)))+(3.0*p10*((9.0*p11*(6188.0+(330.0*p202)+(-544.0*p30)+(21.0*p302)+(6.0*p20*(-476.0+(25.0*p30)))))+(p21*((1215.0*p202)+(108.0*p20*(-68.0+(7.0*p30)))+(4.0*(1547.0+(-544.0*p30)+(35.0*p302)))))+(3.0*((63.0*p202)+(2.0*p30*(-68.0+(7.0*p30)))+(8.0*p20*(-34.0+(7.0*p30))))*p31)))))+(p003*((-680680.0*p013)+(27027.0*p113)+(1485.0*p213)+(945.0*p212*p31)+(252.0*p21*p312)+(28.0*p313)+(3003.0*p012*((120.0*p11)+(15.0*p21)+p31))+(594.0*p112*((39.0*p21)+(5.0*p31)))+(45.0*p11*((198.0*p212)+(66.0*p21*p31)+(7.0*p312)))+(33.0*p01*((4095.0*p112)+(234.0*p212)+(60.0*p21*p31)+(5.0*p312)+(78.0*p11*((21.0*p21)+(2.0*p31)))))))+(-3.0*p002*((-297.0*p113*(-136.0+(39.0*p10)+(6.0*p20)))+(4896.0*p213)+(-2025.0*p10*p213)+(-1134.0*p20*p213)+(-252.0*p213*p30)+(1001.0*p013*(-816.0+(120.0*p10)+(15.0*p20)+p30))+(4284.0*p212*p31)+(-1701.0*p10*p212*p31)+(-1260.0*p20*p212*p31)+(-378.0*p212*p30*p31)+(1632.0*p21*p312)+(-588.0*p10*p21*p312)+(-567.0*p20*p21*p312)+(-225.0*p21*p30*p312)+(272.0*p313)+(-84.0*p10*p313)+(-105.0*p20*p313)+(-55.0*p30*p313)+(33.0*p012*((39.0*p11*(272.0+(7.0*p20)+p30))+(p21*(1632.0+(-273.0*p10)+(6.0*p30)))+((136.0+(-39.0*p10)+(-6.0*p20))*p31)))+(-27.0*p112*((3.0*p21*(-544.0+(198.0*p10)+(55.0*p20)+(5.0*p30)))+((-272.0+(110.0*p10)+(45.0*p20)+(7.0*p30))*p31)))+(-3.0*p11*((27.0*p212*(-272.0+(110.0*p10)+(45.0*p20)+(7.0*p30)))+(6.0*p21*(-544.0+(225.0*p10)+(126.0*p20)+(28.0*p30))*p31)+(7.0*(-68.0+(27.0*p10)+(20.0*p20)+(6.0*p30))*p312)))+(-1.0*p01*((27.0*p212*(-544.0+(198.0*p10)+(55.0*p20)+(5.0*p30)))+(297.0*p112*((91.0*p10)+(-2.0*(272.0+p30))))+(18.0*p21*(-272.0+(110.0*p10)+(45.0*p20)+(7.0*p30))*p31)+((-544.0+(225.0*p10)+(126.0*p20)+(28.0*p30))*p312)+(18.0*p11*((33.0*(-136.0+(39.0*p10)+(6.0*p20))*p21)+((-544.0+(198.0*p10)+(55.0*p20)+(5.0*p30))*p31)))))))+(-3.0*p00*((-19890.0*p213)+(16524.0*p10*p213)+(-3402.0*p102*p213)+(11016.0*p20*p213)+(-4536.0*p10*p20*p213)+(-1701.0*p202*p213)+(2448.0*p213*p30)+(-1134.0*p10*p213*p30)+(-810.0*p20*p213*p30)+(11.0*p013*(92820.0+(4095.0*p102)+(234.0*p202)+(-408.0*p30)+(5.0*p302)+(78.0*p10*(-408.0+(21.0*p20)+(2.0*p30)))+(12.0*p20*(-408.0+(5.0*p30)))))+(-9.0*p113*(6188.0+(594.0*p102)+(-135.0*p202)+(272.0*p30)+(-126.0*p20*p30)+(-28.0*p302)+(-18.0*p10*(204.0+(5.0*p30)))))+(-27846.0*p212*p31)+(20196.0*p10*p212*p31)+(-3780.0*p102*p212*p31)+(19584.0*p20*p212*p31)+(-6804.0*p10*p20*p212*p31)+(-3645.0*p202*p212*p31)+(7344.0*p212*p30*p31)+(-2430.0*p10*p212*p30*p31)+(-2970.0*p20*p212*p30*p31)+(-594.0*p212*p302*p31)+(-18564.0*p21*p312)+(10608.0*p10*p21*p312)+(-1701.0*p102*p21*p312)+(14688.0*p20*p21*p312)+(-4050.0*p10*p20*p21*p312)+(-2970.0*p202*p21*p312)+(8568.0*p21*p30*p312)+(-1980.0*p10*p21*p30*p312)+(-3564.0*p20*p21*p30*p312)+(-1287.0*p21*p302*p312)+(-6188.0*p313)+(2448.0*p10*p313)+(-315.0*p102*p313)+(4896.0*p20*p313)+(-990.0*p10*p20*p313)+(-990.0*p202*p313)+(4488.0*p30*p313)+(-660.0*p10*p30*p313)+(-1716.0*p20*p30*p313)+(-1001.0*p302*p313)+(-9.0*p112*((3.0*p21*(3094.0+(495.0*p102)+(18.0*p10*(-136.0+(15.0*p20)))+(68.0*p30)+(-21.0*p302)+(-8.0*p20*(68.0+(7.0*p30)))))+((2210.0+(405.0*p102)+(-816.0*p20)+(84.0*p202)+(14.0*p10*((27.0*p20)+(4.0*(-34.0+p30))))+(-68.0*p30)+(-15.0*p302))*p31)))+(p012*((9.0*p11*(-30940.0+(3003.0*p102)+(594.0*p202)+(-952.0*p30)+(25.0*p302)+(44.0*p20*(-136.0+(5.0*p30)))+(66.0*p10*(-136.0+(39.0*p20)+(6.0*p30)))))+(9.0*p21*(-6188.0+(165.0*p202)+(-272.0*p30)+(14.0*p302)+(22.0*p10*(68.0+(18.0*p20)+(5.0*p30)))+(p20*(-816.0+(90.0*p30)))))+((-6188.0+(-594.0*p102)+(135.0*p202)+(-272.0*p30)+(126.0*p20*p30)+(28.0*p302)+(18.0*p10*(204.0+(5.0*p30))))*p31)))+(-3.0*p11*((9.0*p212*(2210.0+(405.0*p102)+(-816.0*p20)+(84.0*p202)+(14.0*p10*((27.0*p20)+(4.0*(-34.0+p30))))+(-68.0*p30)+(-15.0*p302)))+(6.0*p21*((378.0*p102)+(189.0*p202)+(34.0*(65.0+(-8.0*p30)))+(18.0*p20*(-68.0+(5.0*p30)))+(18.0*p10*(-102.0+(28.0*p20)+(7.0*p30))))*p31)+((3094.0+(420.0*p102)+(405.0*p202)+(-816.0*p30)+(66.0*p302)+(6.0*p10*(-374.0+(126.0*p20)+(45.0*p30)))+(p20*(-2176.0+(330.0*p30))))*p312)))+(p01*((-9.0*p212*(3094.0+(495.0*p102)+(18.0*p10*(-136.0+(15.0*p20)))+(68.0*p30)+(-21.0*p302)+(-8.0*p20*(68.0+(7.0*p30)))))+(27.0*p112*(-6188.0+(165.0*p202)+(-272.0*p30)+(14.0*p302)+(22.0*p10*(68.0+(18.0*p20)+(5.0*p30)))+(p20*(-816.0+(90.0*p30)))))+(-6.0*p21*(2210.0+(405.0*p102)+(-816.0*p20)+(84.0*p202)+(14.0*p10*((27.0*p20)+(4.0*(-34.0+p30))))+(-68.0*p30)+(-15.0*p302))*p31)+(-1.0*((378.0*p102)+(189.0*p202)+(34.0*(65.0+(-8.0*p30)))+(18.0*p20*(-68.0+(5.0*p30)))+(18.0*p10*(-102.0+(28.0*p20)+(7.0*p30))))*p312)+(-6.0*p11*((3.0*p21*(6188.0+(594.0*p102)+(-135.0*p202)+(272.0*p30)+(-126.0*p20*p30)+(-28.0*p302)+(-18.0*p10*(204.0+(5.0*p30)))))+((3094.0+(495.0*p102)+(18.0*p10*(-136.0+(15.0*p20)))+(68.0*p30)+(-21.0*p302)+(-8.0*p20*(68.0+(7.0*p30))))*p31)))))))+(-3.0*p01*((19890.0*p20*p212)+(-11016.0*p202*p212)+(1701.0*p203*p212)+(19890.0*p212*p30)+(-17136.0*p20*p212*p30)+(3645.0*p202*p212*p30)+(-7344.0*p212*p302)+(2970.0*p20*p212*p302)+(990.0*p212*p303)+(9.0*p112*((378.0*p203)+(12.0*p202*(-272.0+(35.0*p30)))+(7.0*p30*(442.0+(-68.0*p30)+(5.0*p302)))+(3.0*p20*(3094.0+(-748.0*p30)+(63.0*p302)))))+(7956.0*p20*p21*p31)+(-4896.0*p202*p21*p31)+(810.0*p203*p21*p31)+(18564.0*p21*p30*p31)+(-14688.0*p20*p21*p30*p31)+(2970.0*p202*p21*p30*p31)+(-9792.0*p21*p302*p31)+(3564.0*p20*p21*p302*p31)+(1716.0*p21*p303*p31)+(6188.0*p30*p312)+(-3672.0*p20*p30*p312)+(594.0*p202*p30*p312)+(-4488.0*p302*p312)+(1287.0*p20*p302*p312)+(1001.0*p303*p312)+(9.0*p103*((594.0*p112)+(-135.0*p212)+(-90.0*p11*p31)+(-126.0*p21*p31)+(-28.0*p312)))+(6.0*p11*((189.0*p203*((4.0*p21)+p31))+(9.0*p202*((18.0*p21*(-34.0+(7.0*p30)))+((-136.0+(45.0*p30))*p31)))+(p30*((3.0*p21*(2210.0+(-544.0*p30)+(55.0*p302)))+(2.0*(1105.0+(-408.0*p30)+(55.0*p302))*p31)))+(p20*((27.0*p21*(442.0+(-204.0*p30)+(25.0*p302)))+(2.0*(1105.0+(-952.0*p30)+(165.0*p302))*p31)))))+(9.0*p102*((27.0*p112*(-136.0+(55.0*p20)+(15.0*p30)))+(p11*((810.0*p20*p21)+(378.0*p21*p30)+(8.0*(68.0+(7.0*p30))*p31)))+(3.0*((4.0*p212*(68.0+(7.0*p30)))+(-8.0*(-34.0+(7.0*p20))*p21*p31)+((68.0+(-21.0*p20)+(-5.0*p30))*p312)))))+(3.0*p10*((9.0*p212*(-442.0+(84.0*p202)+(-272.0*p30)+(45.0*p302)+(6.0*p20*(-34.0+(21.0*p30)))))+(3.0*p112*((1215.0*p202)+(108.0*p20*(-68.0+(7.0*p30)))+(4.0*(1547.0+(-544.0*p30)+(35.0*p302)))))+(2.0*p21*(-2210.0+(-544.0*p30)+(165.0*p302)+(18.0*p20*(34.0+(15.0*p30))))*p31)+(3.0*(-442.0+(272.0*p20)+(-45.0*p202)+(22.0*p302))*p312)+(6.0*p11*((18.0*p21*p30*(-68.0+(7.0*p30)))+((-442.0+(-272.0*p30)+(45.0*p302))*p31)+(21.0*p202*((27.0*p21)+(4.0*p31)))+(6.0*p20*((12.0*p21*(-34.0+(7.0*p30)))+((-34.0+(21.0*p30))*p31)))))))))));
	*accum = ((1.0/36.0)*((-1.0*p013)+p313));
}
static void cube_01(double *pixel, double *accum, Curve<4,2> *curve)
{
	const double &p00 = curve->p[0].v[0];
	const double &p01 = curve->p[0].v[1];
	const double &p10 = curve->p[1].v[0];
	const double &p11 = curve->p[1].v[1];
	const double &p20 = curve->p[2].v[0];
	const double &p21 = curve->p[2].v[1];
	const double &p30 = curve->p[3].v[0];
	const double &p31 = curve->p[3].v[1];
	const double p002 = p00*p00;
	const double p012 = p01*p01;
	const double p102 = p10*p10;
	const double p112 = p11*p11;
	const double p202 = p20*p20;
	const double p212 = p21*p21;
	const double p302 = p30*p30;
	const double p312 = p31*p31;
	const double p003 = p00*p002;
	const double p013 = p01*p012;
	const double p103 = p10*p102;
	const double p113 = p11*p112;
	const double p203 = p20*p202;
	const double p213 = p21*p212;
	const double p303 = p30*p302;
	const double p313 = p31*p312;
	*pixel = ((1.0/24504480.0)*((-53703.0*p102*p11*p20)+(-33048.0*p102*p112*p20)+(10935.0*p102*p113*p20)+(-89505.0*p10*p11*p202)+(-49572.0*p10*p112*p202)+(15309.0*p10*p113*p202)+(-53703.0*p11*p203)+(-24786.0*p112*p203)+(6804.0*p113*p203)+(53703.0*p103*p21)+(33048.0*p103*p11*p21)+(-10935.0*p103*p112*p21)+(89505.0*p102*p20*p21)+(24786.0*p102*p11*p20*p21)+(53703.0*p10*p202*p21)+(-24786.0*p10*p11*p202*p21)+(20412.0*p10*p112*p202*p21)+(-33048.0*p11*p203*p21)+(15309.0*p112*p203*p21)+(24786.0*p103*p212)+(-15309.0*p103*p11*p212)+(49572.0*p102*p20*p212)+(-20412.0*p102*p11*p20*p212)+(33048.0*p10*p202*p212)+(10935.0*p11*p203*p212)+(-6804.0*p103*p213)+(-15309.0*p102*p20*p213)+(-10935.0*p10*p202*p213)+(-29835.0*p102*p11*p30)+(-16524.0*p102*p112*p30)+(5103.0*p102*p113*p30)+(-107406.0*p10*p11*p20*p30)+(-49572.0*p10*p112*p20*p30)+(13608.0*p10*p113*p20*p30)+(-125307.0*p11*p202*p30)+(-44064.0*p112*p202*p30)+(10206.0*p113*p202*p30)+(17901.0*p102*p21*p30)+(-8262.0*p102*p11*p21*p30)+(6804.0*p102*p112*p21*p30)+(-66096.0*p10*p11*p20*p21*p30)+(30618.0*p10*p112*p20*p21*p30)+(-83538.0*p202*p21*p30)+(-99144.0*p11*p202*p21*p30)+(32805.0*p112*p202*p21*p30)+(11016.0*p102*p212*p30)+(21870.0*p10*p11*p20*p212*p30)+(-49572.0*p202*p212*p30)+(40095.0*p11*p202*p212*p30)+(-3645.0*p102*p213*p30)+(16038.0*p202*p213*p30)+(-41769.0*p10*p11*p302)+(-14688.0*p10*p112*p302)+(3402.0*p10*p113*p302)+(-139230.0*p11*p20*p302)+(-33048.0*p112*p20*p302)+(6075.0*p113*p20*p302)+(-27846.0*p10*p21*p302)+(-33048.0*p10*p11*p21*p302)+(10935.0*p10*p112*p21*p302)+(-250614.0*p20*p21*p302)+(-115668.0*p11*p20*p21*p302)+(26730.0*p112*p20*p21*p302)+(-16524.0*p10*p212*p302)+(13365.0*p10*p11*p212*p302)+(-121176.0*p20*p212*p302)+(48114.0*p11*p20*p212*p302)+(5346.0*p10*p213*p302)+(34749.0*p20*p213*p302)+(-83538.0*p11*p303)+(-11016.0*p112*p303)+(1485.0*p113*p303)+(-417690.0*p21*p303)+(-60588.0*p11*p21*p303)+(8910.0*p112*p21*p303)+(-121176.0*p212*p303)+(23166.0*p11*p212*p303)+(27027.0*p213*p303)+(p013*((27027.0*p103)+(1485.0*p203)+(945.0*p202*p30)+(252.0*p20*p302)+(28.0*p303)+(594.0*p102*((39.0*p20)+(5.0*p30)))+(45.0*p10*((198.0*p202)+(66.0*p20*p30)+(7.0*p302)))))+(29835.0*p103*p31)+(16524.0*p103*p11*p31)+(-5103.0*p103*p112*p31)+(89505.0*p102*p20*p31)+(33048.0*p102*p11*p20*p31)+(-6804.0*p102*p112*p20*p31)+(125307.0*p10*p202*p31)+(22032.0*p10*p11*p202*p31)+(83538.0*p203*p31)+(3645.0*p112*p203*p31)+(24786.0*p103*p21*p31)+(-13608.0*p103*p11*p21*p31)+(77112.0*p102*p20*p21*p31)+(-30618.0*p102*p11*p20*p21*p31)+(99144.0*p10*p202*p21*p31)+(-21870.0*p10*p11*p202*p21*p31)+(49572.0*p203*p21*p31)+(-10206.0*p103*p212*p31)+(-32805.0*p102*p20*p212*p31)+(-40095.0*p10*p202*p212*p31)+(-16038.0*p203*p212*p31)+(41769.0*p102*p30*p31)+(7344.0*p102*p11*p30*p31)+(167076.0*p10*p20*p30*p31)+(7290.0*p10*p112*p20*p30*p31)+(250614.0*p202*p30*p31)+(-33048.0*p11*p202*p30*p31)+(13365.0*p112*p202*p30*p31)+(33048.0*p102*p21*p30*p31)+(-7290.0*p102*p11*p21*p30*p31)+(99144.0*p10*p20*p21*p30*p31)+(60588.0*p202*p21*p30*p31)+(32076.0*p11*p202*p21*p30*p31)+(-13365.0*p102*p212*p30*p31)+(-32076.0*p10*p20*p212*p30*p31)+(83538.0*p10*p302*p31)+(-11016.0*p10*p11*p302*p31)+(4455.0*p10*p112*p302*p31)+(417690.0*p20*p302*p31)+(-80784.0*p11*p20*p302*p31)+(16038.0*p112*p20*p302*p31)+(20196.0*p10*p21*p302*p31)+(10692.0*p10*p11*p21*p302*p31)+(-121176.0*p20*p21*p302*p31)+(69498.0*p11*p20*p21*p302*p31)+(81081.0*p20*p212*p302*p31)+(510510.0*p303*p31)+(-80784.0*p11*p303*p31)+(7722.0*p112*p303*p31)+(-525096.0*p21*p303*p31)+(54054.0*p11*p21*p303*p31)+(135135.0*p212*p303*p31)+(7344.0*p103*p312)+(-3402.0*p103*p11*p312)+(33048.0*p102*p20*p312)+(-10935.0*p102*p11*p20*p312)+(66096.0*p10*p202*p312)+(-13365.0*p10*p11*p202*p312)+(60588.0*p203*p312)+(-5346.0*p11*p203*p312)+(-6075.0*p103*p21*p312)+(-26730.0*p102*p20*p21*p312)+(-48114.0*p10*p202*p21*p312)+(-34749.0*p203*p21*p312)+(22032.0*p102*p30*p312)+(-4455.0*p102*p11*p30*p312)+(121176.0*p10*p20*p30*p312)+(-10692.0*p10*p11*p20*p30*p312)+(242352.0*p202*p30*p312)+(-16038.0*p102*p21*p30*p312)+(-69498.0*p10*p20*p21*p30*p312)+(-81081.0*p202*p21*p30*p312)+(80784.0*p10*p302*p312)+(525096.0*p20*p302*p312)+(27027.0*p11*p20*p302*p312)+(-27027.0*p10*p21*p302*p312)+(816816.0*p303*p312)+(45045.0*p11*p303*p312)+(360360.0*p21*p303*p312)+(-1485.0*p103*p313)+(-8910.0*p102*p20*p313)+(-23166.0*p10*p202*p313)+(-27027.0*p203*p313)+(-7722.0*p102*p30*p313)+(-54054.0*p10*p20*p30*p313)+(-135135.0*p202*p30*p313)+(-45045.0*p10*p302*p313)+(-360360.0*p20*p302*p313)+(-680680.0*p303*p313)+(p003*((680680.0*p013)+(-27027.0*p113)+(83538.0*p21)+(11016.0*p212)+(-1485.0*p213)+(9282.0*p31)+(3672.0*p21*p31)+(-945.0*p212*p31)+(408.0*p312)+(-252.0*p21*p312)+(-28.0*p313)+(-3003.0*p012*(272.0+(120.0*p11)+(15.0*p21)+p31))+(-594.0*p112*(-204.0+(39.0*p21)+(5.0*p31)))+(-33.0*p01*(15470.0+(4095.0*p112)+(-2448.0*p21)+(234.0*p212)+(-204.0*p31)+(60.0*p21*p31)+(5.0*p312)+(78.0*p11*(-204.0+(21.0*p21)+(2.0*p31)))))+(-9.0*p11*(-46410.0+(990.0*p212)+(-816.0*p31)+(35.0*p312)+(66.0*p21*(-102.0+(5.0*p31)))))))+(3.0*p012*((297.0*p103*(-68.0+(39.0*p11)+(6.0*p21)))+(63.0*p202*p30*(-34.0+(27.0*p11)+(20.0*p21)+(6.0*p31)))+(9.0*p203*(-272.0+(225.0*p11)+(126.0*p21)+(28.0*p31)))+(p303*(-136.0+(84.0*p11)+(105.0*p21)+(55.0*p31)))+(3.0*p20*p302*(-272.0+(196.0*p11)+(189.0*p21)+(75.0*p31)))+(27.0*p102*((3.0*p20*(-272.0+(198.0*p11)+(55.0*p21)+(5.0*p31)))+(p30*(-136.0+(110.0*p11)+(45.0*p21)+(7.0*p31)))))+(3.0*p10*((7.0*p302*(-34.0+(27.0*p11)+(20.0*p21)+(6.0*p31)))+(27.0*p202*(-136.0+(110.0*p11)+(45.0*p21)+(7.0*p31)))+(6.0*p20*p30*(-272.0+(225.0*p11)+(126.0*p21)+(28.0*p31)))))))+(3.0*p002*((9282.0*p11*p20)+(5508.0*p112*p20)+(-1782.0*p113*p20)+(13923.0*p20*p21)+(11016.0*p11*p20*p21)+(-4455.0*p112*p20*p21)+(4896.0*p20*p212)+(-3645.0*p11*p20*p212)+(-1134.0*p20*p213)+(1989.0*p21*p30)+(1224.0*p11*p21*p30)+(-405.0*p112*p21*p30)+(918.0*p212*p30)+(-567.0*p11*p212*p30)+(-252.0*p213*p30)+(1001.0*p013*((120.0*p10)+(15.0*p20)+p30))+(4641.0*p20*p31)+(3264.0*p11*p20*p31)+(-1215.0*p112*p20*p31)+(3366.0*p20*p21*p31)+(-2268.0*p11*p20*p21*p31)+(-1260.0*p20*p212*p31)+(1105.0*p30*p31)+(612.0*p11*p30*p31)+(-189.0*p112*p30*p31)+(918.0*p21*p30*p31)+(-504.0*p11*p21*p30*p31)+(-378.0*p212*p30*p31)+(714.0*p20*p312)+(-420.0*p11*p20*p312)+(-567.0*p20*p21*p312)+(272.0*p30*p312)+(-126.0*p11*p30*p312)+(-225.0*p21*p30*p312)+(-105.0*p20*p313)+(-55.0*p30*p313)+(-33.0*p012*(((68.0+(-39.0*p11)+(-6.0*p21))*p30)+(39.0*p10*(136.0+(7.0*p21)+p31))+(p20*(816.0+(-273.0*p11)+(6.0*p31)))))+(-1.0*p01*((p30*(3094.0+(-594.0*p112)+(135.0*p212)+(-136.0*p31)+(126.0*p21*p31)+(28.0*p312)+(18.0*p11*(102.0+(5.0*p31)))))+(9.0*p20*(3094.0+(-408.0*p21)+(165.0*p212)+(-136.0*p31)+(90.0*p21*p31)+(14.0*p312)+(22.0*p11*(34.0+(18.0*p21)+(5.0*p31)))))+(9.0*p10*(15470.0+(3003.0*p112)+(594.0*p212)+(-476.0*p31)+(25.0*p312)+(44.0*p21*(-68.0+(5.0*p31)))+(66.0*p11*(-68.0+(39.0*p21)+(6.0*p31)))))))+(-3.0*p10*((3861.0*p113)+(675.0*p213)+(198.0*p112*(-68.0+(27.0*p21)+(5.0*p31)))+(27.0*p212*(-136.0+(21.0*p31)))+(2.0*p31*(-1547.0+(-136.0*p31)+(14.0*p312)))+(2.0*p21*(-7735.0+(-884.0*p31)+(98.0*p312)))+(9.0*p11*(-3094.0+(330.0*p212)+(-272.0*p31)+(21.0*p312)+(6.0*p21*(-238.0+(25.0*p31)))))))))+(3.0*p01*((9.0*p103*(-3094.0+(594.0*p112)+(-135.0*p212)+(136.0*p31)+(-126.0*p21*p31)+(-28.0*p312)+(-18.0*p11*(102.0+(5.0*p31)))))+(9.0*p203*((378.0*p112)+(189.0*p212)+(18.0*p21*(-34.0+(5.0*p31)))+(18.0*p11*(-51.0+(28.0*p21)+(7.0*p31)))+(-17.0*(65.0+(8.0*p31)))))+(p303*(-3094.0+(315.0*p112)+(990.0*p212)+(-2244.0*p31)+(1001.0*p312)+(6.0*p11*(-204.0+(165.0*p21)+(110.0*p31)))+(12.0*p21*(-204.0+(143.0*p31)))))+(9.0*p202*p30*(-1547.0+(420.0*p112)+(405.0*p212)+(-408.0*p31)+(66.0*p312)+(6.0*p11*(-187.0+(126.0*p21)+(45.0*p31)))+(2.0*p21*(-544.0+(165.0*p31)))))+(3.0*p20*p302*(-3094.0+(567.0*p112)+(990.0*p212)+(-1428.0*p31)+(429.0*p312)+(36.0*p21*(-68.0+(33.0*p31)))+(2.0*p11*(-884.0+(675.0*p21)+(330.0*p31)))))+(9.0*p102*((p30*(-1105.0+(405.0*p112)+(-408.0*p21)+(84.0*p212)+(-34.0*p31)+(-15.0*p312)+(14.0*p11*(-68.0+(27.0*p21)+(4.0*p31)))))+(3.0*p20*(-1547.0+(495.0*p112)+(18.0*p11*(-68.0+(15.0*p21)))+(34.0*p31)+(-21.0*p312)+(-8.0*p21*(34.0+(7.0*p31)))))))+(3.0*p10*((9.0*p202*(-1105.0+(405.0*p112)+(-408.0*p21)+(84.0*p212)+(-34.0*p31)+(-15.0*p312)+(14.0*p11*(-68.0+(27.0*p21)+(4.0*p31)))))+(6.0*p20*p30*((378.0*p112)+(189.0*p212)+(18.0*p21*(-34.0+(5.0*p31)))+(18.0*p11*(-51.0+(28.0*p21)+(7.0*p31)))+(-17.0*(65.0+(8.0*p31)))))+(p302*(-1547.0+(420.0*p112)+(405.0*p212)+(-408.0*p31)+(66.0*p312)+(6.0*p11*(-187.0+(126.0*p21)+(45.0*p31)))+(2.0*p21*(-544.0+(165.0*p31)))))))))+(3.0*p00*((-5967.0*p11*p202)+(-3672.0*p112*p202)+(1215.0*p113*p202)+(9945.0*p202*p21)+(2754.0*p11*p202*p21)+(5508.0*p202*p212)+(-2268.0*p11*p202*p212)+(-1701.0*p202*p213)+(-6630.0*p11*p20*p30)+(-3672.0*p112*p20*p30)+(1134.0*p113*p20*p30)+(3978.0*p20*p21*p30)+(-1836.0*p11*p20*p21*p30)+(1512.0*p112*p20*p21*p30)+(2448.0*p20*p212*p30)+(-810.0*p20*p213*p30)+(-1989.0*p11*p302)+(-918.0*p112*p302)+(252.0*p113*p302)+(-1224.0*p11*p21*p302)+(567.0*p112*p21*p302)+(405.0*p11*p212*p302)+(11.0*p013*((4095.0*p102)+(234.0*p202)+(60.0*p20*p30)+(5.0*p302)+(78.0*p10*((21.0*p20)+(2.0*p30)))))+(9945.0*p202*p31)+(3672.0*p11*p202*p31)+(-756.0*p112*p202*p31)+(8568.0*p202*p21*p31)+(-3402.0*p11*p202*p21*p31)+(-3645.0*p202*p212*p31)+(9282.0*p20*p30*p31)+(1632.0*p11*p20*p30*p31)+(7344.0*p20*p21*p30*p31)+(-1620.0*p11*p20*p21*p30*p31)+(-2970.0*p20*p212*p30*p31)+(3094.0*p302*p31)+(135.0*p112*p302*p31)+(1836.0*p21*p302*p31)+(-594.0*p212*p302*p31)+(3672.0*p202*p312)+(-1215.0*p11*p202*p312)+(-2970.0*p202*p21*p312)+(4896.0*p20*p30*p312)+(-990.0*p11*p20*p30*p312)+(-3564.0*p20*p21*p30*p312)+(2244.0*p302*p312)+(-198.0*p11*p302*p312)+(-1287.0*p21*p302*p312)+(-990.0*p202*p313)+(-1716.0*p20*p30*p313)+(-1001.0*p302*p313)+(p012*((27.0*p202*(-272.0+(198.0*p11)+(55.0*p21)+(5.0*p31)))+(18.0*p20*p30*(-136.0+(110.0*p11)+(45.0*p21)+(7.0*p31)))+(p302*(-272.0+(225.0*p11)+(126.0*p21)+(28.0*p31)))+(297.0*p102*((91.0*p11)+(-2.0*(136.0+p31))))+(18.0*p10*((33.0*p20*(-68.0+(39.0*p11)+(6.0*p21)))+(p30*(-272.0+(198.0*p11)+(55.0*p21)+(5.0*p31)))))))+(-9.0*p102*((594.0*p113)+(378.0*p213)+(27.0*p112*(-68.0+(55.0*p21)+(15.0*p31)))+(12.0*p212*(-136.0+(35.0*p31)))+(7.0*p31*(-221.0+(-34.0*p31)+(5.0*p312)))+(3.0*p21*(-1547.0+(-374.0*p31)+(63.0*p312)))+(p11*((1215.0*p212)+(108.0*p21*(-34.0+(7.0*p31)))+(2.0*(-1547.0+(-544.0*p31)+(70.0*p312)))))))+(-1.0*p01*((-6.0*p20*p30*(-1105.0+(405.0*p112)+(-408.0*p21)+(84.0*p212)+(-34.0*p31)+(-15.0*p312)+(14.0*p11*(-68.0+(27.0*p21)+(4.0*p31)))))+(27.0*p102*(3094.0+(-408.0*p21)+(165.0*p212)+(-136.0*p31)+(90.0*p21*p31)+(14.0*p312)+(22.0*p11*(34.0+(18.0*p21)+(5.0*p31)))))+(-9.0*p202*(-1547.0+(495.0*p112)+(18.0*p11*(-68.0+(15.0*p21)))+(34.0*p31)+(-21.0*p312)+(-8.0*p21*(34.0+(7.0*p31)))))+(p302*((-378.0*p112)+(-189.0*p212)+(p21*(612.0+(-90.0*p31)))+(-18.0*p11*(-51.0+(28.0*p21)+(7.0*p31)))+(17.0*(65.0+(8.0*p31)))))+(-6.0*p10*((3.0*p20*(-3094.0+(594.0*p112)+(-135.0*p212)+(136.0*p31)+(-126.0*p21*p31)+(-28.0*p312)+(-18.0*p11*(102.0+(5.0*p31)))))+(p30*(-1547.0+(495.0*p112)+(18.0*p11*(-68.0+(15.0*p21)))+(34.0*p31)+(-21.0*p312)+(-8.0*p21*(34.0+(7.0*p31)))))))))+(-6.0*p10*((3.0*p20*((252.0*p213)+(27.0*p212*(-34.0+(21.0*p11)+(14.0*p31)))+(p31*(-1105.0+(189.0*p112)+(-272.0*p31)+(55.0*p312)+(18.0*p11*(-34.0+(7.0*p31)))))+(9.0*p21*(-221.0+(45.0*p112)+(-102.0*p31)+(25.0*p312)+(8.0*p11*(-17.0+(7.0*p31)))))))+(p30*((-135.0*p113)+(189.0*p213)+(12.0*p112*(34.0+(7.0*p31)))+(9.0*p212*(-68.0+(45.0*p31)))+(p31*(-1105.0+(-408.0*p31)+(110.0*p312)))+(p21*(-1105.0+(-952.0*p31)+(330.0*p312)))+(3.0*p11*(221.0+(84.0*p212)+(-136.0*p31)+(45.0*p312)+(6.0*p21*(-17.0+(21.0*p31)))))))))))));
	*accum = ((1.0/36.0)*((-3.0*p01)+(-3.0*p012)+(2.0*p013)+(p31*(3.0+(3.0*p31)+(-2.0*p312)))));
}
static void cube_11(double *pixel, double *accum, Curve<4,2> *curve)
{
	const double &p00 = curve->p[0].v[0];
	const double &p01 = curve->p[0].v[1];
	const double &p10 = curve->p[1].v[0];
	const double &p11 = curve->p[1].v[1];
	const double &p20 = curve->p[2].v[0];
	const double &p21 = curve->p[2].v[1];
	const double &p30 = curve->p[3].v[0];
	const double &p31 = curve->p[3].v[1];
	const double p002 = p00*p00;
	const double p012 = p01*p01;
	const double p102 = p10*p10;
	const double p112 = p11*p11;
	const double p202 = p20*p20;
	const double p212 = p21*p21;
	const double p302 = p30*p30;
	const double p312 = p31*p31;
	const double p003 = p00*p002;
	const double p013 = p01*p012;
	const double p103 = p10*p102;
	const double p113 = p11*p112;
	const double p203 = p20*p202;
	const double p213 = p21*p212;
	const double p303 = p30*p302;
	const double p313 = p31*p312;
	*pixel = ((1.0/12252240.0)*((-459459.0*p11*p20)+(-196911.0*p10*p11*p20)+(53703.0*p102*p11*p20)+(-196911.0*p112*p20)+(-107406.0*p10*p112*p20)+(33048.0*p102*p112*p20)+(53703.0*p113*p20)+(33048.0*p10*p113*p20)+(-10935.0*p102*p113*p20)+(-196911.0*p11*p202)+(89505.0*p10*p11*p202)+(-89505.0*p112*p202)+(49572.0*p10*p112*p202)+(24786.0*p113*p202)+(-15309.0*p10*p113*p202)+(53703.0*p11*p203)+(24786.0*p112*p203)+(-6804.0*p113*p203)+(459459.0*p10*p21)+(196911.0*p102*p21)+(-53703.0*p103*p21)+(196911.0*p10*p11*p21)+(107406.0*p102*p11*p21)+(-33048.0*p103*p11*p21)+(-53703.0*p10*p112*p21)+(-33048.0*p102*p112*p21)+(10935.0*p103*p112*p21)+(196911.0*p10*p20*p21)+(-89505.0*p102*p20*p21)+(-196911.0*p11*p20*p21)+(-24786.0*p102*p11*p20*p21)+(89505.0*p112*p20*p21)+(24786.0*p10*p112*p20*p21)+(-53703.0*p10*p202*p21)+(-107406.0*p11*p202*p21)+(24786.0*p10*p11*p202*p21)+(49572.0*p112*p202*p21)+(-20412.0*p10*p112*p202*p21)+(33048.0*p11*p203*p21)+(-15309.0*p112*p203*p21)+(196911.0*p10*p212)+(89505.0*p102*p212)+(-24786.0*p103*p212)+(-89505.0*p10*p11*p212)+(-49572.0*p102*p11*p212)+(15309.0*p103*p11*p212)+(107406.0*p10*p20*p212)+(-49572.0*p102*p20*p212)+(53703.0*p11*p20*p212)+(-24786.0*p10*p11*p20*p212)+(20412.0*p102*p11*p20*p212)+(-33048.0*p10*p202*p212)+(33048.0*p11*p202*p212)+(-10935.0*p11*p203*p212)+(-53703.0*p10*p213)+(-24786.0*p102*p213)+(6804.0*p103*p213)+(-33048.0*p10*p20*p213)+(15309.0*p102*p20*p213)+(10935.0*p10*p202*p213)+(-459459.0*p11*p30)+(-131274.0*p10*p11*p30)+(29835.0*p102*p11*p30)+(-131274.0*p112*p30)+(-59670.0*p10*p112*p30)+(16524.0*p102*p112*p30)+(29835.0*p113*p30)+(16524.0*p10*p113*p30)+(-5103.0*p102*p113*p30)+(-328185.0*p11*p20*p30)+(107406.0*p10*p11*p20*p30)+(-107406.0*p112*p20*p30)+(49572.0*p10*p112*p20*p30)+(24786.0*p113*p20*p30)+(-13608.0*p10*p113*p20*p30)+(125307.0*p11*p202*p30)+(44064.0*p112*p202*p30)+(-10206.0*p113*p202*p30)+(-918918.0*p21*p30)+(-17901.0*p102*p21*p30)+(-328185.0*p11*p21*p30)+(-71604.0*p10*p11*p21*p30)+(8262.0*p102*p11*p21*p30)+(89505.0*p112*p21*p30)+(33048.0*p10*p112*p21*p30)+(-6804.0*p102*p112*p21*p30)+(-328185.0*p20*p21*p30)+(-250614.0*p11*p20*p21*p30)+(66096.0*p10*p11*p20*p21*p30)+(77112.0*p112*p20*p21*p30)+(-30618.0*p10*p112*p20*p21*p30)+(83538.0*p202*p21*p30)+(99144.0*p11*p202*p21*p30)+(-32805.0*p112*p202*p21*p30)+(-328185.0*p212*p30)+(-11016.0*p102*p212*p30)+(125307.0*p11*p212*p30)+(22032.0*p10*p11*p212*p30)+(-167076.0*p20*p212*p30)+(99144.0*p11*p20*p212*p30)+(-21870.0*p10*p11*p20*p212*p30)+(49572.0*p202*p212*p30)+(-40095.0*p11*p202*p212*p30)+(83538.0*p213*p30)+(3645.0*p102*p213*p30)+(49572.0*p20*p213*p30)+(-16038.0*p202*p213*p30)+(-218790.0*p11*p302)+(41769.0*p10*p11*p302)+(-41769.0*p112*p302)+(14688.0*p10*p112*p302)+(7344.0*p113*p302)+(-3402.0*p10*p113*p302)+(139230.0*p11*p20*p302)+(33048.0*p112*p20*p302)+(-6075.0*p113*p20*p302)+(-765765.0*p21*p302)+(27846.0*p10*p21*p302)+(-167076.0*p11*p21*p302)+(33048.0*p10*p11*p21*p302)+(33048.0*p112*p21*p302)+(-10935.0*p10*p112*p21*p302)+(250614.0*p20*p21*p302)+(115668.0*p11*p20*p21*p302)+(-26730.0*p112*p20*p21*p302)+(-250614.0*p212*p302)+(16524.0*p10*p212*p302)+(66096.0*p11*p212*p302)+(-13365.0*p10*p11*p212*p302)+(121176.0*p20*p212*p302)+(-48114.0*p11*p20*p212*p302)+(60588.0*p213*p302)+(-5346.0*p10*p213*p302)+(-34749.0*p20*p213*p302)+(83538.0*p11*p303)+(11016.0*p112*p303)+(-1485.0*p113*p303)+(417690.0*p21*p303)+(60588.0*p11*p21*p303)+(-8910.0*p112*p21*p303)+(121176.0*p212*p303)+(-23166.0*p11*p212*p303)+(-27027.0*p213*p303)+(-1.0*p013*((27027.0*p103)+(1485.0*p203)+(594.0*p102*(-204.0+(39.0*p20)+(5.0*p30)))+(27.0*p202*(-408.0+(35.0*p30)))+(18.0*p20*(-4641.0+(-204.0*p30)+(14.0*p302)))+(2.0*p30*(-4641.0+(-204.0*p30)+(14.0*p302)))+(9.0*p10*(-46410.0+(990.0*p202)+(-816.0*p30)+(35.0*p302)+(66.0*p20*(-102.0+(5.0*p30)))))))+(459459.0*p10*p31)+(131274.0*p102*p31)+(-29835.0*p103*p31)+(131274.0*p10*p11*p31)+(59670.0*p102*p11*p31)+(-16524.0*p103*p11*p31)+(-29835.0*p10*p112*p31)+(-16524.0*p102*p112*p31)+(5103.0*p103*p112*p31)+(918918.0*p20*p31)+(328185.0*p10*p20*p31)+(-89505.0*p102*p20*p31)+(71604.0*p10*p11*p20*p31)+(-33048.0*p102*p11*p20*p31)+(17901.0*p112*p20*p31)+(-8262.0*p10*p112*p20*p31)+(6804.0*p102*p112*p20*p31)+(328185.0*p202*p31)+(-125307.0*p10*p202*p31)+(-22032.0*p10*p11*p202*p31)+(11016.0*p112*p202*p31)+(-83538.0*p203*p31)+(-3645.0*p112*p203*p31)+(328185.0*p10*p21*p31)+(107406.0*p102*p21*p31)+(-24786.0*p103*p21*p31)+(-107406.0*p10*p11*p21*p31)+(-49572.0*p102*p11*p21*p31)+(13608.0*p103*p11*p21*p31)+(328185.0*p20*p21*p31)+(250614.0*p10*p20*p21*p31)+(-77112.0*p102*p20*p21*p31)+(-66096.0*p10*p11*p20*p21*p31)+(30618.0*p102*p11*p20*p21*p31)+(167076.0*p202*p21*p31)+(-99144.0*p10*p202*p21*p31)+(21870.0*p10*p11*p202*p21*p31)+(-49572.0*p203*p21*p31)+(-125307.0*p10*p212*p31)+(-44064.0*p102*p212*p31)+(10206.0*p103*p212*p31)+(-83538.0*p20*p212*p31)+(-99144.0*p10*p20*p212*p31)+(32805.0*p102*p20*p212*p31)+(-49572.0*p202*p212*p31)+(40095.0*p10*p202*p212*p31)+(16038.0*p203*p212*p31)+(1531530.0*p30*p31)+(218790.0*p10*p30*p31)+(-41769.0*p102*p30*p31)+(-218790.0*p11*p30*p31)+(-7344.0*p102*p11*p30*p31)+(41769.0*p112*p30*p31)+(7344.0*p10*p112*p30*p31)+(765765.0*p20*p30*p31)+(-167076.0*p10*p20*p30*p31)+(-111384.0*p11*p20*p30*p31)+(33048.0*p112*p20*p30*p31)+(-7290.0*p10*p112*p20*p30*p31)+(-250614.0*p202*p30*p31)+(33048.0*p11*p202*p30*p31)+(-13365.0*p112*p202*p30*p31)+(-765765.0*p21*p30*p31)+(111384.0*p10*p21*p30*p31)+(-33048.0*p102*p21*p30*p31)+(167076.0*p11*p21*p30*p31)+(7290.0*p102*p11*p21*p30*p31)+(-99144.0*p10*p20*p21*p30*p31)+(99144.0*p11*p20*p21*p30*p31)+(-60588.0*p202*p21*p30*p31)+(-32076.0*p11*p202*p21*p30*p31)+(250614.0*p212*p30*p31)+(-33048.0*p10*p212*p30*p31)+(13365.0*p102*p212*p30*p31)+(60588.0*p20*p212*p30*p31)+(32076.0*p10*p20*p212*p30*p31)+(1021020.0*p302*p31)+(-83538.0*p10*p302*p31)+(-167076.0*p11*p302*p31)+(11016.0*p10*p11*p302*p31)+(22032.0*p112*p302*p31)+(-4455.0*p10*p112*p302*p31)+(-417690.0*p20*p302*p31)+(80784.0*p11*p20*p302*p31)+(-16038.0*p112*p20*p302*p31)+(-835380.0*p21*p302*p31)+(-20196.0*p10*p21*p302*p31)+(121176.0*p11*p21*p302*p31)+(-10692.0*p10*p11*p21*p302*p31)+(121176.0*p20*p21*p302*p31)+(-69498.0*p11*p20*p21*p302*p31)+(242352.0*p212*p302*p31)+(-81081.0*p20*p212*p302*p31)+(-510510.0*p303*p31)+(80784.0*p11*p303*p31)+(-7722.0*p112*p303*p31)+(525096.0*p21*p303*p31)+(-54054.0*p11*p21*p303*p31)+(-135135.0*p212*p303*p31)+(218790.0*p10*p312)+(41769.0*p102*p312)+(-7344.0*p103*p312)+(-41769.0*p10*p11*p312)+(-14688.0*p102*p11*p312)+(3402.0*p103*p11*p312)+(765765.0*p20*p312)+(167076.0*p10*p20*p312)+(-33048.0*p102*p20*p312)+(-27846.0*p11*p20*p312)+(-33048.0*p10*p11*p20*p312)+(10935.0*p102*p11*p20*p312)+(250614.0*p202*p312)+(-66096.0*p10*p202*p312)+(-16524.0*p11*p202*p312)+(13365.0*p10*p11*p202*p312)+(-60588.0*p203*p312)+(5346.0*p11*p203*p312)+(-139230.0*p10*p21*p312)+(-33048.0*p102*p21*p312)+(6075.0*p103*p21*p312)+(-250614.0*p20*p21*p312)+(-115668.0*p10*p20*p21*p312)+(26730.0*p102*p20*p21*p312)+(-121176.0*p202*p21*p312)+(48114.0*p10*p202*p21*p312)+(34749.0*p203*p21*p312)+(2042040.0*p30*p312)+(167076.0*p10*p30*p312)+(-22032.0*p102*p30*p312)+(83538.0*p11*p30*p312)+(-11016.0*p10*p11*p30*p312)+(4455.0*p102*p11*p30*p312)+(835380.0*p20*p30*p312)+(-121176.0*p10*p20*p30*p312)+(20196.0*p11*p20*p30*p312)+(10692.0*p10*p11*p20*p30*p312)+(-242352.0*p202*p30*p312)+(417690.0*p21*p30*p312)+(-80784.0*p10*p21*p30*p312)+(16038.0*p102*p21*p30*p312)+(-121176.0*p20*p21*p30*p312)+(69498.0*p10*p20*p21*p30*p312)+(81081.0*p202*p21*p30*p312)+(1531530.0*p302*p312)+(-80784.0*p10*p302*p312)+(80784.0*p11*p302*p312)+(-525096.0*p20*p302*p312)+(-27027.0*p11*p20*p302*p312)+(525096.0*p21*p302*p312)+(27027.0*p10*p21*p302*p312)+(-816816.0*p303*p312)+(-45045.0*p11*p303*p312)+(-360360.0*p21*p303*p312)+(-83538.0*p10*p313)+(-11016.0*p102*p313)+(1485.0*p103*p313)+(-417690.0*p20*p313)+(-60588.0*p10*p20*p313)+(8910.0*p102*p20*p313)+(-121176.0*p202*p313)+(23166.0*p10*p202*p313)+(27027.0*p203*p313)+(-1531530.0*p30*p313)+(-80784.0*p10*p30*p313)+(7722.0*p102*p30*p313)+(-525096.0*p20*p30*p313)+(54054.0*p10*p20*p30*p313)+(135135.0*p202*p30*p313)+(-1225224.0*p302*p313)+(45045.0*p10*p302*p313)+(360360.0*p20*p302*p313)+(680680.0*p303*p313)+(p003*((-680680.0*p013)+(27027.0*p113)+(-83538.0*p21)+(-11016.0*p212)+(1485.0*p213)+(-9282.0*p31)+(-3672.0*p21*p31)+(945.0*p212*p31)+(-408.0*p312)+(252.0*p21*p312)+(28.0*p313)+(3003.0*p012*(272.0+(120.0*p11)+(15.0*p21)+p31))+(594.0*p112*(-204.0+(39.0*p21)+(5.0*p31)))+(33.0*p01*(15470.0+(4095.0*p112)+(-2448.0*p21)+(234.0*p212)+(-204.0*p31)+(60.0*p21*p31)+(5.0*p312)+(78.0*p11*(-204.0+(21.0*p21)+(2.0*p31)))))+(9.0*p11*(-46410.0+(990.0*p212)+(-816.0*p31)+(35.0*p312)+(66.0*p21*(-102.0+(5.0*p31)))))))+(-3.0*p012*((297.0*p103*(-68.0+(39.0*p11)+(6.0*p21)))+(9.0*p203*(-272.0+(225.0*p11)+(126.0*p21)+(28.0*p31)))+(9.0*p202*(1547.0+(-238.0*p30)+(9.0*p11*(-136.0+(21.0*p30)))+(4.0*p21*(-136.0+(35.0*p30)))+(-102.0*p31)+(42.0*p30*p31)))+(p30*(12155.0+(1105.0*p30)+(-136.0*p302)+(21.0*p21*(-221.0+(-34.0*p30)+(5.0*p302)))+(p11*(-9282.0+(-816.0*p30)+(84.0*p302)))+(-1105.0*p31)+(-272.0*p30*p31)+(55.0*p302*p31)))+(3.0*p20*(24310.0+(2210.0*p30)+(-272.0*p302)+(3.0*p21*(-1547.0+(-374.0*p30)+(63.0*p302)))+(2.0*p11*(-7735.0+(-884.0*p30)+(98.0*p302)))+(-663.0*p31)+(-306.0*p30*p31)+(75.0*p302*p31)))+(27.0*p102*(3094.0+(-204.0*p21)+(-136.0*p30)+(45.0*p21*p30)+(22.0*p11*(-68.0+(27.0*p20)+(5.0*p30)))+(7.0*p30*p31)+(3.0*p20*(-272.0+(55.0*p21)+(5.0*p31)))))+(3.0*p10*(85085.0+(-3094.0*p21)+(3094.0*p30)+(-1088.0*p21*p30)+(-238.0*p302)+(140.0*p21*p302)+(9.0*p11*(-3094.0+(330.0*p202)+(-272.0*p30)+(21.0*p302)+(6.0*p20*(-238.0+(25.0*p30)))))+(-204.0*p30*p31)+(42.0*p302*p31)+(27.0*p202*(-136.0+(45.0*p21)+(7.0*p31)))+(12.0*p20*(1547.0+(9.0*p21*(-34.0+(7.0*p30)))+(-34.0*p31)+(2.0*p30*(-68.0+(7.0*p31)))))))))+(-3.0*p002*((-297.0*p113*(-68.0+(39.0*p10)+(6.0*p20)))+(-72930.0*p21)+(46410.0*p10*p21)+(13923.0*p20*p21)+(-13923.0*p212)+(11016.0*p10*p212)+(4896.0*p20*p212)+(2448.0*p213)+(-2025.0*p10*p213)+(-1134.0*p20*p213)+(1989.0*p21*p30)+(918.0*p212*p30)+(-252.0*p213*p30)+(1001.0*p013*(-408.0+(120.0*p10)+(15.0*p20)+p30))+(-12155.0*p31)+(9282.0*p10*p31)+(4641.0*p20*p31)+(-6630.0*p21*p31)+(5304.0*p10*p21*p31)+(3366.0*p20*p21*p31)+(2142.0*p212*p31)+(-1701.0*p10*p212*p31)+(-1260.0*p20*p212*p31)+(1105.0*p30*p31)+(918.0*p21*p30*p31)+(-378.0*p212*p30*p31)+(-1105.0*p312)+(816.0*p10*p312)+(714.0*p20*p312)+(816.0*p21*p312)+(-588.0*p10*p21*p312)+(-567.0*p20*p21*p312)+(272.0*p30*p312)+(-225.0*p21*p30*p312)+(136.0*p313)+(-84.0*p10*p313)+(-105.0*p20*p313)+(-55.0*p30*p313)+(-33.0*p012*(-15470.0+(816.0*p20)+(-816.0*p21)+(68.0*p30)+(-6.0*p21*p30)+(-39.0*p11*(136.0+(7.0*p20)+p30))+(-68.0*p31)+(6.0*p20*p31)+(39.0*p10*(136.0+(7.0*p21)+p31))))+(-27.0*p112*(3094.0+(-816.0*p21)+(15.0*p21*p30)+(-136.0*p31)+(7.0*p30*p31)+(22.0*p10*(-68.0+(27.0*p21)+(5.0*p31)))+(3.0*p20*(-68.0+(55.0*p21)+(15.0*p31)))))+(-1.0*p01*(-340340.0+(27846.0*p20)+(55692.0*p21)+(-3672.0*p20*p21)+(-7344.0*p212)+(1485.0*p20*p212)+(3094.0*p30)+(135.0*p212*p30)+(-594.0*p112*(136.0+p30))+(6188.0*p31)+(-1224.0*p20*p31)+(-2448.0*p21*p31)+(810.0*p20*p21*p31)+(-136.0*p30*p31)+(126.0*p21*p30*p31)+(-272.0*p312)+(126.0*p20*p312)+(28.0*p30*p312)+(18.0*p11*(15470.0+(-2244.0*p21)+(102.0*p30)+(-272.0*p31)+(5.0*p30*p31)+(11.0*p20*(34.0+(18.0*p21)+(5.0*p31)))))+(9.0*p10*(15470.0+(3003.0*p112)+(594.0*p212)+(-476.0*p31)+(25.0*p312)+(44.0*p21*(-68.0+(5.0*p31)))+(66.0*p11*(-68.0+(39.0*p21)+(6.0*p31)))))))+(-3.0*p11*(85085.0+(18564.0*p21)+(-3672.0*p212)+(-408.0*p21*p30)+(189.0*p212*p30)+(3094.0*p31)+(-1632.0*p21*p31)+(-204.0*p30*p31)+(168.0*p21*p30*p31)+(-238.0*p312)+(42.0*p30*p312)+(p20*(-3094.0+(-3672.0*p21)+(1215.0*p212)+(-1088.0*p31)+(756.0*p21*p31)+(140.0*p312)))+(9.0*p10*(-3094.0+(330.0*p212)+(-272.0*p31)+(21.0*p312)+(6.0*p21*(-238.0+(25.0*p31)))))))))+(-3.0*p01*((9.0*p103*(-3094.0+(594.0*p112)+(-135.0*p212)+(136.0*p31)+(-126.0*p21*p31)+(-28.0*p312)+(-18.0*p11*(102.0+(5.0*p31)))))+(9.0*p203*((378.0*p112)+(189.0*p212)+(18.0*p21*(-34.0+(5.0*p31)))+(18.0*p11*(-51.0+(28.0*p21)+(7.0*p31)))+(-17.0*(65.0+(8.0*p31)))))+(9.0*p202*(4862.0+(-1547.0*p30)+(12.0*p112*(-136.0+(35.0*p30)))+(9.0*p212*(-68.0+(45.0*p30)))+(442.0*p31)+(-408.0*p30*p31)+(66.0*p30*p312)+(6.0*p11*(663.0+(-187.0*p30)+(18.0*p21*(-17.0+(7.0*p30)))+(-68.0*p31)+(45.0*p30*p31)))+(2.0*p21*(1105.0+(-544.0*p30)+(-136.0*p31)+(165.0*p30*p31)))))+(9.0*p102*(12155.0+(408.0*p212)+(-1105.0*p30)+(-408.0*p21*p30)+(84.0*p212*p30)+(27.0*p112*(-68.0+(55.0*p20)+(15.0*p30)))+(-442.0*p31)+(408.0*p21*p31)+(-34.0*p30*p31)+(102.0*p312)+(-15.0*p30*p312)+(p11*((54.0*p20*(-68.0+(15.0*p21)))+(68.0*(91.0+(4.0*p31)))+(14.0*p30*(-68.0+(27.0*p21)+(4.0*p31)))))+(-3.0*p20*(1547.0+(-34.0*p31)+(21.0*p312)+(8.0*p21*(34.0+(7.0*p31)))))))+(3.0*p20*(51051.0+(12155.0*p30)+(-3094.0*p302)+(9.0*p112*(-1547.0+(-374.0*p30)+(63.0*p302)))+(3.0*p212*(-1105.0+(-952.0*p30)+(330.0*p302)))+(2431.0*p31)+(3094.0*p30*p31)+(-1428.0*p302*p31)+(-612.0*p30*p312)+(429.0*p302*p312)+(6.0*p21*((-221.0*(-11.0+p31))+(-102.0*p30*(-13.0+(4.0*p31)))+(6.0*p302*(-68.0+(33.0*p31)))))+(p11*((54.0*p21*(-221.0+(-102.0*p30)+(25.0*p302)))+(1105.0*(33.0+(-2.0*p31)))+(-136.0*p30*(-65.0+(14.0*p31)))+(4.0*p302*(-442.0+(165.0*p31)))))))+(p30*(51051.0+(12155.0*p30)+(-3094.0*p302)+(63.0*p112*(-221.0+(-34.0*p30)+(5.0*p302)))+(9.0*p212*(-1105.0+(-408.0*p30)+(110.0*p302)))+(12155.0*p31)+(6188.0*p30*p31)+(-2244.0*p302*p31)+(-3094.0*p312)+(-2244.0*p30*p312)+(1001.0*p302*p312)+(3.0*p11*((6.0*p21*(-1105.0+(-272.0*p30)+(55.0*p302)))+(1105.0*(11.0+(-2.0*p31)))+(-34.0*p30*(-65.0+(24.0*p31)))+(4.0*p302*(-102.0+(55.0*p31)))))+(6.0*p21*((221.0*(22.0+(-7.0*p31)))+(-17.0*p30*(-91.0+(48.0*p31)))+(p302*(-408.0+(286.0*p31)))))))+(3.0*p10*(102102.0+(1989.0*p212)+(9724.0*p30)+(4420.0*p21*p30)+(-1224.0*p212*p30)+(-1547.0*p302)+(-1088.0*p21*p302)+(405.0*p212*p302)+(3.0*p112*((1215.0*p202)+(108.0*p20*(-34.0+(7.0*p30)))+(2.0*(-1547.0+(-544.0*p30)+(70.0*p302)))))+(-2431.0*p31)+(2210.0*p21*p31)+(884.0*p30*p31)+(-544.0*p21*p30*p31)+(-408.0*p302*p31)+(330.0*p21*p302*p31)+(663.0*p312)+(66.0*p302*p312)+(9.0*p202*(-1105.0+(-408.0*p21)+(84.0*p212)+(-34.0*p31)+(-15.0*p312)))+(3.0*p11*((221.0*(55.0+(2.0*p31)))+(-68.0*p30*(-39.0+(18.0*p21)+(4.0*p31)))+(42.0*p202*(-68.0+(27.0*p21)+(4.0*p31)))+(p302*(-374.0+(252.0*p21)+(90.0*p31)))+(6.0*p20*(1547.0+(24.0*p21*(-17.0+(7.0*p30)))+(-34.0*p31)+(6.0*p30*(-51.0+(7.0*p31)))))))+(3.0*p20*((18.0*p212*(-17.0+(21.0*p30)))+(12.0*p21*((17.0*(13.0+p31))+(3.0*p30*(-34.0+(5.0*p31)))))+(17.0*(715.0+(8.0*p312)+(-2.0*p30*(65.0+(8.0*p31)))))))))))+(-3.0*p00*((-153153.0*p21)+(-109395.0*p10*p21)+(41769.0*p102*p21)+(-43758.0*p20*p21)+(35802.0*p10*p20*p21)+(9945.0*p202*p21)+(-43758.0*p212)+(-35802.0*p10*p212)+(14688.0*p102*p212)+(-19890.0*p20*p212)+(16524.0*p10*p20*p212)+(5508.0*p202*p212)+(9945.0*p213)+(8262.0*p10*p213)+(-3402.0*p102*p213)+(5508.0*p20*p213)+(-4536.0*p10*p20*p213)+(-1701.0*p202*p213)+(-7293.0*p21*p30)+(6630.0*p10*p21*p30)+(3978.0*p20*p21*p30)+(-3978.0*p212*p30)+(3672.0*p10*p212*p30)+(2448.0*p20*p212*p30)+(1224.0*p213*p30)+(-1134.0*p10*p213*p30)+(-810.0*p20*p213*p30)+(11.0*p013*(-46410.0+(4095.0*p102)+(234.0*p202)+(-204.0*p30)+(5.0*p302)+(78.0*p10*(-204.0+(21.0*p20)+(2.0*p30)))+(12.0*p20*(-204.0+(5.0*p30)))))+(-9.0*p113*(-3094.0+(594.0*p102)+(-135.0*p202)+(136.0*p30)+(-126.0*p20*p30)+(-28.0*p302)+(-18.0*p10*(102.0+(5.0*p30)))))+(-51051.0*p31)+(-36465.0*p10*p31)+(13923.0*p102*p31)+(-29172.0*p20*p31)+(19890.0*p10*p20*p31)+(9945.0*p202*p31)+(-36465.0*p21*p31)+(-26520.0*p10*p21*p31)+(10098.0*p102*p21*p31)+(-23868.0*p20*p21*p31)+(16524.0*p10*p20*p21*p31)+(8568.0*p202*p21*p31)+(13923.0*p212*p31)+(10098.0*p10*p212*p31)+(-3780.0*p102*p212*p31)+(9792.0*p20*p212*p31)+(-6804.0*p10*p20*p212*p31)+(-3645.0*p202*p212*p31)+(-12155.0*p30*p31)+(6630.0*p10*p30*p31)+(9282.0*p20*p30*p31)+(-9282.0*p21*p30*p31)+(5712.0*p10*p21*p30*p31)+(7344.0*p20*p21*p30*p31)+(3672.0*p212*p30*p31)+(-2430.0*p10*p212*p30*p31)+(-2970.0*p20*p212*p30*p31)+(3094.0*p302*p31)+(1836.0*p21*p302*p31)+(-594.0*p212*p302*p31)+(-12155.0*p312)+(-6630.0*p10*p312)+(2142.0*p102*p312)+(-9282.0*p20*p312)+(4896.0*p10*p20*p312)+(3672.0*p202*p312)+(9282.0*p21*p312)+(5304.0*p10*p21*p312)+(-1701.0*p102*p21*p312)+(7344.0*p20*p21*p312)+(-4050.0*p10*p20*p21*p312)+(-2970.0*p202*p21*p312)+(-6188.0*p30*p312)+(2448.0*p10*p30*p312)+(4896.0*p20*p30*p312)+(4284.0*p21*p30*p312)+(-1980.0*p10*p21*p30*p312)+(-3564.0*p20*p21*p30*p312)+(2244.0*p302*p312)+(-1287.0*p21*p302*p312)+(3094.0*p313)+(1224.0*p10*p313)+(-315.0*p102*p313)+(2448.0*p20*p313)+(-990.0*p10*p20*p313)+(-990.0*p202*p313)+(2244.0*p30*p313)+(-660.0*p10*p30*p313)+(-1716.0*p20*p30*p313)+(-1001.0*p302*p313)+(-9.0*p112*(12155.0+(-4641.0*p21)+(-442.0*p30)+(102.0*p21*p30)+(102.0*p302)+(-63.0*p21*p302)+(-1105.0*p31)+(-34.0*p30*p31)+(-15.0*p302*p31)+(12.0*p202*(34.0+(7.0*p31)))+(27.0*p102*(-68.0+(55.0*p21)+(15.0*p31)))+(-24.0*p20*((34.0*p21)+(-17.0*p30)+(7.0*p21*p30)+(17.0*p31)))+(p10*(6188.0+(54.0*(-68.0+(15.0*p20))*p21)+(272.0*p30)+(-952.0*p31)+(378.0*p20*p31)+(56.0*p30*p31)))))+(p012*(680680.0+(55692.0*p20)+(-7344.0*p202)+(27846.0*p21)+(-3672.0*p20*p21)+(1485.0*p202*p21)+(6188.0*p30)+(-2448.0*p20*p30)+(-1224.0*p21*p30)+(810.0*p20*p21*p30)+(-272.0*p302)+(126.0*p21*p302)+(9.0*p11*(15470.0+(594.0*p202)+(-476.0*p30)+(25.0*p302)+(44.0*p20*(-68.0+(5.0*p30)))))+(3094.0*p31)+(135.0*p202*p31)+(-136.0*p30*p31)+(126.0*p20*p30*p31)+(28.0*p302*p31)+(18.0*p10*(15470.0+(374.0*p21)+(66.0*p20*(-34.0+(3.0*p21)))+(-272.0*p30)+(55.0*p21*p30)+(33.0*p11*(-68.0+(39.0*p20)+(6.0*p30)))+(102.0*p31)+(5.0*p30*p31)))+(297.0*p102*((91.0*p11)+(-2.0*(136.0+p31))))))+(p01*(510510.0+(72930.0*p20)+(-13923.0*p202)+(-72930.0*p21)+(-2448.0*p202*p21)+(13923.0*p212)+(2448.0*p20*p212)+(12155.0*p30)+(-6630.0*p20*p30)+(2652.0*p21*p30)+(-2448.0*p20*p21*p30)+(-306.0*p212*p30)+(504.0*p20*p212*p30)+(-1105.0*p302)+(-612.0*p21*p302)+(189.0*p212*p302)+(27.0*p112*(3094.0+(-408.0*p20)+(165.0*p202)+(-136.0*p30)+(90.0*p20*p30)+(14.0*p302)))+(-12155.0*p31)+(-2652.0*p20*p31)+(306.0*p202*p31)+(6630.0*p21*p31)+(2448.0*p20*p21*p31)+(-504.0*p202*p21*p31)+(-204.0*p20*p30*p31)+(204.0*p21*p30*p31)+(-136.0*p302*p31)+(90.0*p21*p302*p31)+(1105.0*p312)+(612.0*p20*p312)+(-189.0*p202*p312)+(136.0*p30*p312)+(-90.0*p20*p30*p312)+(-27.0*p102*(3094.0+(-408.0*p21)+(165.0*p212)+(-136.0*p31)+(90.0*p21*p31)+(14.0*p312)+(22.0*p11*(34.0+(18.0*p21)+(5.0*p31)))))+(3.0*p11*(-85085.0+(54.0*p202*(-68.0+(15.0*p21)))+(3094.0*p30)+(-306.0*p302)+(12.0*p21*(1547.0+(-68.0*p30)+(14.0*p302)))+(3094.0*p31)+(-68.0*p30*p31)+(42.0*p302*p31)+(4.0*p20*((34.0*(91.0+(4.0*p31)))+(7.0*p30*(-68.0+(27.0*p21)+(4.0*p31)))))))+(3.0*p10*(85085.0+(-12376.0*p21)+(3672.0*p212)+(-3094.0*p30)+(-544.0*p21*p30)+(198.0*p112*(34.0+(18.0*p20)+(5.0*p30)))+(-3094.0*p31)+(1904.0*p21*p31)+(68.0*p30*p31)+(-112.0*p21*p30*p31)+(306.0*p312)+(-42.0*p30*p312)+(-6.0*p20*(3094.0+(135.0*p212)+(-136.0*p31)+(126.0*p21*p31)+(28.0*p312)))+(36.0*p11*((306.0*p21)+(-68.0*p30)+(15.0*p21*p30)+(68.0*p31)+(-3.0*p20*(102.0+(5.0*p31)))))))))+(-3.0*p11*(102102.0+(36465.0*p21)+(-9945.0*p212)+(-2431.0*p30)+(-306.0*p212*p30)+(663.0*p302)+(408.0*p21*p302)+(-135.0*p212*p302)+(9724.0*p31)+(-6630.0*p21*p31)+(884.0*p30*p31)+(-816.0*p21*p30*p31)+(-1547.0*p312)+(-408.0*p30*p312)+(66.0*p302*p312)+(9.0*p202*(221.0+(84.0*p212)+(-136.0*p31)+(45.0*p312)+(6.0*p21*(-17.0+(21.0*p31)))))+(3.0*p102*((1215.0*p212)+(108.0*p21*(-34.0+(7.0*p31)))+(2.0*(-1547.0+(-544.0*p31)+(70.0*p312)))))+(3.0*p10*(12155.0+(42.0*p212*(-68.0+(27.0*p20)+(4.0*p30)))+(2652.0*p31)+(-1224.0*p20*p31)+(-374.0*p312)+(252.0*p20*p312)+(p30*(442.0+(-272.0*p31)+(90.0*p312)))+(6.0*p21*(1547.0+(-34.0*p30)+(-306.0*p31)+(42.0*p30*p31)+(24.0*p20*(-17.0+(7.0*p31)))))))+(p20*((-3672.0*p212)+(68.0*(65.0+(-16.0*p31))*p31)+(p30*(2210.0+(-544.0*p31)+(330.0*p312)))+(36.0*p21*(221.0+(-102.0*p31)+(p30*(17.0+(15.0*p31)))))))))))));
	*accum = ((1.0/9.0)*((-3.0*p01)+(-3.0*p012)+(2.0*p013)+(p31*(3.0+(3.0*p31)+(-2.0*p312)))));
}
static void cube_21(double *pixel, double *accum, Curve<4,2> *curve)
{
	const double &p00 = curve->p[0].v[0];
	const double &p01 = curve->p[0].v[1];
	const double &p10 = curve->p[1].v[0];
	const double &p11 = curve->p[1].v[1];
	const double &p20 = curve->p[2].v[0];
	const double &p21 = curve->p[2].v[1];
	const double &p30 = curve->p[3].v[0];
	const double &p31 = curve->p[3].v[1];
	const double p002 = p00*p00;
	const double p012 = p01*p01;
	const double p102 = p10*p10;
	const double p112 = p11*p11;
	const double p202 = p20*p20;
	const double p212 = p21*p21;
	const double p302 = p30*p30;
	const double p312 = p31*p31;
	const double p003 = p00*p002;
	const double p013 = p01*p012;
	const double p103 = p10*p102;
	const double p113 = p11*p112;
	const double p203 = p20*p202;
	const double p213 = p21*p212;
	const double p303 = p30*p302;
	const double p313 = p31*p312;
	*pixel = ((1.0/24504480.0)*((-918918.0*p11*p20)+(393822.0*p10*p11*p20)+(-53703.0*p102*p11*p20)+(-393822.0*p112*p20)+(214812.0*p10*p112*p20)+(-33048.0*p102*p112*p20)+(107406.0*p113*p20)+(-66096.0*p10*p113*p20)+(10935.0*p102*p113*p20)+(393822.0*p11*p202)+(-89505.0*p10*p11*p202)+(179010.0*p112*p202)+(-49572.0*p10*p112*p202)+(-49572.0*p113*p202)+(15309.0*p10*p113*p202)+(-53703.0*p11*p203)+(-24786.0*p112*p203)+(6804.0*p113*p203)+(918918.0*p10*p21)+(-393822.0*p102*p21)+(53703.0*p103*p21)+(393822.0*p10*p11*p21)+(-214812.0*p102*p11*p21)+(33048.0*p103*p11*p21)+(-107406.0*p10*p112*p21)+(66096.0*p102*p112*p21)+(-10935.0*p103*p112*p21)+(-393822.0*p10*p20*p21)+(89505.0*p102*p20*p21)+(-393822.0*p11*p20*p21)+(24786.0*p102*p11*p20*p21)+(179010.0*p112*p20*p21)+(-49572.0*p10*p112*p20*p21)+(53703.0*p10*p202*p21)+(214812.0*p11*p202*p21)+(-24786.0*p10*p11*p202*p21)+(-99144.0*p112*p202*p21)+(20412.0*p10*p112*p202*p21)+(-33048.0*p11*p203*p21)+(15309.0*p112*p203*p21)+(393822.0*p10*p212)+(-179010.0*p102*p212)+(24786.0*p103*p212)+(-179010.0*p10*p11*p212)+(99144.0*p102*p11*p212)+(-15309.0*p103*p11*p212)+(-214812.0*p10*p20*p212)+(49572.0*p102*p20*p212)+(107406.0*p11*p20*p212)+(49572.0*p10*p11*p20*p212)+(-20412.0*p102*p11*p20*p212)+(33048.0*p10*p202*p212)+(-66096.0*p11*p202*p212)+(10935.0*p11*p203*p212)+(-107406.0*p10*p213)+(49572.0*p102*p213)+(-6804.0*p103*p213)+(66096.0*p10*p20*p213)+(-15309.0*p102*p20*p213)+(-10935.0*p10*p202*p213)+(-918918.0*p11*p30)+(262548.0*p10*p11*p30)+(-29835.0*p102*p11*p30)+(-262548.0*p112*p30)+(119340.0*p10*p112*p30)+(-16524.0*p102*p112*p30)+(59670.0*p113*p30)+(-33048.0*p10*p113*p30)+(5103.0*p102*p113*p30)+(656370.0*p11*p20*p30)+(-107406.0*p10*p11*p20*p30)+(214812.0*p112*p20*p30)+(-49572.0*p10*p112*p20*p30)+(-49572.0*p113*p20*p30)+(13608.0*p10*p113*p20*p30)+(-125307.0*p11*p202*p30)+(-44064.0*p112*p202*p30)+(10206.0*p113*p202*p30)+(-1837836.0*p21*p30)+(17901.0*p102*p21*p30)+(-656370.0*p11*p21*p30)+(143208.0*p10*p11*p21*p30)+(-8262.0*p102*p11*p21*p30)+(179010.0*p112*p21*p30)+(-66096.0*p10*p112*p21*p30)+(6804.0*p102*p112*p21*p30)+(656370.0*p20*p21*p30)+(501228.0*p11*p20*p21*p30)+(-66096.0*p10*p11*p20*p21*p30)+(-154224.0*p112*p20*p21*p30)+(30618.0*p10*p112*p20*p21*p30)+(-83538.0*p202*p21*p30)+(-99144.0*p11*p202*p21*p30)+(32805.0*p112*p202*p21*p30)+(-656370.0*p212*p30)+(11016.0*p102*p212*p30)+(250614.0*p11*p212*p30)+(-44064.0*p10*p11*p212*p30)+(334152.0*p20*p212*p30)+(-198288.0*p11*p20*p212*p30)+(21870.0*p10*p11*p20*p212*p30)+(-49572.0*p202*p212*p30)+(40095.0*p11*p202*p212*p30)+(167076.0*p213*p30)+(-3645.0*p102*p213*p30)+(-99144.0*p20*p213*p30)+(16038.0*p202*p213*p30)+(437580.0*p11*p302)+(-41769.0*p10*p11*p302)+(83538.0*p112*p302)+(-14688.0*p10*p112*p302)+(-14688.0*p113*p302)+(3402.0*p10*p113*p302)+(-139230.0*p11*p20*p302)+(-33048.0*p112*p20*p302)+(6075.0*p113*p20*p302)+(1531530.0*p21*p302)+(-27846.0*p10*p21*p302)+(334152.0*p11*p21*p302)+(-33048.0*p10*p11*p21*p302)+(-66096.0*p112*p21*p302)+(10935.0*p10*p112*p21*p302)+(-250614.0*p20*p21*p302)+(-115668.0*p11*p20*p21*p302)+(26730.0*p112*p20*p21*p302)+(501228.0*p212*p302)+(-16524.0*p10*p212*p302)+(-132192.0*p11*p212*p302)+(13365.0*p10*p11*p212*p302)+(-121176.0*p20*p212*p302)+(48114.0*p11*p20*p212*p302)+(-121176.0*p213*p302)+(5346.0*p10*p213*p302)+(34749.0*p20*p213*p302)+(-83538.0*p11*p303)+(-11016.0*p112*p303)+(1485.0*p113*p303)+(-417690.0*p21*p303)+(-60588.0*p11*p21*p303)+(8910.0*p112*p21*p303)+(-121176.0*p212*p303)+(23166.0*p11*p212*p303)+(27027.0*p213*p303)+(p013*((27027.0*p103)+(1485.0*p203)+(594.0*p102*(-408.0+(39.0*p20)+(5.0*p30)))+(27.0*p202*(-816.0+(35.0*p30)))+(36.0*p20*(4641.0+(-204.0*p30)+(7.0*p302)))+(4.0*p30*(4641.0+(-204.0*p30)+(7.0*p302)))+(9.0*p10*(92820.0+(990.0*p202)+(-1632.0*p30)+(35.0*p302)+(66.0*p20*(-204.0+(5.0*p30)))))))+(918918.0*p10*p31)+(-262548.0*p102*p31)+(29835.0*p103*p31)+(262548.0*p10*p11*p31)+(-119340.0*p102*p11*p31)+(16524.0*p103*p11*p31)+(-59670.0*p10*p112*p31)+(33048.0*p102*p112*p31)+(-5103.0*p103*p112*p31)+(1837836.0*p20*p31)+(-656370.0*p10*p20*p31)+(89505.0*p102*p20*p31)+(-143208.0*p10*p11*p20*p31)+(33048.0*p102*p11*p20*p31)+(35802.0*p112*p20*p31)+(16524.0*p10*p112*p20*p31)+(-6804.0*p102*p112*p20*p31)+(-656370.0*p202*p31)+(125307.0*p10*p202*p31)+(22032.0*p10*p11*p202*p31)+(-22032.0*p112*p202*p31)+(83538.0*p203*p31)+(3645.0*p112*p203*p31)+(656370.0*p10*p21*p31)+(-214812.0*p102*p21*p31)+(24786.0*p103*p21*p31)+(-214812.0*p10*p11*p21*p31)+(99144.0*p102*p11*p21*p31)+(-13608.0*p103*p11*p21*p31)+(656370.0*p20*p21*p31)+(-501228.0*p10*p20*p21*p31)+(77112.0*p102*p20*p21*p31)+(132192.0*p10*p11*p20*p21*p31)+(-30618.0*p102*p11*p20*p21*p31)+(-334152.0*p202*p21*p31)+(99144.0*p10*p202*p21*p31)+(-21870.0*p10*p11*p202*p21*p31)+(49572.0*p203*p21*p31)+(-250614.0*p10*p212*p31)+(88128.0*p102*p212*p31)+(-10206.0*p103*p212*p31)+(-167076.0*p20*p212*p31)+(198288.0*p10*p20*p212*p31)+(-32805.0*p102*p20*p212*p31)+(99144.0*p202*p212*p31)+(-40095.0*p10*p202*p212*p31)+(-16038.0*p203*p212*p31)+(3063060.0*p30*p31)+(-437580.0*p10*p30*p31)+(41769.0*p102*p30*p31)+(-437580.0*p11*p30*p31)+(7344.0*p102*p11*p30*p31)+(83538.0*p112*p30*p31)+(-14688.0*p10*p112*p30*p31)+(-1531530.0*p20*p30*p31)+(167076.0*p10*p20*p30*p31)+(222768.0*p11*p20*p30*p31)+(-66096.0*p112*p20*p30*p31)+(7290.0*p10*p112*p20*p30*p31)+(250614.0*p202*p30*p31)+(-33048.0*p11*p202*p30*p31)+(13365.0*p112*p202*p30*p31)+(-1531530.0*p21*p30*p31)+(-222768.0*p10*p21*p30*p31)+(33048.0*p102*p21*p30*p31)+(334152.0*p11*p21*p30*p31)+(-7290.0*p102*p11*p21*p30*p31)+(99144.0*p10*p20*p21*p30*p31)+(-198288.0*p11*p20*p21*p30*p31)+(60588.0*p202*p21*p30*p31)+(32076.0*p11*p202*p21*p30*p31)+(501228.0*p212*p30*p31)+(66096.0*p10*p212*p30*p31)+(-13365.0*p102*p212*p30*p31)+(-121176.0*p20*p212*p30*p31)+(-32076.0*p10*p20*p212*p30*p31)+(-2042040.0*p302*p31)+(83538.0*p10*p302*p31)+(334152.0*p11*p302*p31)+(-11016.0*p10*p11*p302*p31)+(-44064.0*p112*p302*p31)+(4455.0*p10*p112*p302*p31)+(417690.0*p20*p302*p31)+(-80784.0*p11*p20*p302*p31)+(16038.0*p112*p20*p302*p31)+(1670760.0*p21*p302*p31)+(20196.0*p10*p21*p302*p31)+(-242352.0*p11*p21*p302*p31)+(10692.0*p10*p11*p21*p302*p31)+(-121176.0*p20*p21*p302*p31)+(69498.0*p11*p20*p21*p302*p31)+(-484704.0*p212*p302*p31)+(81081.0*p20*p212*p302*p31)+(510510.0*p303*p31)+(-80784.0*p11*p303*p31)+(7722.0*p112*p303*p31)+(-525096.0*p21*p303*p31)+(54054.0*p11*p21*p303*p31)+(135135.0*p212*p303*p31)+(437580.0*p10*p312)+(-83538.0*p102*p312)+(7344.0*p103*p312)+(-83538.0*p10*p11*p312)+(29376.0*p102*p11*p312)+(-3402.0*p103*p11*p312)+(1531530.0*p20*p312)+(-334152.0*p10*p20*p312)+(33048.0*p102*p20*p312)+(-55692.0*p11*p20*p312)+(66096.0*p10*p11*p20*p312)+(-10935.0*p102*p11*p20*p312)+(-501228.0*p202*p312)+(66096.0*p10*p202*p312)+(33048.0*p11*p202*p312)+(-13365.0*p10*p11*p202*p312)+(60588.0*p203*p312)+(-5346.0*p11*p203*p312)+(-278460.0*p10*p21*p312)+(66096.0*p102*p21*p312)+(-6075.0*p103*p21*p312)+(-501228.0*p20*p21*p312)+(231336.0*p10*p20*p21*p312)+(-26730.0*p102*p20*p21*p312)+(242352.0*p202*p21*p312)+(-48114.0*p10*p202*p21*p312)+(-34749.0*p203*p21*p312)+(4084080.0*p30*p312)+(-334152.0*p10*p30*p312)+(22032.0*p102*p30*p312)+(167076.0*p11*p30*p312)+(22032.0*p10*p11*p30*p312)+(-4455.0*p102*p11*p30*p312)+(-1670760.0*p20*p30*p312)+(121176.0*p10*p20*p30*p312)+(-40392.0*p11*p20*p30*p312)+(-10692.0*p10*p11*p20*p30*p312)+(242352.0*p202*p30*p312)+(835380.0*p21*p30*p312)+(161568.0*p10*p21*p30*p312)+(-16038.0*p102*p21*p30*p312)+(242352.0*p20*p21*p30*p312)+(-69498.0*p10*p20*p21*p30*p312)+(-81081.0*p202*p21*p30*p312)+(-3063060.0*p302*p312)+(80784.0*p10*p302*p312)+(-161568.0*p11*p302*p312)+(525096.0*p20*p302*p312)+(27027.0*p11*p20*p302*p312)+(-1050192.0*p21*p302*p312)+(-27027.0*p10*p21*p302*p312)+(816816.0*p303*p312)+(45045.0*p11*p303*p312)+(360360.0*p21*p303*p312)+(-167076.0*p10*p313)+(22032.0*p102*p313)+(-1485.0*p103*p313)+(-835380.0*p20*p313)+(121176.0*p10*p20*p313)+(-8910.0*p102*p20*p313)+(242352.0*p202*p313)+(-23166.0*p10*p202*p313)+(-27027.0*p203*p313)+(-3063060.0*p30*p313)+(161568.0*p10*p30*p313)+(-7722.0*p102*p30*p313)+(1050192.0*p20*p30*p313)+(-54054.0*p10*p20*p30*p313)+(-135135.0*p202*p30*p313)+(2450448.0*p302*p313)+(-45045.0*p10*p302*p313)+(-360360.0*p20*p302*p313)+(-680680.0*p303*p313)+(p003*((680680.0*p013)+(-27027.0*p113)+(83538.0*p21)+(11016.0*p212)+(-1485.0*p213)+(9282.0*p31)+(3672.0*p21*p31)+(-945.0*p212*p31)+(408.0*p312)+(-252.0*p21*p312)+(-28.0*p313)+(-3003.0*p012*(272.0+(120.0*p11)+(15.0*p21)+p31))+(-594.0*p112*(-204.0+(39.0*p21)+(5.0*p31)))+(-33.0*p01*(15470.0+(4095.0*p112)+(-2448.0*p21)+(234.0*p212)+(-204.0*p31)+(60.0*p21*p31)+(5.0*p312)+(78.0*p11*(-204.0+(21.0*p21)+(2.0*p31)))))+(-9.0*p11*(-46410.0+(990.0*p212)+(-816.0*p31)+(35.0*p312)+(66.0*p21*(-102.0+(5.0*p31)))))))+(3.0*p002*((-297.0*p113*(-136.0+(39.0*p10)+(6.0*p20)))+(-145860.0*p21)+(46410.0*p10*p21)+(13923.0*p20*p21)+(-27846.0*p212)+(11016.0*p10*p212)+(4896.0*p20*p212)+(4896.0*p213)+(-2025.0*p10*p213)+(-1134.0*p20*p213)+(1989.0*p21*p30)+(918.0*p212*p30)+(-252.0*p213*p30)+(1001.0*p013*(-816.0+(120.0*p10)+(15.0*p20)+p30))+(-24310.0*p31)+(9282.0*p10*p31)+(4641.0*p20*p31)+(-13260.0*p21*p31)+(5304.0*p10*p21*p31)+(3366.0*p20*p21*p31)+(4284.0*p212*p31)+(-1701.0*p10*p212*p31)+(-1260.0*p20*p212*p31)+(1105.0*p30*p31)+(918.0*p21*p30*p31)+(-378.0*p212*p30*p31)+(-2210.0*p312)+(816.0*p10*p312)+(714.0*p20*p312)+(1632.0*p21*p312)+(-588.0*p10*p21*p312)+(-567.0*p20*p21*p312)+(272.0*p30*p312)+(-225.0*p21*p30*p312)+(272.0*p313)+(-84.0*p10*p313)+(-105.0*p20*p313)+(-55.0*p30*p313)+(-33.0*p012*(-30940.0+(816.0*p20)+(-1632.0*p21)+(68.0*p30)+(-6.0*p21*p30)+(-39.0*p11*(272.0+(7.0*p20)+p30))+(-136.0*p31)+(6.0*p20*p31)+(39.0*p10*(136.0+(7.0*p21)+p31))))+(-27.0*p112*(6188.0+(-1632.0*p21)+(15.0*p21*p30)+(-272.0*p31)+(7.0*p30*p31)+(22.0*p10*(-68.0+(27.0*p21)+(5.0*p31)))+(3.0*p20*(-68.0+(55.0*p21)+(15.0*p31)))))+(-1.0*p01*(-680680.0+(27846.0*p20)+(111384.0*p21)+(-3672.0*p20*p21)+(-14688.0*p212)+(1485.0*p20*p212)+(3094.0*p30)+(135.0*p212*p30)+(-594.0*p112*(272.0+p30))+(12376.0*p31)+(-1224.0*p20*p31)+(-4896.0*p21*p31)+(810.0*p20*p21*p31)+(-136.0*p30*p31)+(126.0*p21*p30*p31)+(-544.0*p312)+(126.0*p20*p312)+(28.0*p30*p312)+(18.0*p11*(30940.0+(-4488.0*p21)+(102.0*p30)+(-544.0*p31)+(5.0*p30*p31)+(11.0*p20*(34.0+(18.0*p21)+(5.0*p31)))))+(9.0*p10*(15470.0+(3003.0*p112)+(594.0*p212)+(-476.0*p31)+(25.0*p312)+(44.0*p21*(-68.0+(5.0*p31)))+(66.0*p11*(-68.0+(39.0*p21)+(6.0*p31)))))))+(-3.0*p11*(170170.0+(37128.0*p21)+(-7344.0*p212)+(-408.0*p21*p30)+(189.0*p212*p30)+(6188.0*p31)+(-3264.0*p21*p31)+(-204.0*p30*p31)+(168.0*p21*p30*p31)+(-476.0*p312)+(42.0*p30*p312)+(p20*(-3094.0+(-3672.0*p21)+(1215.0*p212)+(-1088.0*p31)+(756.0*p21*p31)+(140.0*p312)))+(9.0*p10*(-3094.0+(330.0*p212)+(-272.0*p31)+(21.0*p312)+(6.0*p21*(-238.0+(25.0*p31)))))))))+(3.0*p012*((297.0*p103*(-68.0+(39.0*p11)+(6.0*p21)))+(9.0*p203*(-272.0+(225.0*p11)+(126.0*p21)+(28.0*p31)))+(p30*(-24310.0+(2210.0*p30)+(-136.0*p302)+(21.0*p21*(442.0+(-68.0*p30)+(5.0*p302)))+(12.0*p11*(1547.0+(-136.0*p30)+(7.0*p302)))+(2210.0*p31)+(-544.0*p30*p31)+(55.0*p302*p31)))+(3.0*p20*(-48620.0+(4420.0*p30)+(-272.0*p302)+(4.0*p11*(7735.0+(-884.0*p30)+(49.0*p302)))+(3.0*p21*(3094.0+(-748.0*p30)+(63.0*p302)))+(1326.0*p31)+(-612.0*p30*p31)+(75.0*p302*p31)))+(27.0*p102*(6188.0+(-408.0*p21)+(-136.0*p30)+(45.0*p21*p30)+(22.0*p11*(-136.0+(27.0*p20)+(5.0*p30)))+(7.0*p30*p31)+(3.0*p20*(-272.0+(55.0*p21)+(5.0*p31)))))+(9.0*p202*((9.0*p11*(-272.0+(21.0*p30)))+(2.0*(1547.0+(-119.0*p30)+(p21*(-544.0+(70.0*p30)))+(-102.0*p31)+(21.0*p30*p31)))))+(3.0*p10*((9.0*p11*(6188.0+(330.0*p202)+(-544.0*p30)+(21.0*p302)+(6.0*p20*(-476.0+(25.0*p30)))))+(27.0*p202*(-136.0+(45.0*p21)+(7.0*p31)))+(2.0*(-85085.0+(2.0*p21*(1547.0+(-544.0*p30)+(35.0*p302)))+(7.0*p302*(-17.0+(3.0*p31)))+(-34.0*p30*(-91.0+(6.0*p31)))))+(12.0*p20*((9.0*p21*(-68.0+(7.0*p30)))+(2.0*(1547.0+(-34.0*p31)+(p30*(-68.0+(7.0*p31)))))))))))+(3.0*p01*((9.0*p103*(-3094.0+(594.0*p112)+(-135.0*p212)+(136.0*p31)+(-126.0*p21*p31)+(-28.0*p312)+(-18.0*p11*(102.0+(5.0*p31)))))+(9.0*p203*((378.0*p112)+(189.0*p212)+(18.0*p21*(-34.0+(5.0*p31)))+(18.0*p11*(-51.0+(28.0*p21)+(7.0*p31)))+(-17.0*(65.0+(8.0*p31)))))+(9.0*p202*(9724.0+(-1547.0*p30)+(12.0*p112*(-272.0+(35.0*p30)))+(9.0*p212*(-136.0+(45.0*p30)))+(884.0*p31)+(-408.0*p30*p31)+(66.0*p30*p312)+(6.0*p11*(1326.0+(-187.0*p30)+(18.0*p21*(-34.0+(7.0*p30)))+(-136.0*p31)+(45.0*p30*p31)))+(2.0*p21*(2210.0+(-544.0*p30)+(-272.0*p31)+(165.0*p30*p31)))))+(9.0*p102*(24310.0+(816.0*p212)+(-1105.0*p30)+(-408.0*p21*p30)+(84.0*p212*p30)+(27.0*p112*(-136.0+(55.0*p20)+(15.0*p30)))+(-884.0*p31)+(816.0*p21*p31)+(-34.0*p30*p31)+(204.0*p312)+(-15.0*p30*p312)+(2.0*p11*((27.0*p20*(-68.0+(15.0*p21)))+(68.0*(91.0+(4.0*p31)))+(7.0*p30*(-68.0+(27.0*p21)+(4.0*p31)))))+(-3.0*p20*(1547.0+(-34.0*p31)+(21.0*p312)+(8.0*p21*(34.0+(7.0*p31)))))))+(p30*(-102102.0+(24310.0*p30)+(-3094.0*p302)+(63.0*p112*(442.0+(-68.0*p30)+(5.0*p302)))+(18.0*p212*(1105.0+(-408.0*p30)+(55.0*p302)))+(-24310.0*p31)+(12376.0*p30*p31)+(-2244.0*p302*p31)+(6188.0*p312)+(-4488.0*p30*p312)+(1001.0*p302*p312)+(6.0*p11*((3.0*p21*(2210.0+(-544.0*p30)+(55.0*p302)))+(1105.0*(-11.0+(2.0*p31)))+(-34.0*p30*(-65.0+(24.0*p31)))+(2.0*p302*(-102.0+(55.0*p31)))))+(12.0*p21*((221.0*(-22.0+(7.0*p31)))+(-17.0*p30*(-91.0+(48.0*p31)))+(p302*(-204.0+(143.0*p31)))))))+(3.0*p20*(-102102.0+(24310.0*p30)+(-3094.0*p302)+(9.0*p112*(3094.0+(-748.0*p30)+(63.0*p302)))+(6.0*p212*(1105.0+(-952.0*p30)+(165.0*p302)))+(-4862.0*p31)+(6188.0*p30*p31)+(-1428.0*p302*p31)+(-1224.0*p30*p312)+(429.0*p302*p312)+(12.0*p21*((221.0*(-11.0+p31))+(-102.0*p30*(-13.0+(4.0*p31)))+(3.0*p302*(-68.0+(33.0*p31)))))+(2.0*p11*((27.0*p21*(442.0+(-204.0*p30)+(25.0*p302)))+(1105.0*(-33.0+(2.0*p31)))+(-136.0*p30*(-65.0+(14.0*p31)))+(p302*(-884.0+(330.0*p31)))))))+(3.0*p10*(-204204.0+(-3978.0*p212)+(19448.0*p30)+(8840.0*p21*p30)+(-2448.0*p212*p30)+(-1547.0*p302)+(-1088.0*p21*p302)+(405.0*p212*p302)+(3.0*p112*((1215.0*p202)+(108.0*p20*(-68.0+(7.0*p30)))+(4.0*(1547.0+(-544.0*p30)+(35.0*p302)))))+(4862.0*p31)+(-4420.0*p21*p31)+(1768.0*p30*p31)+(-1088.0*p21*p30*p31)+(-408.0*p302*p31)+(330.0*p21*p302*p31)+(-1326.0*p312)+(66.0*p302*p312)+(9.0*p202*(-1105.0+(-408.0*p21)+(84.0*p212)+(-34.0*p31)+(-15.0*p312)))+(6.0*p11*((-221.0*(55.0+(2.0*p31)))+(-68.0*p30*(-39.0+(18.0*p21)+(4.0*p31)))+(21.0*p202*(-68.0+(27.0*p21)+(4.0*p31)))+(p302*(-187.0+(126.0*p21)+(45.0*p31)))+(6.0*p20*(1547.0+(12.0*p21*(-34.0+(7.0*p30)))+(-34.0*p31)+(3.0*p30*(-51.0+(7.0*p31)))))))+(6.0*p20*((9.0*p212*(-34.0+(21.0*p30)))+(6.0*p21*((34.0*(13.0+p31))+(3.0*p30*(-34.0+(5.0*p31)))))+(17.0*(715.0+(8.0*p312)+(-1.0*p30*(65.0+(8.0*p31)))))))))))+(3.0*p00*((306306.0*p21)+(-218790.0*p10*p21)+(41769.0*p102*p21)+(-87516.0*p20*p21)+(35802.0*p10*p20*p21)+(9945.0*p202*p21)+(87516.0*p212)+(-71604.0*p10*p212)+(14688.0*p102*p212)+(-39780.0*p20*p212)+(16524.0*p10*p20*p212)+(5508.0*p202*p212)+(-19890.0*p213)+(16524.0*p10*p213)+(-3402.0*p102*p213)+(11016.0*p20*p213)+(-4536.0*p10*p20*p213)+(-1701.0*p202*p213)+(-14586.0*p21*p30)+(6630.0*p10*p21*p30)+(3978.0*p20*p21*p30)+(-7956.0*p212*p30)+(3672.0*p10*p212*p30)+(2448.0*p20*p212*p30)+(2448.0*p213*p30)+(-1134.0*p10*p213*p30)+(-810.0*p20*p213*p30)+(11.0*p013*(92820.0+(4095.0*p102)+(234.0*p202)+(-408.0*p30)+(5.0*p302)+(78.0*p10*(-408.0+(21.0*p20)+(2.0*p30)))+(12.0*p20*(-408.0+(5.0*p30)))))+(-9.0*p113*(6188.0+(594.0*p102)+(-135.0*p202)+(272.0*p30)+(-126.0*p20*p30)+(-28.0*p302)+(-18.0*p10*(204.0+(5.0*p30)))))+(102102.0*p31)+(-72930.0*p10*p31)+(13923.0*p102*p31)+(-58344.0*p20*p31)+(19890.0*p10*p20*p31)+(9945.0*p202*p31)+(72930.0*p21*p31)+(-53040.0*p10*p21*p31)+(10098.0*p102*p21*p31)+(-47736.0*p20*p21*p31)+(16524.0*p10*p20*p21*p31)+(8568.0*p202*p21*p31)+(-27846.0*p212*p31)+(20196.0*p10*p212*p31)+(-3780.0*p102*p212*p31)+(19584.0*p20*p212*p31)+(-6804.0*p10*p20*p212*p31)+(-3645.0*p202*p212*p31)+(-24310.0*p30*p31)+(6630.0*p10*p30*p31)+(9282.0*p20*p30*p31)+(-18564.0*p21*p30*p31)+(5712.0*p10*p21*p30*p31)+(7344.0*p20*p21*p30*p31)+(7344.0*p212*p30*p31)+(-2430.0*p10*p212*p30*p31)+(-2970.0*p20*p212*p30*p31)+(3094.0*p302*p31)+(1836.0*p21*p302*p31)+(-594.0*p212*p302*p31)+(24310.0*p312)+(-13260.0*p10*p312)+(2142.0*p102*p312)+(-18564.0*p20*p312)+(4896.0*p10*p20*p312)+(3672.0*p202*p312)+(-18564.0*p21*p312)+(10608.0*p10*p21*p312)+(-1701.0*p102*p21*p312)+(14688.0*p20*p21*p312)+(-4050.0*p10*p20*p21*p312)+(-2970.0*p202*p21*p312)+(-12376.0*p30*p312)+(2448.0*p10*p30*p312)+(4896.0*p20*p30*p312)+(8568.0*p21*p30*p312)+(-1980.0*p10*p21*p30*p312)+(-3564.0*p20*p21*p30*p312)+(2244.0*p302*p312)+(-1287.0*p21*p302*p312)+(-6188.0*p313)+(2448.0*p10*p313)+(-315.0*p102*p313)+(4896.0*p20*p313)+(-990.0*p10*p20*p313)+(-990.0*p202*p313)+(4488.0*p30*p313)+(-660.0*p10*p30*p313)+(-1716.0*p20*p30*p313)+(-1001.0*p302*p313)+(-9.0*p112*(-24310.0+(9282.0*p21)+(-884.0*p30)+(204.0*p21*p30)+(102.0*p302)+(-63.0*p21*p302)+(2210.0*p31)+(-68.0*p30*p31)+(-15.0*p302*p31)+(12.0*p202*(34.0+(7.0*p31)))+(27.0*p102*(-68.0+(55.0*p21)+(15.0*p31)))+(-24.0*p20*((68.0*p21)+(-17.0*p30)+(7.0*p21*p30)+(34.0*p31)))+(2.0*p10*(6188.0+(27.0*(-136.0+(15.0*p20))*p21)+(136.0*p30)+(-952.0*p31)+(189.0*p20*p31)+(28.0*p30*p31)))))+(p012*(-1361360.0+(111384.0*p20)+(-7344.0*p202)+(-55692.0*p21)+(-7344.0*p20*p21)+(1485.0*p202*p21)+(12376.0*p30)+(-2448.0*p20*p30)+(-2448.0*p21*p30)+(810.0*p20*p21*p30)+(-272.0*p302)+(126.0*p21*p302)+(9.0*p11*(-30940.0+(594.0*p202)+(-952.0*p30)+(25.0*p302)+(44.0*p20*(-136.0+(5.0*p30)))))+(-6188.0*p31)+(135.0*p202*p31)+(-272.0*p30*p31)+(126.0*p20*p30*p31)+(28.0*p302*p31)+(18.0*p10*(30940.0+(748.0*p21)+(66.0*p20*(-34.0+(3.0*p21)))+(-272.0*p30)+(55.0*p21*p30)+(33.0*p11*(-136.0+(39.0*p20)+(6.0*p30)))+(204.0*p31)+(5.0*p30*p31)))+(297.0*p102*((91.0*p11)+(-2.0*(136.0+p31))))))+(-1.0*p01*(1021020.0+(-145860.0*p20)+(13923.0*p202)+(-145860.0*p21)+(2448.0*p202*p21)+(27846.0*p212)+(-4896.0*p20*p212)+(-24310.0*p30)+(6630.0*p20*p30)+(-5304.0*p21*p30)+(2448.0*p20*p21*p30)+(612.0*p212*p30)+(-504.0*p20*p212*p30)+(1105.0*p302)+(612.0*p21*p302)+(-189.0*p212*p302)+(-27.0*p112*(-6188.0+(165.0*p202)+(-272.0*p30)+(14.0*p302)+(p20*(-816.0+(90.0*p30)))))+(-24310.0*p31)+(5304.0*p20*p31)+(-306.0*p202*p31)+(13260.0*p21*p31)+(-4896.0*p20*p21*p31)+(504.0*p202*p21*p31)+(204.0*p20*p30*p31)+(-408.0*p21*p30*p31)+(136.0*p302*p31)+(-90.0*p21*p302*p31)+(2210.0*p312)+(-1224.0*p20*p312)+(189.0*p202*p312)+(-272.0*p30*p312)+(90.0*p20*p30*p312)+(27.0*p102*(3094.0+(-408.0*p21)+(165.0*p212)+(-136.0*p31)+(90.0*p21*p31)+(14.0*p312)+(22.0*p11*(34.0+(18.0*p21)+(5.0*p31)))))+(-6.0*p11*(85085.0+(27.0*p202*(-68.0+(15.0*p21)))+(3094.0*p30)+(-153.0*p302)+(12.0*p21*(-1547.0+(-68.0*p30)+(7.0*p302)))+(-3094.0*p31)+(-68.0*p30*p31)+(21.0*p302*p31)+(2.0*p20*((68.0*(91.0+(4.0*p31)))+(7.0*p30*(-68.0+(27.0*p21)+(4.0*p31)))))))+(-6.0*p10*(85085.0+(-12376.0*p21)+(3672.0*p212)+(-1547.0*p30)+(-272.0*p21*p30)+(99.0*p112*(68.0+(18.0*p20)+(5.0*p30)))+(-3094.0*p31)+(1904.0*p21*p31)+(34.0*p30*p31)+(-56.0*p21*p30*p31)+(306.0*p312)+(-21.0*p30*p312)+(-3.0*p20*(3094.0+(135.0*p212)+(-136.0*p31)+(126.0*p21*p31)+(28.0*p312)))+(18.0*p11*((612.0*p21)+(-68.0*p30)+(15.0*p21*p30)+(136.0*p31)+(-3.0*p20*(102.0+(5.0*p31)))))))))+(-3.0*p11*(-204204.0+(-72930.0*p21)+(19890.0*p212)+(-4862.0*p30)+(-612.0*p212*p30)+(663.0*p302)+(408.0*p21*p302)+(-135.0*p212*p302)+(-19448.0*p31)+(13260.0*p21*p31)+(1768.0*p30*p31)+(-1632.0*p21*p30*p31)+(3094.0*p312)+(-816.0*p30*p312)+(66.0*p302*p312)+(9.0*p202*(221.0+(84.0*p212)+(-136.0*p31)+(45.0*p312)+(6.0*p21*(-17.0+(21.0*p31)))))+(3.0*p102*((1215.0*p212)+(108.0*p21*(-34.0+(7.0*p31)))+(2.0*(-1547.0+(-544.0*p31)+(70.0*p312)))))+(6.0*p10*(12155.0+(21.0*p212*((27.0*p20)+(4.0*(-34.0+p30))))+(2652.0*p31)+(-612.0*p20*p31)+(-374.0*p312)+(126.0*p20*p312)+(p30*(221.0+(-136.0*p31)+(45.0*p312)))+(6.0*p21*(1547.0+(-17.0*p30)+(-306.0*p31)+(21.0*p30*p31)+(12.0*p20*(-17.0+(7.0*p31)))))))+(p20*((-7344.0*p212)+(136.0*(65.0+(-16.0*p31))*p31)+(p30*(2210.0+(-544.0*p31)+(330.0*p312)))+(36.0*p21*(442.0+(-204.0*p31)+(p30*(17.0+(15.0*p31)))))))))))));
	*accum = ((1.0/36.0)*((-3.0*p01)+(-3.0*p012)+(2.0*p013)+(p31*(3.0+(3.0*p31)+(-2.0*p312)))));
}
static void cube_02(double *pixel, double *accum, Curve<4,2> *curve)
{
	const double &p00 = curve->p[0].v[0];
	const double &p01 = curve->p[0].v[1];
	const double &p10 = curve->p[1].v[0];
	const double &p11 = curve->p[1].v[1];
	const double &p20 = curve->p[2].v[0];
	const double &p21 = curve->p[2].v[1];
	const double &p30 = curve->p[3].v[0];
	const double &p31 = curve->p[3].v[1];
	const double p002 = p00*p00;
	const double p012 = p01*p01;
	const double p102 = p10*p10;
	const double p112 = p11*p11;
	const double p202 = p20*p20;
	const double p212 = p21*p21;
	const double p302 = p30*p30;
	const double p312 = p31*p31;
	const double p003 = p00*p002;
	const double p013 = p01*p012;
	const double p103 = p10*p102;
	const double p113 = p11*p112;
	const double p203 = p20*p202;
	const double p213 = p21*p212;
	const double p303 = p30*p302;
	const double p313 = p31*p312;
	*pixel = ((1.0/49008960.0)*((-107406.0*p102*p11*p20)+(66096.0*p102*p112*p20)+(-10935.0*p102*p113*p20)+(-179010.0*p10*p11*p202)+(99144.0*p10*p112*p202)+(-15309.0*p10*p113*p202)+(-107406.0*p11*p203)+(49572.0*p112*p203)+(-6804.0*p113*p203)+(107406.0*p103*p21)+(-66096.0*p103*p11*p21)+(10935.0*p103*p112*p21)+(179010.0*p102*p20*p21)+(-49572.0*p102*p11*p20*p21)+(107406.0*p10*p202*p21)+(49572.0*p10*p11*p202*p21)+(-20412.0*p10*p112*p202*p21)+(66096.0*p11*p203*p21)+(-15309.0*p112*p203*p21)+(-49572.0*p103*p212)+(15309.0*p103*p11*p212)+(-99144.0*p102*p20*p212)+(20412.0*p102*p11*p20*p212)+(-66096.0*p10*p202*p212)+(-10935.0*p11*p203*p212)+(6804.0*p103*p213)+(15309.0*p102*p20*p213)+(10935.0*p10*p202*p213)+(-59670.0*p102*p11*p30)+(33048.0*p102*p112*p30)+(-5103.0*p102*p113*p30)+(-214812.0*p10*p11*p20*p30)+(99144.0*p10*p112*p20*p30)+(-13608.0*p10*p113*p20*p30)+(-250614.0*p11*p202*p30)+(88128.0*p112*p202*p30)+(-10206.0*p113*p202*p30)+(35802.0*p102*p21*p30)+(16524.0*p102*p11*p21*p30)+(-6804.0*p102*p112*p21*p30)+(132192.0*p10*p11*p20*p21*p30)+(-30618.0*p10*p112*p20*p21*p30)+(-167076.0*p202*p21*p30)+(198288.0*p11*p202*p21*p30)+(-32805.0*p112*p202*p21*p30)+(-22032.0*p102*p212*p30)+(-21870.0*p10*p11*p20*p212*p30)+(99144.0*p202*p212*p30)+(-40095.0*p11*p202*p212*p30)+(3645.0*p102*p213*p30)+(-16038.0*p202*p213*p30)+(-83538.0*p10*p11*p302)+(29376.0*p10*p112*p302)+(-3402.0*p10*p113*p302)+(-278460.0*p11*p20*p302)+(66096.0*p112*p20*p302)+(-6075.0*p113*p20*p302)+(-55692.0*p10*p21*p302)+(66096.0*p10*p11*p21*p302)+(-10935.0*p10*p112*p21*p302)+(-501228.0*p20*p21*p302)+(231336.0*p11*p20*p21*p302)+(-26730.0*p112*p20*p21*p302)+(33048.0*p10*p212*p302)+(-13365.0*p10*p11*p212*p302)+(242352.0*p20*p212*p302)+(-48114.0*p11*p20*p212*p302)+(-5346.0*p10*p213*p302)+(-34749.0*p20*p213*p302)+(-167076.0*p11*p303)+(22032.0*p112*p303)+(-1485.0*p113*p303)+(-835380.0*p21*p303)+(121176.0*p11*p21*p303)+(-8910.0*p112*p21*p303)+(242352.0*p212*p303)+(-23166.0*p11*p212*p303)+(-27027.0*p213*p303)+(-1.0*p013*((27027.0*p103)+(1485.0*p203)+(945.0*p202*p30)+(252.0*p20*p302)+(28.0*p303)+(594.0*p102*((39.0*p20)+(5.0*p30)))+(45.0*p10*((198.0*p202)+(66.0*p20*p30)+(7.0*p302)))))+(59670.0*p103*p31)+(-33048.0*p103*p11*p31)+(5103.0*p103*p112*p31)+(179010.0*p102*p20*p31)+(-66096.0*p102*p11*p20*p31)+(6804.0*p102*p112*p20*p31)+(250614.0*p10*p202*p31)+(-44064.0*p10*p11*p202*p31)+(167076.0*p203*p31)+(-3645.0*p112*p203*p31)+(-49572.0*p103*p21*p31)+(13608.0*p103*p11*p21*p31)+(-154224.0*p102*p20*p21*p31)+(30618.0*p102*p11*p20*p21*p31)+(-198288.0*p10*p202*p21*p31)+(21870.0*p10*p11*p202*p21*p31)+(-99144.0*p203*p21*p31)+(10206.0*p103*p212*p31)+(32805.0*p102*p20*p212*p31)+(40095.0*p10*p202*p212*p31)+(16038.0*p203*p212*p31)+(83538.0*p102*p30*p31)+(-14688.0*p102*p11*p30*p31)+(334152.0*p10*p20*p30*p31)+(-7290.0*p10*p112*p20*p30*p31)+(501228.0*p202*p30*p31)+(66096.0*p11*p202*p30*p31)+(-13365.0*p112*p202*p30*p31)+(-66096.0*p102*p21*p30*p31)+(7290.0*p102*p11*p21*p30*p31)+(-198288.0*p10*p20*p21*p30*p31)+(-121176.0*p202*p21*p30*p31)+(-32076.0*p11*p202*p21*p30*p31)+(13365.0*p102*p212*p30*p31)+(32076.0*p10*p20*p212*p30*p31)+(167076.0*p10*p302*p31)+(22032.0*p10*p11*p302*p31)+(-4455.0*p10*p112*p302*p31)+(835380.0*p20*p302*p31)+(161568.0*p11*p20*p302*p31)+(-16038.0*p112*p20*p302*p31)+(-40392.0*p10*p21*p302*p31)+(-10692.0*p10*p11*p21*p302*p31)+(242352.0*p20*p21*p302*p31)+(-69498.0*p11*p20*p21*p302*p31)+(-81081.0*p20*p212*p302*p31)+(1021020.0*p303*p31)+(161568.0*p11*p303*p31)+(-7722.0*p112*p303*p31)+(1050192.0*p21*p303*p31)+(-54054.0*p11*p21*p303*p31)+(-135135.0*p212*p303*p31)+(-14688.0*p103*p312)+(3402.0*p103*p11*p312)+(-66096.0*p102*p20*p312)+(10935.0*p102*p11*p20*p312)+(-132192.0*p10*p202*p312)+(13365.0*p10*p11*p202*p312)+(-121176.0*p203*p312)+(5346.0*p11*p203*p312)+(6075.0*p103*p21*p312)+(26730.0*p102*p20*p21*p312)+(48114.0*p10*p202*p21*p312)+(34749.0*p203*p21*p312)+(-44064.0*p102*p30*p312)+(4455.0*p102*p11*p30*p312)+(-242352.0*p10*p20*p30*p312)+(10692.0*p10*p11*p20*p30*p312)+(-484704.0*p202*p30*p312)+(16038.0*p102*p21*p30*p312)+(69498.0*p10*p20*p21*p30*p312)+(81081.0*p202*p21*p30*p312)+(-161568.0*p10*p302*p312)+(-1050192.0*p20*p302*p312)+(-27027.0*p11*p20*p302*p312)+(27027.0*p10*p21*p302*p312)+(-1633632.0*p303*p312)+(-45045.0*p11*p303*p312)+(-360360.0*p21*p303*p312)+(1485.0*p103*p313)+(8910.0*p102*p20*p313)+(23166.0*p10*p202*p313)+(27027.0*p203*p313)+(7722.0*p102*p30*p313)+(54054.0*p10*p20*p30*p313)+(135135.0*p202*p30*p313)+(45045.0*p10*p302*p313)+(360360.0*p20*p302*p313)+(680680.0*p303*p313)+(p003*((-680680.0*p013)+(27027.0*p113)+(167076.0*p21)+(-22032.0*p212)+(1485.0*p213)+(18564.0*p31)+(-7344.0*p21*p31)+(945.0*p212*p31)+(-816.0*p312)+(252.0*p21*p312)+(28.0*p313)+(3003.0*p012*(544.0+(120.0*p11)+(15.0*p21)+p31))+(594.0*p112*(-408.0+(39.0*p21)+(5.0*p31)))+(33.0*p01*(-30940.0+(4095.0*p112)+(-4896.0*p21)+(234.0*p212)+(-408.0*p31)+(60.0*p21*p31)+(5.0*p312)+(78.0*p11*(-408.0+(21.0*p21)+(2.0*p31)))))+(9.0*p11*(92820.0+(990.0*p212)+(-1632.0*p31)+(35.0*p312)+(66.0*p21*(-204.0+(5.0*p31)))))))+(-3.0*p012*((297.0*p103*(-136.0+(39.0*p11)+(6.0*p21)))+(63.0*p202*p30*(-68.0+(27.0*p11)+(20.0*p21)+(6.0*p31)))+(9.0*p203*(-544.0+(225.0*p11)+(126.0*p21)+(28.0*p31)))+(p303*(-272.0+(84.0*p11)+(105.0*p21)+(55.0*p31)))+(3.0*p20*p302*(-544.0+(196.0*p11)+(189.0*p21)+(75.0*p31)))+(27.0*p102*((3.0*p20*(-544.0+(198.0*p11)+(55.0*p21)+(5.0*p31)))+(p30*(-272.0+(110.0*p11)+(45.0*p21)+(7.0*p31)))))+(3.0*p10*((7.0*p302*(-68.0+(27.0*p11)+(20.0*p21)+(6.0*p31)))+(27.0*p202*(-272.0+(110.0*p11)+(45.0*p21)+(7.0*p31)))+(6.0*p20*p30*(-544.0+(225.0*p11)+(126.0*p21)+(28.0*p31)))))))+(-3.0*p002*((-18564.0*p11*p20)+(11016.0*p112*p20)+(-1782.0*p113*p20)+(-27846.0*p20*p21)+(22032.0*p11*p20*p21)+(-4455.0*p112*p20*p21)+(9792.0*p20*p212)+(-3645.0*p11*p20*p212)+(-1134.0*p20*p213)+(-3978.0*p21*p30)+(2448.0*p11*p21*p30)+(-405.0*p112*p21*p30)+(1836.0*p212*p30)+(-567.0*p11*p212*p30)+(-252.0*p213*p30)+(1001.0*p013*((120.0*p10)+(15.0*p20)+p30))+(-9282.0*p20*p31)+(6528.0*p11*p20*p31)+(-1215.0*p112*p20*p31)+(6732.0*p20*p21*p31)+(-2268.0*p11*p20*p21*p31)+(-1260.0*p20*p212*p31)+(-2210.0*p30*p31)+(1224.0*p11*p30*p31)+(-189.0*p112*p30*p31)+(1836.0*p21*p30*p31)+(-504.0*p11*p21*p30*p31)+(-378.0*p212*p30*p31)+(1428.0*p20*p312)+(-420.0*p11*p20*p312)+(-567.0*p20*p21*p312)+(544.0*p30*p312)+(-126.0*p11*p30*p312)+(-225.0*p21*p30*p312)+(-105.0*p20*p313)+(-55.0*p30*p313)+(-33.0*p012*(((136.0+(-39.0*p11)+(-6.0*p21))*p30)+(39.0*p10*(272.0+(7.0*p21)+p31))+(p20*(1632.0+(-273.0*p11)+(6.0*p31)))))+(-3.0*p10*((3861.0*p113)+(675.0*p213)+(198.0*p112*(-136.0+(27.0*p21)+(5.0*p31)))+(27.0*p212*(-272.0+(21.0*p31)))+(4.0*p31*(1547.0+(-136.0*p31)+(7.0*p312)))+(4.0*p21*(7735.0+(-884.0*p31)+(49.0*p312)))+(9.0*p11*(6188.0+(330.0*p212)+(-544.0*p31)+(21.0*p312)+(6.0*p21*(-476.0+(25.0*p31)))))))+(-1.0*p01*((p30*(-6188.0+(-594.0*p112)+(135.0*p212)+(-272.0*p31)+(126.0*p21*p31)+(28.0*p312)+(18.0*p11*(204.0+(5.0*p31)))))+(9.0*p10*(-30940.0+(3003.0*p112)+(594.0*p212)+(-952.0*p31)+(25.0*p312)+(44.0*p21*(-136.0+(5.0*p31)))+(66.0*p11*(-136.0+(39.0*p21)+(6.0*p31)))))+(9.0*p20*(-6188.0+(165.0*p212)+(-272.0*p31)+(14.0*p312)+(22.0*p11*(68.0+(18.0*p21)+(5.0*p31)))+(p21*(-816.0+(90.0*p31)))))))))+(-3.0*p01*((9.0*p103*(6188.0+(594.0*p112)+(-135.0*p212)+(272.0*p31)+(-126.0*p21*p31)+(-28.0*p312)+(-18.0*p11*(204.0+(5.0*p31)))))+(9.0*p203*((378.0*p112)+(189.0*p212)+(34.0*(65.0+(-8.0*p31)))+(18.0*p21*(-68.0+(5.0*p31)))+(18.0*p11*(-102.0+(28.0*p21)+(7.0*p31)))))+(p303*(6188.0+(315.0*p112)+(990.0*p212)+(-4488.0*p31)+(1001.0*p312)+(6.0*p11*(-408.0+(165.0*p21)+(110.0*p31)))+(12.0*p21*(-408.0+(143.0*p31)))))+(9.0*p202*p30*(3094.0+(420.0*p112)+(405.0*p212)+(-816.0*p31)+(66.0*p312)+(6.0*p11*(-374.0+(126.0*p21)+(45.0*p31)))+(p21*(-2176.0+(330.0*p31)))))+(3.0*p20*p302*(6188.0+(567.0*p112)+(990.0*p212)+(-2856.0*p31)+(429.0*p312)+(36.0*p21*(-136.0+(33.0*p31)))+(2.0*p11*(-1768.0+(675.0*p21)+(330.0*p31)))))+(9.0*p102*((p30*(2210.0+(405.0*p112)+(-816.0*p21)+(84.0*p212)+(14.0*p11*((27.0*p21)+(4.0*(-34.0+p31))))+(-68.0*p31)+(-15.0*p312)))+(3.0*p20*(3094.0+(495.0*p112)+(18.0*p11*(-136.0+(15.0*p21)))+(68.0*p31)+(-21.0*p312)+(-8.0*p21*(68.0+(7.0*p31)))))))+(3.0*p10*((9.0*p202*(2210.0+(405.0*p112)+(-816.0*p21)+(84.0*p212)+(14.0*p11*((27.0*p21)+(4.0*(-34.0+p31))))+(-68.0*p31)+(-15.0*p312)))+(6.0*p20*p30*((378.0*p112)+(189.0*p212)+(34.0*(65.0+(-8.0*p31)))+(18.0*p21*(-68.0+(5.0*p31)))+(18.0*p11*(-102.0+(28.0*p21)+(7.0*p31)))))+(p302*(3094.0+(420.0*p112)+(405.0*p212)+(-816.0*p31)+(66.0*p312)+(6.0*p11*(-374.0+(126.0*p21)+(45.0*p31)))+(p21*(-2176.0+(330.0*p31)))))))))+(-3.0*p00*((11934.0*p11*p202)+(-7344.0*p112*p202)+(1215.0*p113*p202)+(-19890.0*p202*p21)+(5508.0*p11*p202*p21)+(11016.0*p202*p212)+(-2268.0*p11*p202*p212)+(-1701.0*p202*p213)+(13260.0*p11*p20*p30)+(-7344.0*p112*p20*p30)+(1134.0*p113*p20*p30)+(-7956.0*p20*p21*p30)+(-3672.0*p11*p20*p21*p30)+(1512.0*p112*p20*p21*p30)+(4896.0*p20*p212*p30)+(-810.0*p20*p213*p30)+(3978.0*p11*p302)+(-1836.0*p112*p302)+(252.0*p113*p302)+(-2448.0*p11*p21*p302)+(567.0*p112*p21*p302)+(405.0*p11*p212*p302)+(11.0*p013*((4095.0*p102)+(234.0*p202)+(60.0*p20*p30)+(5.0*p302)+(78.0*p10*((21.0*p20)+(2.0*p30)))))+(-19890.0*p202*p31)+(7344.0*p11*p202*p31)+(-756.0*p112*p202*p31)+(17136.0*p202*p21*p31)+(-3402.0*p11*p202*p21*p31)+(-3645.0*p202*p212*p31)+(-18564.0*p20*p30*p31)+(3264.0*p11*p20*p30*p31)+(14688.0*p20*p21*p30*p31)+(-1620.0*p11*p20*p21*p30*p31)+(-2970.0*p20*p212*p30*p31)+(-6188.0*p302*p31)+(135.0*p112*p302*p31)+(3672.0*p21*p302*p31)+(-594.0*p212*p302*p31)+(7344.0*p202*p312)+(-1215.0*p11*p202*p312)+(-2970.0*p202*p21*p312)+(9792.0*p20*p30*p312)+(-990.0*p11*p20*p30*p312)+(-3564.0*p20*p21*p30*p312)+(4488.0*p302*p312)+(-198.0*p11*p302*p312)+(-1287.0*p21*p302*p312)+(-990.0*p202*p313)+(-1716.0*p20*p30*p313)+(-1001.0*p302*p313)+(p012*((27.0*p202*(-544.0+(198.0*p11)+(55.0*p21)+(5.0*p31)))+(18.0*p20*p30*(-272.0+(110.0*p11)+(45.0*p21)+(7.0*p31)))+(p302*(-544.0+(225.0*p11)+(126.0*p21)+(28.0*p31)))+(297.0*p102*((91.0*p11)+(-2.0*(272.0+p31))))+(18.0*p10*((33.0*p20*(-136.0+(39.0*p11)+(6.0*p21)))+(p30*(-544.0+(198.0*p11)+(55.0*p21)+(5.0*p31)))))))+(-9.0*p102*((594.0*p113)+(378.0*p213)+(27.0*p112*(-136.0+(55.0*p21)+(15.0*p31)))+(12.0*p212*(-272.0+(35.0*p31)))+(7.0*p31*(442.0+(-68.0*p31)+(5.0*p312)))+(3.0*p21*(3094.0+(-748.0*p31)+(63.0*p312)))+(p11*((1215.0*p212)+(108.0*p21*(-68.0+(7.0*p31)))+(4.0*(1547.0+(-544.0*p31)+(35.0*p312)))))))+(p01*((6.0*p20*p30*(2210.0+(405.0*p112)+(-816.0*p21)+(84.0*p212)+(14.0*p11*((27.0*p21)+(4.0*(-34.0+p31))))+(-68.0*p31)+(-15.0*p312)))+(9.0*p202*(3094.0+(495.0*p112)+(18.0*p11*(-136.0+(15.0*p21)))+(68.0*p31)+(-21.0*p312)+(-8.0*p21*(68.0+(7.0*p31)))))+(p302*((378.0*p112)+(189.0*p212)+(34.0*(65.0+(-8.0*p31)))+(18.0*p21*(-68.0+(5.0*p31)))+(18.0*p11*(-102.0+(28.0*p21)+(7.0*p31)))))+(-27.0*p102*(-6188.0+(165.0*p212)+(-272.0*p31)+(14.0*p312)+(22.0*p11*(68.0+(18.0*p21)+(5.0*p31)))+(p21*(-816.0+(90.0*p31)))))+(6.0*p10*((3.0*p20*(6188.0+(594.0*p112)+(-135.0*p212)+(272.0*p31)+(-126.0*p21*p31)+(-28.0*p312)+(-18.0*p11*(204.0+(5.0*p31)))))+(p30*(3094.0+(495.0*p112)+(18.0*p11*(-136.0+(15.0*p21)))+(68.0*p31)+(-21.0*p312)+(-8.0*p21*(68.0+(7.0*p31)))))))))+(-6.0*p10*((3.0*p20*((252.0*p213)+(27.0*p212*(-68.0+(21.0*p11)+(14.0*p31)))+(p31*(2210.0+(189.0*p112)+(-544.0*p31)+(55.0*p312)+(18.0*p11*(-68.0+(7.0*p31)))))+(9.0*p21*(442.0+(45.0*p112)+(-204.0*p31)+(25.0*p312)+(8.0*p11*(-34.0+(7.0*p31)))))))+(p30*((-135.0*p113)+(189.0*p213)+(12.0*p112*(68.0+(7.0*p31)))+(9.0*p212*(-136.0+(45.0*p31)))+(2.0*p31*(1105.0+(-408.0*p31)+(55.0*p312)))+(2.0*p21*(1105.0+(-952.0*p31)+(165.0*p312)))+(3.0*p11*(-442.0+(84.0*p212)+(-272.0*p31)+(45.0*p312)+(6.0*p21*(-34.0+(21.0*p31)))))))))))));
	*accum = ((1.0/36.0)*((-3.0*p01)+(3.0*p012)+(-1.0*p013)+(p31*(3.0+(-3.0*p31)+p312))));
}
static void cube_12(double *pixel, double *accum, Curve<4,2> *curve)
{
	const double &p00 = curve->p[0].v[0];
	const double &p01 = curve->p[0].v[1];
	const double &p10 = curve->p[1].v[0];
	const double &p11 = curve->p[1].v[1];
	const double &p20 = curve->p[2].v[0];
	const double &p21 = curve->p[2].v[1];
	const double &p30 = curve->p[3].v[0];
	const double &p31 = curve->p[3].v[1];
	const double p002 = p00*p00;
	const double p012 = p01*p01;
	const double p102 = p10*p10;
	const double p112 = p11*p11;
	const double p202 = p20*p20;
	const double p212 = p21*p21;
	const double p302 = p30*p30;
	const double p312 = p31*p31;
	const double p003 = p00*p002;
	const double p013 = p01*p012;
	const double p103 = p10*p102;
	const double p113 = p11*p112;
	const double p203 = p20*p202;
	const double p213 = p21*p212;
	const double p303 = p30*p302;
	const double p313 = p31*p312;
	*pixel = ((1.0/24504480.0)*((-918918.0*p11*p20)+(-393822.0*p10*p11*p20)+(107406.0*p102*p11*p20)+(393822.0*p112*p20)+(214812.0*p10*p112*p20)+(-66096.0*p102*p112*p20)+(-53703.0*p113*p20)+(-33048.0*p10*p113*p20)+(10935.0*p102*p113*p20)+(-393822.0*p11*p202)+(179010.0*p10*p11*p202)+(179010.0*p112*p202)+(-99144.0*p10*p112*p202)+(-24786.0*p113*p202)+(15309.0*p10*p113*p202)+(107406.0*p11*p203)+(-49572.0*p112*p203)+(6804.0*p113*p203)+(918918.0*p10*p21)+(393822.0*p102*p21)+(-107406.0*p103*p21)+(-393822.0*p10*p11*p21)+(-214812.0*p102*p11*p21)+(66096.0*p103*p11*p21)+(53703.0*p10*p112*p21)+(33048.0*p102*p112*p21)+(-10935.0*p103*p112*p21)+(393822.0*p10*p20*p21)+(-179010.0*p102*p20*p21)+(393822.0*p11*p20*p21)+(49572.0*p102*p11*p20*p21)+(-89505.0*p112*p20*p21)+(-24786.0*p10*p112*p20*p21)+(-107406.0*p10*p202*p21)+(214812.0*p11*p202*p21)+(-49572.0*p10*p11*p202*p21)+(-49572.0*p112*p202*p21)+(20412.0*p10*p112*p202*p21)+(-66096.0*p11*p203*p21)+(15309.0*p112*p203*p21)+(-393822.0*p10*p212)+(-179010.0*p102*p212)+(49572.0*p103*p212)+(89505.0*p10*p11*p212)+(49572.0*p102*p11*p212)+(-15309.0*p103*p11*p212)+(-214812.0*p10*p20*p212)+(99144.0*p102*p20*p212)+(-53703.0*p11*p20*p212)+(24786.0*p10*p11*p20*p212)+(-20412.0*p102*p11*p20*p212)+(66096.0*p10*p202*p212)+(-33048.0*p11*p202*p212)+(10935.0*p11*p203*p212)+(53703.0*p10*p213)+(24786.0*p102*p213)+(-6804.0*p103*p213)+(33048.0*p10*p20*p213)+(-15309.0*p102*p20*p213)+(-10935.0*p10*p202*p213)+(-918918.0*p11*p30)+(-262548.0*p10*p11*p30)+(59670.0*p102*p11*p30)+(262548.0*p112*p30)+(119340.0*p10*p112*p30)+(-33048.0*p102*p112*p30)+(-29835.0*p113*p30)+(-16524.0*p10*p113*p30)+(5103.0*p102*p113*p30)+(-656370.0*p11*p20*p30)+(214812.0*p10*p11*p20*p30)+(214812.0*p112*p20*p30)+(-99144.0*p10*p112*p20*p30)+(-24786.0*p113*p20*p30)+(13608.0*p10*p113*p20*p30)+(250614.0*p11*p202*p30)+(-88128.0*p112*p202*p30)+(10206.0*p113*p202*p30)+(-1837836.0*p21*p30)+(-35802.0*p102*p21*p30)+(656370.0*p11*p21*p30)+(143208.0*p10*p11*p21*p30)+(-16524.0*p102*p11*p21*p30)+(-89505.0*p112*p21*p30)+(-33048.0*p10*p112*p21*p30)+(6804.0*p102*p112*p21*p30)+(-656370.0*p20*p21*p30)+(501228.0*p11*p20*p21*p30)+(-132192.0*p10*p11*p20*p21*p30)+(-77112.0*p112*p20*p21*p30)+(30618.0*p10*p112*p20*p21*p30)+(167076.0*p202*p21*p30)+(-198288.0*p11*p202*p21*p30)+(32805.0*p112*p202*p21*p30)+(656370.0*p212*p30)+(22032.0*p102*p212*p30)+(-125307.0*p11*p212*p30)+(-22032.0*p10*p11*p212*p30)+(334152.0*p20*p212*p30)+(-99144.0*p11*p20*p212*p30)+(21870.0*p10*p11*p20*p212*p30)+(-99144.0*p202*p212*p30)+(40095.0*p11*p202*p212*p30)+(-83538.0*p213*p30)+(-3645.0*p102*p213*p30)+(-49572.0*p20*p213*p30)+(16038.0*p202*p213*p30)+(-437580.0*p11*p302)+(83538.0*p10*p11*p302)+(83538.0*p112*p302)+(-29376.0*p10*p112*p302)+(-7344.0*p113*p302)+(3402.0*p10*p113*p302)+(278460.0*p11*p20*p302)+(-66096.0*p112*p20*p302)+(6075.0*p113*p20*p302)+(-1531530.0*p21*p302)+(55692.0*p10*p21*p302)+(334152.0*p11*p21*p302)+(-66096.0*p10*p11*p21*p302)+(-33048.0*p112*p21*p302)+(10935.0*p10*p112*p21*p302)+(501228.0*p20*p21*p302)+(-231336.0*p11*p20*p21*p302)+(26730.0*p112*p20*p21*p302)+(501228.0*p212*p302)+(-33048.0*p10*p212*p302)+(-66096.0*p11*p212*p302)+(13365.0*p10*p11*p212*p302)+(-242352.0*p20*p212*p302)+(48114.0*p11*p20*p212*p302)+(-60588.0*p213*p302)+(5346.0*p10*p213*p302)+(34749.0*p20*p213*p302)+(167076.0*p11*p303)+(-22032.0*p112*p303)+(1485.0*p113*p303)+(835380.0*p21*p303)+(-121176.0*p11*p21*p303)+(8910.0*p112*p21*p303)+(-242352.0*p212*p303)+(23166.0*p11*p212*p303)+(27027.0*p213*p303)+(p013*((27027.0*p103)+(1485.0*p203)+(594.0*p102*(-204.0+(39.0*p20)+(5.0*p30)))+(27.0*p202*(-408.0+(35.0*p30)))+(18.0*p20*(-4641.0+(-204.0*p30)+(14.0*p302)))+(2.0*p30*(-4641.0+(-204.0*p30)+(14.0*p302)))+(9.0*p10*(-46410.0+(990.0*p202)+(-816.0*p30)+(35.0*p302)+(66.0*p20*(-102.0+(5.0*p30)))))))+(918918.0*p10*p31)+(262548.0*p102*p31)+(-59670.0*p103*p31)+(-262548.0*p10*p11*p31)+(-119340.0*p102*p11*p31)+(33048.0*p103*p11*p31)+(29835.0*p10*p112*p31)+(16524.0*p102*p112*p31)+(-5103.0*p103*p112*p31)+(1837836.0*p20*p31)+(656370.0*p10*p20*p31)+(-179010.0*p102*p20*p31)+(-143208.0*p10*p11*p20*p31)+(66096.0*p102*p11*p20*p31)+(-17901.0*p112*p20*p31)+(8262.0*p10*p112*p20*p31)+(-6804.0*p102*p112*p20*p31)+(656370.0*p202*p31)+(-250614.0*p10*p202*p31)+(44064.0*p10*p11*p202*p31)+(-11016.0*p112*p202*p31)+(-167076.0*p203*p31)+(3645.0*p112*p203*p31)+(-656370.0*p10*p21*p31)+(-214812.0*p102*p21*p31)+(49572.0*p103*p21*p31)+(107406.0*p10*p11*p21*p31)+(49572.0*p102*p11*p21*p31)+(-13608.0*p103*p11*p21*p31)+(-656370.0*p20*p21*p31)+(-501228.0*p10*p20*p21*p31)+(154224.0*p102*p20*p21*p31)+(66096.0*p10*p11*p20*p21*p31)+(-30618.0*p102*p11*p20*p21*p31)+(-334152.0*p202*p21*p31)+(198288.0*p10*p202*p21*p31)+(-21870.0*p10*p11*p202*p21*p31)+(99144.0*p203*p21*p31)+(125307.0*p10*p212*p31)+(44064.0*p102*p212*p31)+(-10206.0*p103*p212*p31)+(83538.0*p20*p212*p31)+(99144.0*p10*p20*p212*p31)+(-32805.0*p102*p20*p212*p31)+(49572.0*p202*p212*p31)+(-40095.0*p10*p202*p212*p31)+(-16038.0*p203*p212*p31)+(3063060.0*p30*p31)+(437580.0*p10*p30*p31)+(-83538.0*p102*p30*p31)+(437580.0*p11*p30*p31)+(14688.0*p102*p11*p30*p31)+(-41769.0*p112*p30*p31)+(-7344.0*p10*p112*p30*p31)+(1531530.0*p20*p30*p31)+(-334152.0*p10*p20*p30*p31)+(222768.0*p11*p20*p30*p31)+(-33048.0*p112*p20*p30*p31)+(7290.0*p10*p112*p20*p30*p31)+(-501228.0*p202*p30*p31)+(-66096.0*p11*p202*p30*p31)+(13365.0*p112*p202*p30*p31)+(1531530.0*p21*p30*p31)+(-222768.0*p10*p21*p30*p31)+(66096.0*p102*p21*p30*p31)+(-167076.0*p11*p21*p30*p31)+(-7290.0*p102*p11*p21*p30*p31)+(198288.0*p10*p20*p21*p30*p31)+(-99144.0*p11*p20*p21*p30*p31)+(121176.0*p202*p21*p30*p31)+(32076.0*p11*p202*p21*p30*p31)+(-250614.0*p212*p30*p31)+(33048.0*p10*p212*p30*p31)+(-13365.0*p102*p212*p30*p31)+(-60588.0*p20*p212*p30*p31)+(-32076.0*p10*p20*p212*p30*p31)+(2042040.0*p302*p31)+(-167076.0*p10*p302*p31)+(334152.0*p11*p302*p31)+(-22032.0*p10*p11*p302*p31)+(-22032.0*p112*p302*p31)+(4455.0*p10*p112*p302*p31)+(-835380.0*p20*p302*p31)+(-161568.0*p11*p20*p302*p31)+(16038.0*p112*p20*p302*p31)+(1670760.0*p21*p302*p31)+(40392.0*p10*p21*p302*p31)+(-121176.0*p11*p21*p302*p31)+(10692.0*p10*p11*p21*p302*p31)+(-242352.0*p20*p21*p302*p31)+(69498.0*p11*p20*p21*p302*p31)+(-242352.0*p212*p302*p31)+(81081.0*p20*p212*p302*p31)+(-1021020.0*p303*p31)+(-161568.0*p11*p303*p31)+(7722.0*p112*p303*p31)+(-1050192.0*p21*p303*p31)+(54054.0*p11*p21*p303*p31)+(135135.0*p212*p303*p31)+(-437580.0*p10*p312)+(-83538.0*p102*p312)+(14688.0*p103*p312)+(41769.0*p10*p11*p312)+(14688.0*p102*p11*p312)+(-3402.0*p103*p11*p312)+(-1531530.0*p20*p312)+(-334152.0*p10*p20*p312)+(66096.0*p102*p20*p312)+(27846.0*p11*p20*p312)+(33048.0*p10*p11*p20*p312)+(-10935.0*p102*p11*p20*p312)+(-501228.0*p202*p312)+(132192.0*p10*p202*p312)+(16524.0*p11*p202*p312)+(-13365.0*p10*p11*p202*p312)+(121176.0*p203*p312)+(-5346.0*p11*p203*p312)+(139230.0*p10*p21*p312)+(33048.0*p102*p21*p312)+(-6075.0*p103*p21*p312)+(250614.0*p20*p21*p312)+(115668.0*p10*p20*p21*p312)+(-26730.0*p102*p20*p21*p312)+(121176.0*p202*p21*p312)+(-48114.0*p10*p202*p21*p312)+(-34749.0*p203*p21*p312)+(-4084080.0*p30*p312)+(-334152.0*p10*p30*p312)+(44064.0*p102*p30*p312)+(-83538.0*p11*p30*p312)+(11016.0*p10*p11*p30*p312)+(-4455.0*p102*p11*p30*p312)+(-1670760.0*p20*p30*p312)+(242352.0*p10*p20*p30*p312)+(-20196.0*p11*p20*p30*p312)+(-10692.0*p10*p11*p20*p30*p312)+(484704.0*p202*p30*p312)+(-417690.0*p21*p30*p312)+(80784.0*p10*p21*p30*p312)+(-16038.0*p102*p21*p30*p312)+(121176.0*p20*p21*p30*p312)+(-69498.0*p10*p20*p21*p30*p312)+(-81081.0*p202*p21*p30*p312)+(-3063060.0*p302*p312)+(161568.0*p10*p302*p312)+(-80784.0*p11*p302*p312)+(1050192.0*p20*p302*p312)+(27027.0*p11*p20*p302*p312)+(-525096.0*p21*p302*p312)+(-27027.0*p10*p21*p302*p312)+(1633632.0*p303*p312)+(45045.0*p11*p303*p312)+(360360.0*p21*p303*p312)+(83538.0*p10*p313)+(11016.0*p102*p313)+(-1485.0*p103*p313)+(417690.0*p20*p313)+(60588.0*p10*p20*p313)+(-8910.0*p102*p20*p313)+(121176.0*p202*p313)+(-23166.0*p10*p202*p313)+(-27027.0*p203*p313)+(1531530.0*p30*p313)+(80784.0*p10*p30*p313)+(-7722.0*p102*p30*p313)+(525096.0*p20*p30*p313)+(-54054.0*p10*p20*p30*p313)+(-135135.0*p202*p30*p313)+(1225224.0*p302*p313)+(-45045.0*p10*p302*p313)+(-360360.0*p20*p302*p313)+(-680680.0*p303*p313)+(p003*((680680.0*p013)+(-27027.0*p113)+(-167076.0*p21)+(22032.0*p212)+(-1485.0*p213)+(-18564.0*p31)+(7344.0*p21*p31)+(-945.0*p212*p31)+(816.0*p312)+(-252.0*p21*p312)+(-28.0*p313)+(-3003.0*p012*(544.0+(120.0*p11)+(15.0*p21)+p31))+(-594.0*p112*(-408.0+(39.0*p21)+(5.0*p31)))+(-33.0*p01*(-30940.0+(4095.0*p112)+(-4896.0*p21)+(234.0*p212)+(-408.0*p31)+(60.0*p21*p31)+(5.0*p312)+(78.0*p11*(-408.0+(21.0*p21)+(2.0*p31)))))+(-9.0*p11*(92820.0+(990.0*p212)+(-1632.0*p31)+(35.0*p312)+(66.0*p21*(-204.0+(5.0*p31)))))))+(3.0*p012*((297.0*p103*(-136.0+(39.0*p11)+(6.0*p21)))+(9.0*p203*(-544.0+(225.0*p11)+(126.0*p21)+(28.0*p31)))+(p30*(24310.0+(2210.0*p30)+(-272.0*p302)+(21.0*p21*(-221.0+(-34.0*p30)+(5.0*p302)))+(p11*(-9282.0+(-816.0*p30)+(84.0*p302)))+(-1105.0*p31)+(-272.0*p30*p31)+(55.0*p302*p31)))+(3.0*p20*(48620.0+(4420.0*p30)+(-544.0*p302)+(3.0*p21*(-1547.0+(-374.0*p30)+(63.0*p302)))+(2.0*p11*(-7735.0+(-884.0*p30)+(98.0*p302)))+(-663.0*p31)+(-306.0*p30*p31)+(75.0*p302*p31)))+(27.0*p102*(6188.0+(-204.0*p21)+(-272.0*p30)+(45.0*p21*p30)+(22.0*p11*(-68.0+(27.0*p20)+(5.0*p30)))+(7.0*p30*p31)+(3.0*p20*(-544.0+(55.0*p21)+(5.0*p31)))))+(9.0*p202*((9.0*p11*(-136.0+(21.0*p30)))+(2.0*(1547.0+(-238.0*p30)+(p21*(-272.0+(70.0*p30)))+(-51.0*p31)+(21.0*p30*p31)))))+(3.0*p10*((9.0*p11*(-3094.0+(330.0*p202)+(-272.0*p30)+(21.0*p302)+(6.0*p20*(-238.0+(25.0*p30)))))+(27.0*p202*(-272.0+(45.0*p21)+(7.0*p31)))+(2.0*(85085.0+(p21*(-1547.0+(-544.0*p30)+(70.0*p302)))+(-34.0*p30*(-91.0+(3.0*p31)))+(7.0*p302*(-34.0+(3.0*p31)))))+(12.0*p20*((9.0*p21*(-34.0+(7.0*p30)))+(-34.0*(-91.0+p31))+(2.0*p30*(-136.0+(7.0*p31)))))))))+(3.0*p002*((-297.0*p113*(-68.0+(39.0*p10)+(6.0*p20)))+(145860.0*p21)+(-92820.0*p10*p21)+(-27846.0*p20*p21)+(-27846.0*p212)+(22032.0*p10*p212)+(9792.0*p20*p212)+(2448.0*p213)+(-2025.0*p10*p213)+(-1134.0*p20*p213)+(-3978.0*p21*p30)+(1836.0*p212*p30)+(-252.0*p213*p30)+(1001.0*p013*(-408.0+(120.0*p10)+(15.0*p20)+p30))+(24310.0*p31)+(-18564.0*p10*p31)+(-9282.0*p20*p31)+(-13260.0*p21*p31)+(10608.0*p10*p21*p31)+(6732.0*p20*p21*p31)+(2142.0*p212*p31)+(-1701.0*p10*p212*p31)+(-1260.0*p20*p212*p31)+(-2210.0*p30*p31)+(1836.0*p21*p30*p31)+(-378.0*p212*p30*p31)+(-2210.0*p312)+(1632.0*p10*p312)+(1428.0*p20*p312)+(816.0*p21*p312)+(-588.0*p10*p21*p312)+(-567.0*p20*p21*p312)+(544.0*p30*p312)+(-225.0*p21*p30*p312)+(136.0*p313)+(-84.0*p10*p313)+(-105.0*p20*p313)+(-55.0*p30*p313)+(-33.0*p012*(-30940.0+(1632.0*p20)+(-816.0*p21)+(136.0*p30)+(-6.0*p21*p30)+(-39.0*p11*(136.0+(7.0*p20)+p30))+(-68.0*p31)+(6.0*p20*p31)+(39.0*p10*(272.0+(7.0*p21)+p31))))+(-27.0*p112*(6188.0+(-816.0*p21)+(15.0*p21*p30)+(-136.0*p31)+(7.0*p30*p31)+(22.0*p10*(-136.0+(27.0*p21)+(5.0*p31)))+(3.0*p20*(-136.0+(55.0*p21)+(15.0*p31)))))+(-1.0*p01*(680680.0+(-55692.0*p20)+(111384.0*p21)+(-7344.0*p20*p21)+(-7344.0*p212)+(1485.0*p20*p212)+(-6188.0*p30)+(135.0*p212*p30)+(-594.0*p112*(136.0+p30))+(12376.0*p31)+(-2448.0*p20*p31)+(-2448.0*p21*p31)+(810.0*p20*p21*p31)+(-272.0*p30*p31)+(126.0*p21*p30*p31)+(-272.0*p312)+(126.0*p20*p312)+(28.0*p30*p312)+(18.0*p11*(30940.0+(-2244.0*p21)+(204.0*p30)+(-272.0*p31)+(5.0*p30*p31)+(11.0*p20*(68.0+(18.0*p21)+(5.0*p31)))))+(9.0*p10*(-30940.0+(3003.0*p112)+(594.0*p212)+(-952.0*p31)+(25.0*p312)+(44.0*p21*(-136.0+(5.0*p31)))+(66.0*p11*(-136.0+(39.0*p21)+(6.0*p31)))))))+(-3.0*p11*(-170170.0+(37128.0*p21)+(-3672.0*p212)+(-816.0*p21*p30)+(189.0*p212*p30)+(6188.0*p31)+(-1632.0*p21*p31)+(-408.0*p30*p31)+(168.0*p21*p30*p31)+(-238.0*p312)+(42.0*p30*p312)+(p20*(6188.0+(-7344.0*p21)+(1215.0*p212)+(-2176.0*p31)+(756.0*p21*p31)+(140.0*p312)))+(9.0*p10*(6188.0+(330.0*p212)+(-544.0*p31)+(21.0*p312)+(6.0*p21*(-476.0+(25.0*p31)))))))))+(3.0*p01*((9.0*p103*(6188.0+(594.0*p112)+(-135.0*p212)+(272.0*p31)+(-126.0*p21*p31)+(-28.0*p312)+(-18.0*p11*(204.0+(5.0*p31)))))+(9.0*p203*((378.0*p112)+(189.0*p212)+(34.0*(65.0+(-8.0*p31)))+(18.0*p21*(-68.0+(5.0*p31)))+(18.0*p11*(-102.0+(28.0*p21)+(7.0*p31)))))+(9.0*p202*(-9724.0+(3094.0*p30)+(12.0*p112*(-136.0+(35.0*p30)))+(9.0*p212*(-68.0+(45.0*p30)))+(884.0*p31)+(-816.0*p30*p31)+(66.0*p30*p312)+(6.0*p11*(1326.0+(-374.0*p30)+(18.0*p21*(-17.0+(7.0*p30)))+(-68.0*p31)+(45.0*p30*p31)))+(p21*(4420.0+(-2176.0*p30)+(-272.0*p31)+(330.0*p30*p31)))))+(9.0*p102*(-24310.0+(408.0*p212)+(2210.0*p30)+(-816.0*p21*p30)+(84.0*p212*p30)+(27.0*p112*(-68.0+(55.0*p20)+(15.0*p30)))+(-884.0*p31)+(408.0*p21*p31)+(-68.0*p30*p31)+(102.0*p312)+(-15.0*p30*p312)+(2.0*p11*((27.0*p20*(-136.0+(15.0*p21)))+(68.0*(91.0+(2.0*p31)))+(7.0*p30*(-136.0+(27.0*p21)+(4.0*p31)))))+(-3.0*p20*(-3094.0+(-68.0*p31)+(21.0*p312)+(8.0*p21*(68.0+(7.0*p31)))))))+(3.0*p20*(-102102.0+(-24310.0*p30)+(6188.0*p302)+(9.0*p112*(-1547.0+(-374.0*p30)+(63.0*p302)))+(3.0*p212*(-1105.0+(-952.0*p30)+(330.0*p302)))+(4862.0*p31)+(6188.0*p30*p31)+(-2856.0*p302*p31)+(-612.0*p30*p312)+(429.0*p302*p312)+(6.0*p21*((-221.0*(-22.0+p31))+(-204.0*p30*(-13.0+(2.0*p31)))+(6.0*p302*(-136.0+(33.0*p31)))))+(2.0*p11*((27.0*p21*(-221.0+(-102.0*p30)+(25.0*p302)))+(-1105.0*(-33.0+p31))+(-136.0*p30*(-65.0+(7.0*p31)))+(2.0*p302*(-884.0+(165.0*p31)))))))+(p30*(-102102.0+(-24310.0*p30)+(6188.0*p302)+(63.0*p112*(-221.0+(-34.0*p30)+(5.0*p302)))+(9.0*p212*(-1105.0+(-408.0*p30)+(110.0*p302)))+(24310.0*p31)+(12376.0*p30*p31)+(-4488.0*p302*p31)+(-3094.0*p312)+(-2244.0*p30*p312)+(1001.0*p302*p312)+(6.0*p11*((3.0*p21*(-1105.0+(-272.0*p30)+(55.0*p302)))+(-1105.0*(-11.0+p31))+(-34.0*p30*(-65.0+(12.0*p31)))+(2.0*p302*(-204.0+(55.0*p31)))))+(6.0*p21*((221.0*(44.0+(-7.0*p31)))+(-34.0*p30*(-91.0+(24.0*p31)))+(p302*(-816.0+(286.0*p31)))))))+(3.0*p10*(-204204.0+(1989.0*p212)+(-19448.0*p30)+(8840.0*p21*p30)+(-1224.0*p212*p30)+(3094.0*p302)+(-2176.0*p21*p302)+(405.0*p212*p302)+(3.0*p112*((1215.0*p202)+(108.0*p20*(-34.0+(7.0*p30)))+(2.0*(-1547.0+(-544.0*p30)+(70.0*p302)))))+(-4862.0*p31)+(2210.0*p21*p31)+(1768.0*p30*p31)+(-544.0*p21*p30*p31)+(-816.0*p302*p31)+(330.0*p21*p302*p31)+(663.0*p312)+(66.0*p302*p312)+(9.0*p202*(2210.0+(-816.0*p21)+(84.0*p212)+(-68.0*p31)+(-15.0*p312)))+(6.0*p11*((21.0*p202*((27.0*p21)+(4.0*(-34.0+p31))))+(221.0*(55.0+p31))+(-68.0*p30*(-39.0+(9.0*p21)+(2.0*p31)))+(p302*(-374.0+(126.0*p21)+(45.0*p31)))+(6.0*p20*(1547.0+(-306.0*p30)+(12.0*p21*(-17.0+(7.0*p30)))+(-17.0*p31)+(21.0*p30*p31)))))+(6.0*p20*((9.0*p212*(-17.0+(21.0*p30)))+(6.0*p21*((17.0*(26.0+p31))+(3.0*p30*(-68.0+(5.0*p31)))))+(17.0*(-715.0+(4.0*p312)+(-2.0*p30*(-65.0+(8.0*p31)))))))))))+(3.0*p00*((306306.0*p21)+(218790.0*p10*p21)+(-83538.0*p102*p21)+(87516.0*p20*p21)+(-71604.0*p10*p20*p21)+(-19890.0*p202*p21)+(-87516.0*p212)+(-71604.0*p10*p212)+(29376.0*p102*p212)+(-39780.0*p20*p212)+(33048.0*p10*p20*p212)+(11016.0*p202*p212)+(9945.0*p213)+(8262.0*p10*p213)+(-3402.0*p102*p213)+(5508.0*p20*p213)+(-4536.0*p10*p20*p213)+(-1701.0*p202*p213)+(14586.0*p21*p30)+(-13260.0*p10*p21*p30)+(-7956.0*p20*p21*p30)+(-7956.0*p212*p30)+(7344.0*p10*p212*p30)+(4896.0*p20*p212*p30)+(1224.0*p213*p30)+(-1134.0*p10*p213*p30)+(-810.0*p20*p213*p30)+(11.0*p013*(-46410.0+(4095.0*p102)+(234.0*p202)+(-204.0*p30)+(5.0*p302)+(78.0*p10*(-204.0+(21.0*p20)+(2.0*p30)))+(12.0*p20*(-204.0+(5.0*p30)))))+(-9.0*p113*(-3094.0+(594.0*p102)+(-135.0*p202)+(136.0*p30)+(-126.0*p20*p30)+(-28.0*p302)+(-18.0*p10*(102.0+(5.0*p30)))))+(102102.0*p31)+(72930.0*p10*p31)+(-27846.0*p102*p31)+(58344.0*p20*p31)+(-39780.0*p10*p20*p31)+(-19890.0*p202*p31)+(-72930.0*p21*p31)+(-53040.0*p10*p21*p31)+(20196.0*p102*p21*p31)+(-47736.0*p20*p21*p31)+(33048.0*p10*p20*p21*p31)+(17136.0*p202*p21*p31)+(13923.0*p212*p31)+(10098.0*p10*p212*p31)+(-3780.0*p102*p212*p31)+(9792.0*p20*p212*p31)+(-6804.0*p10*p20*p212*p31)+(-3645.0*p202*p212*p31)+(24310.0*p30*p31)+(-13260.0*p10*p30*p31)+(-18564.0*p20*p30*p31)+(-18564.0*p21*p30*p31)+(11424.0*p10*p21*p30*p31)+(14688.0*p20*p21*p30*p31)+(3672.0*p212*p30*p31)+(-2430.0*p10*p212*p30*p31)+(-2970.0*p20*p212*p30*p31)+(-6188.0*p302*p31)+(3672.0*p21*p302*p31)+(-594.0*p212*p302*p31)+(-24310.0*p312)+(-13260.0*p10*p312)+(4284.0*p102*p312)+(-18564.0*p20*p312)+(9792.0*p10*p20*p312)+(7344.0*p202*p312)+(9282.0*p21*p312)+(5304.0*p10*p21*p312)+(-1701.0*p102*p21*p312)+(7344.0*p20*p21*p312)+(-4050.0*p10*p20*p21*p312)+(-2970.0*p202*p21*p312)+(-12376.0*p30*p312)+(4896.0*p10*p30*p312)+(9792.0*p20*p30*p312)+(4284.0*p21*p30*p312)+(-1980.0*p10*p21*p30*p312)+(-3564.0*p20*p21*p30*p312)+(4488.0*p302*p312)+(-1287.0*p21*p302*p312)+(3094.0*p313)+(1224.0*p10*p313)+(-315.0*p102*p313)+(2448.0*p20*p313)+(-990.0*p10*p20*p313)+(-990.0*p202*p313)+(2244.0*p30*p313)+(-660.0*p10*p30*p313)+(-1716.0*p20*p30*p313)+(-1001.0*p302*p313)+(p012*(1361360.0+(111384.0*p20)+(-14688.0*p202)+(27846.0*p21)+(-3672.0*p20*p21)+(1485.0*p202*p21)+(12376.0*p30)+(-4896.0*p20*p30)+(-1224.0*p21*p30)+(810.0*p20*p21*p30)+(-544.0*p302)+(126.0*p21*p302)+(9.0*p11*(15470.0+(594.0*p202)+(-476.0*p30)+(25.0*p302)+(44.0*p20*(-68.0+(5.0*p30)))))+(3094.0*p31)+(135.0*p202*p31)+(-136.0*p30*p31)+(126.0*p20*p30*p31)+(28.0*p302*p31)+(18.0*p10*(30940.0+(374.0*p21)+(66.0*p20*(-68.0+(3.0*p21)))+(-544.0*p30)+(55.0*p21*p30)+(33.0*p11*(-68.0+(39.0*p20)+(6.0*p30)))+(102.0*p31)+(5.0*p30*p31)))+(297.0*p102*((91.0*p11)+(-2.0*(272.0+p31))))))+(-9.0*p112*(24310.0+(-4641.0*p21)+(-884.0*p30)+(102.0*p21*p30)+(204.0*p302)+(-63.0*p21*p302)+(-1105.0*p31)+(-34.0*p30*p31)+(-15.0*p302*p31)+(12.0*p202*(68.0+(7.0*p31)))+(27.0*p102*(-136.0+(55.0*p21)+(15.0*p31)))+(-24.0*p20*((p21*(34.0+(7.0*p30)))+(17.0*((-2.0*p30)+p31))))+(2.0*p10*((27.0*(-68.0+(15.0*p20))*p21)+(4.0*p30*(68.0+(7.0*p31)))+(7.0*(884.0+(-68.0*p31)+(27.0*p20*p31)))))))+(p01*(-1021020.0+(-145860.0*p20)+(27846.0*p202)+(-145860.0*p21)+(-4896.0*p202*p21)+(13923.0*p212)+(2448.0*p20*p212)+(-24310.0*p30)+(13260.0*p20*p30)+(5304.0*p21*p30)+(-4896.0*p20*p21*p30)+(-306.0*p212*p30)+(504.0*p20*p212*p30)+(2210.0*p302)+(-1224.0*p21*p302)+(189.0*p212*p302)+(27.0*p112*(3094.0+(-408.0*p20)+(165.0*p202)+(-136.0*p30)+(90.0*p20*p30)+(14.0*p302)))+(-24310.0*p31)+(-5304.0*p20*p31)+(612.0*p202*p31)+(6630.0*p21*p31)+(2448.0*p20*p21*p31)+(-504.0*p202*p21*p31)+(-408.0*p20*p30*p31)+(204.0*p21*p30*p31)+(-272.0*p302*p31)+(90.0*p21*p302*p31)+(1105.0*p312)+(612.0*p20*p312)+(-189.0*p202*p312)+(136.0*p30*p312)+(-90.0*p20*p30*p312)+(-27.0*p102*(-6188.0+(165.0*p212)+(-272.0*p31)+(14.0*p312)+(22.0*p11*(68.0+(18.0*p21)+(5.0*p31)))+(p21*(-816.0+(90.0*p31)))))+(6.0*p11*(-85085.0+(27.0*p202*(-136.0+(15.0*p21)))+(3094.0*p30)+(-306.0*p302)+(6.0*p21*(1547.0+(-68.0*p30)+(14.0*p302)))+(1547.0*p31)+(-34.0*p30*p31)+(21.0*p302*p31)+(2.0*p20*((68.0*(91.0+(2.0*p31)))+(7.0*p30*(-136.0+(27.0*p21)+(4.0*p31)))))))+(6.0*p10*(-85085.0+(-12376.0*p21)+(1836.0*p212)+(3094.0*p30)+(-544.0*p21*p30)+(99.0*p112*(34.0+(18.0*p20)+(5.0*p30)))+(-3094.0*p31)+(952.0*p21*p31)+(68.0*p30*p31)+(-56.0*p21*p30*p31)+(153.0*p312)+(-21.0*p30*p312)+(-3.0*p20*(-6188.0+(135.0*p212)+(-272.0*p31)+(126.0*p21*p31)+(28.0*p312)))+(18.0*p11*((3.0*p21*(102.0+(5.0*p30)))+(68.0*((-2.0*p30)+p31))+(-3.0*p20*(204.0+(5.0*p31)))))))))+(-3.0*p11*(-204204.0+(72930.0*p21)+(-9945.0*p212)+(4862.0*p30)+(-306.0*p212*p30)+(-1326.0*p302)+(816.0*p21*p302)+(-135.0*p212*p302)+(19448.0*p31)+(-6630.0*p21*p31)+(1768.0*p30*p31)+(-816.0*p21*p30*p31)+(-1547.0*p312)+(-408.0*p30*p312)+(66.0*p302*p312)+(9.0*p202*(-442.0+(84.0*p212)+(-272.0*p31)+(45.0*p312)+(6.0*p21*(-34.0+(21.0*p31)))))+(3.0*p102*((1215.0*p212)+(108.0*p21*(-68.0+(7.0*p31)))+(4.0*(1547.0+(-544.0*p31)+(35.0*p312)))))+(6.0*p10*(-12155.0+(21.0*p212*(-68.0+(27.0*p20)+(4.0*p30)))+(2652.0*p31)+(-1224.0*p20*p31)+(-187.0*p312)+(126.0*p20*p312)+(p30*(-442.0+(-272.0*p31)+(45.0*p312)))+(6.0*p21*(1547.0+(-34.0*p30)+(-153.0*p31)+(21.0*p30*p31)+(12.0*p20*(-34.0+(7.0*p31)))))))+(-2.0*p20*((1836.0*p212)+(68.0*p31*(-65.0+(8.0*p31)))+(p30*(2210.0+(544.0*p31)+(-165.0*p312)))+(-18.0*p21*(442.0+(-102.0*p31)+(p30*(34.0+(15.0*p31)))))))))))));
	*accum = ((1.0/9.0)*((-3.0*p01)+(3.0*p012)+(-1.0*p013)+(p31*(3.0+(-3.0*p31)+p312))));
}
static void cube_22(double *pixel, double *accum, Curve<4,2> *curve)
{
	const double &p00 = curve->p[0].v[0];
	const double &p01 = curve->p[0].v[1];
	const double &p10 = curve->p[1].v[0];
	const double &p11 = curve->p[1].v[1];
	const double &p20 = curve->p[2].v[0];
	const double &p21 = curve->p[2].v[1];
	const double &p30 = curve->p[3].v[0];
	const double &p31 = curve->p[3].v[1];
	const double p002 = p00*p00;
	const double p012 = p01*p01;
	const double p102 = p10*p10;
	const double p112 = p11*p11;
	const double p202 = p20*p20;
	const double p212 = p21*p21;
	const double p302 = p30*p30;
	const double p312 = p31*p31;
	const double p003 = p00*p002;
	const double p013 = p01*p012;
	const double p103 = p10*p102;
	const double p113 = p11*p112;
	const double p203 = p20*p202;
	const double p213 = p21*p212;
	const double p303 = p30*p302;
	const double p313 = p31*p312;
	*pixel = ((1.0/49008960.0)*((-1837836.0*p11*p20)+(787644.0*p10*p11*p20)+(-107406.0*p102*p11*p20)+(787644.0*p112*p20)+(-429624.0*p10*p112*p20)+(66096.0*p102*p112*p20)+(-107406.0*p113*p20)+(66096.0*p10*p113*p20)+(-10935.0*p102*p113*p20)+(787644.0*p11*p202)+(-179010.0*p10*p11*p202)+(-358020.0*p112*p202)+(99144.0*p10*p112*p202)+(49572.0*p113*p202)+(-15309.0*p10*p113*p202)+(-107406.0*p11*p203)+(49572.0*p112*p203)+(-6804.0*p113*p203)+(1837836.0*p10*p21)+(-787644.0*p102*p21)+(107406.0*p103*p21)+(-787644.0*p10*p11*p21)+(429624.0*p102*p11*p21)+(-66096.0*p103*p11*p21)+(107406.0*p10*p112*p21)+(-66096.0*p102*p112*p21)+(10935.0*p103*p112*p21)+(-787644.0*p10*p20*p21)+(179010.0*p102*p20*p21)+(787644.0*p11*p20*p21)+(-49572.0*p102*p11*p20*p21)+(-179010.0*p112*p20*p21)+(49572.0*p10*p112*p20*p21)+(107406.0*p10*p202*p21)+(-429624.0*p11*p202*p21)+(49572.0*p10*p11*p202*p21)+(99144.0*p112*p202*p21)+(-20412.0*p10*p112*p202*p21)+(66096.0*p11*p203*p21)+(-15309.0*p112*p203*p21)+(-787644.0*p10*p212)+(358020.0*p102*p212)+(-49572.0*p103*p212)+(179010.0*p10*p11*p212)+(-99144.0*p102*p11*p212)+(15309.0*p103*p11*p212)+(429624.0*p10*p20*p212)+(-99144.0*p102*p20*p212)+(-107406.0*p11*p20*p212)+(-49572.0*p10*p11*p20*p212)+(20412.0*p102*p11*p20*p212)+(-66096.0*p10*p202*p212)+(66096.0*p11*p202*p212)+(-10935.0*p11*p203*p212)+(107406.0*p10*p213)+(-49572.0*p102*p213)+(6804.0*p103*p213)+(-66096.0*p10*p20*p213)+(15309.0*p102*p20*p213)+(10935.0*p10*p202*p213)+(-1837836.0*p11*p30)+(525096.0*p10*p11*p30)+(-59670.0*p102*p11*p30)+(525096.0*p112*p30)+(-238680.0*p10*p112*p30)+(33048.0*p102*p112*p30)+(-59670.0*p113*p30)+(33048.0*p10*p113*p30)+(-5103.0*p102*p113*p30)+(1312740.0*p11*p20*p30)+(-214812.0*p10*p11*p20*p30)+(-429624.0*p112*p20*p30)+(99144.0*p10*p112*p20*p30)+(49572.0*p113*p20*p30)+(-13608.0*p10*p113*p20*p30)+(-250614.0*p11*p202*p30)+(88128.0*p112*p202*p30)+(-10206.0*p113*p202*p30)+(-3675672.0*p21*p30)+(35802.0*p102*p21*p30)+(1312740.0*p11*p21*p30)+(-286416.0*p10*p11*p21*p30)+(16524.0*p102*p11*p21*p30)+(-179010.0*p112*p21*p30)+(66096.0*p10*p112*p21*p30)+(-6804.0*p102*p112*p21*p30)+(1312740.0*p20*p21*p30)+(-1002456.0*p11*p20*p21*p30)+(132192.0*p10*p11*p20*p21*p30)+(154224.0*p112*p20*p21*p30)+(-30618.0*p10*p112*p20*p21*p30)+(-167076.0*p202*p21*p30)+(198288.0*p11*p202*p21*p30)+(-32805.0*p112*p202*p21*p30)+(1312740.0*p212*p30)+(-22032.0*p102*p212*p30)+(-250614.0*p11*p212*p30)+(44064.0*p10*p11*p212*p30)+(-668304.0*p20*p212*p30)+(198288.0*p11*p20*p212*p30)+(-21870.0*p10*p11*p20*p212*p30)+(99144.0*p202*p212*p30)+(-40095.0*p11*p202*p212*p30)+(-167076.0*p213*p30)+(3645.0*p102*p213*p30)+(99144.0*p20*p213*p30)+(-16038.0*p202*p213*p30)+(875160.0*p11*p302)+(-83538.0*p10*p11*p302)+(-167076.0*p112*p302)+(29376.0*p10*p112*p302)+(14688.0*p113*p302)+(-3402.0*p10*p113*p302)+(-278460.0*p11*p20*p302)+(66096.0*p112*p20*p302)+(-6075.0*p113*p20*p302)+(3063060.0*p21*p302)+(-55692.0*p10*p21*p302)+(-668304.0*p11*p21*p302)+(66096.0*p10*p11*p21*p302)+(66096.0*p112*p21*p302)+(-10935.0*p10*p112*p21*p302)+(-501228.0*p20*p21*p302)+(231336.0*p11*p20*p21*p302)+(-26730.0*p112*p20*p21*p302)+(-1002456.0*p212*p302)+(33048.0*p10*p212*p302)+(132192.0*p11*p212*p302)+(-13365.0*p10*p11*p212*p302)+(242352.0*p20*p212*p302)+(-48114.0*p11*p20*p212*p302)+(121176.0*p213*p302)+(-5346.0*p10*p213*p302)+(-34749.0*p20*p213*p302)+(-167076.0*p11*p303)+(22032.0*p112*p303)+(-1485.0*p113*p303)+(-835380.0*p21*p303)+(121176.0*p11*p21*p303)+(-8910.0*p112*p21*p303)+(242352.0*p212*p303)+(-23166.0*p11*p212*p303)+(-27027.0*p213*p303)+(-1.0*p013*((27027.0*p103)+(1485.0*p203)+(594.0*p102*(-408.0+(39.0*p20)+(5.0*p30)))+(27.0*p202*(-816.0+(35.0*p30)))+(36.0*p20*(4641.0+(-204.0*p30)+(7.0*p302)))+(4.0*p30*(4641.0+(-204.0*p30)+(7.0*p302)))+(9.0*p10*(92820.0+(990.0*p202)+(-1632.0*p30)+(35.0*p302)+(66.0*p20*(-204.0+(5.0*p30)))))))+(1837836.0*p10*p31)+(-525096.0*p102*p31)+(59670.0*p103*p31)+(-525096.0*p10*p11*p31)+(238680.0*p102*p11*p31)+(-33048.0*p103*p11*p31)+(59670.0*p10*p112*p31)+(-33048.0*p102*p112*p31)+(5103.0*p103*p112*p31)+(3675672.0*p20*p31)+(-1312740.0*p10*p20*p31)+(179010.0*p102*p20*p31)+(286416.0*p10*p11*p20*p31)+(-66096.0*p102*p11*p20*p31)+(-35802.0*p112*p20*p31)+(-16524.0*p10*p112*p20*p31)+(6804.0*p102*p112*p20*p31)+(-1312740.0*p202*p31)+(250614.0*p10*p202*p31)+(-44064.0*p10*p11*p202*p31)+(22032.0*p112*p202*p31)+(167076.0*p203*p31)+(-3645.0*p112*p203*p31)+(-1312740.0*p10*p21*p31)+(429624.0*p102*p21*p31)+(-49572.0*p103*p21*p31)+(214812.0*p10*p11*p21*p31)+(-99144.0*p102*p11*p21*p31)+(13608.0*p103*p11*p21*p31)+(-1312740.0*p20*p21*p31)+(1002456.0*p10*p20*p21*p31)+(-154224.0*p102*p20*p21*p31)+(-132192.0*p10*p11*p20*p21*p31)+(30618.0*p102*p11*p20*p21*p31)+(668304.0*p202*p21*p31)+(-198288.0*p10*p202*p21*p31)+(21870.0*p10*p11*p202*p21*p31)+(-99144.0*p203*p21*p31)+(250614.0*p10*p212*p31)+(-88128.0*p102*p212*p31)+(10206.0*p103*p212*p31)+(167076.0*p20*p212*p31)+(-198288.0*p10*p20*p212*p31)+(32805.0*p102*p20*p212*p31)+(-99144.0*p202*p212*p31)+(40095.0*p10*p202*p212*p31)+(16038.0*p203*p212*p31)+(6126120.0*p30*p31)+(-875160.0*p10*p30*p31)+(83538.0*p102*p30*p31)+(875160.0*p11*p30*p31)+(-14688.0*p102*p11*p30*p31)+(-83538.0*p112*p30*p31)+(14688.0*p10*p112*p30*p31)+(-3063060.0*p20*p30*p31)+(334152.0*p10*p20*p30*p31)+(-445536.0*p11*p20*p30*p31)+(66096.0*p112*p20*p30*p31)+(-7290.0*p10*p112*p20*p30*p31)+(501228.0*p202*p30*p31)+(66096.0*p11*p202*p30*p31)+(-13365.0*p112*p202*p30*p31)+(3063060.0*p21*p30*p31)+(445536.0*p10*p21*p30*p31)+(-66096.0*p102*p21*p30*p31)+(-334152.0*p11*p21*p30*p31)+(7290.0*p102*p11*p21*p30*p31)+(-198288.0*p10*p20*p21*p30*p31)+(198288.0*p11*p20*p21*p30*p31)+(-121176.0*p202*p21*p30*p31)+(-32076.0*p11*p202*p21*p30*p31)+(-501228.0*p212*p30*p31)+(-66096.0*p10*p212*p30*p31)+(13365.0*p102*p212*p30*p31)+(121176.0*p20*p212*p30*p31)+(32076.0*p10*p20*p212*p30*p31)+(-4084080.0*p302*p31)+(167076.0*p10*p302*p31)+(-668304.0*p11*p302*p31)+(22032.0*p10*p11*p302*p31)+(44064.0*p112*p302*p31)+(-4455.0*p10*p112*p302*p31)+(835380.0*p20*p302*p31)+(161568.0*p11*p20*p302*p31)+(-16038.0*p112*p20*p302*p31)+(-3341520.0*p21*p302*p31)+(-40392.0*p10*p21*p302*p31)+(242352.0*p11*p21*p302*p31)+(-10692.0*p10*p11*p21*p302*p31)+(242352.0*p20*p21*p302*p31)+(-69498.0*p11*p20*p21*p302*p31)+(484704.0*p212*p302*p31)+(-81081.0*p20*p212*p302*p31)+(1021020.0*p303*p31)+(161568.0*p11*p303*p31)+(-7722.0*p112*p303*p31)+(1050192.0*p21*p303*p31)+(-54054.0*p11*p21*p303*p31)+(-135135.0*p212*p303*p31)+(-875160.0*p10*p312)+(167076.0*p102*p312)+(-14688.0*p103*p312)+(83538.0*p10*p11*p312)+(-29376.0*p102*p11*p312)+(3402.0*p103*p11*p312)+(-3063060.0*p20*p312)+(668304.0*p10*p20*p312)+(-66096.0*p102*p20*p312)+(55692.0*p11*p20*p312)+(-66096.0*p10*p11*p20*p312)+(10935.0*p102*p11*p20*p312)+(1002456.0*p202*p312)+(-132192.0*p10*p202*p312)+(-33048.0*p11*p202*p312)+(13365.0*p10*p11*p202*p312)+(-121176.0*p203*p312)+(5346.0*p11*p203*p312)+(278460.0*p10*p21*p312)+(-66096.0*p102*p21*p312)+(6075.0*p103*p21*p312)+(501228.0*p20*p21*p312)+(-231336.0*p10*p20*p21*p312)+(26730.0*p102*p20*p21*p312)+(-242352.0*p202*p21*p312)+(48114.0*p10*p202*p21*p312)+(34749.0*p203*p21*p312)+(-8168160.0*p30*p312)+(668304.0*p10*p30*p312)+(-44064.0*p102*p30*p312)+(-167076.0*p11*p30*p312)+(-22032.0*p10*p11*p30*p312)+(4455.0*p102*p11*p30*p312)+(3341520.0*p20*p30*p312)+(-242352.0*p10*p20*p30*p312)+(40392.0*p11*p20*p30*p312)+(10692.0*p10*p11*p20*p30*p312)+(-484704.0*p202*p30*p312)+(-835380.0*p21*p30*p312)+(-161568.0*p10*p21*p30*p312)+(16038.0*p102*p21*p30*p312)+(-242352.0*p20*p21*p30*p312)+(69498.0*p10*p20*p21*p30*p312)+(81081.0*p202*p21*p30*p312)+(6126120.0*p302*p312)+(-161568.0*p10*p302*p312)+(161568.0*p11*p302*p312)+(-1050192.0*p20*p302*p312)+(-27027.0*p11*p20*p302*p312)+(1050192.0*p21*p302*p312)+(27027.0*p10*p21*p302*p312)+(-1633632.0*p303*p312)+(-45045.0*p11*p303*p312)+(-360360.0*p21*p303*p312)+(167076.0*p10*p313)+(-22032.0*p102*p313)+(1485.0*p103*p313)+(835380.0*p20*p313)+(-121176.0*p10*p20*p313)+(8910.0*p102*p20*p313)+(-242352.0*p202*p313)+(23166.0*p10*p202*p313)+(27027.0*p203*p313)+(3063060.0*p30*p313)+(-161568.0*p10*p30*p313)+(7722.0*p102*p30*p313)+(-1050192.0*p20*p30*p313)+(54054.0*p10*p20*p30*p313)+(135135.0*p202*p30*p313)+(-2450448.0*p302*p313)+(45045.0*p10*p302*p313)+(360360.0*p20*p302*p313)+(680680.0*p303*p313)+(p003*((-680680.0*p013)+(27027.0*p113)+(167076.0*p21)+(-22032.0*p212)+(1485.0*p213)+(18564.0*p31)+(-7344.0*p21*p31)+(945.0*p212*p31)+(-816.0*p312)+(252.0*p21*p312)+(28.0*p313)+(3003.0*p012*(544.0+(120.0*p11)+(15.0*p21)+p31))+(594.0*p112*(-408.0+(39.0*p21)+(5.0*p31)))+(33.0*p01*(-30940.0+(4095.0*p112)+(-4896.0*p21)+(234.0*p212)+(-408.0*p31)+(60.0*p21*p31)+(5.0*p312)+(78.0*p11*(-408.0+(21.0*p21)+(2.0*p31)))))+(9.0*p11*(92820.0+(990.0*p212)+(-1632.0*p31)+(35.0*p312)+(66.0*p21*(-204.0+(5.0*p31)))))))+(-3.0*p012*((297.0*p103*(-136.0+(39.0*p11)+(6.0*p21)))+(9.0*p203*(-544.0+(225.0*p11)+(126.0*p21)+(28.0*p31)))+(p30*(-48620.0+(4420.0*p30)+(-272.0*p302)+(21.0*p21*(442.0+(-68.0*p30)+(5.0*p302)))+(12.0*p11*(1547.0+(-136.0*p30)+(7.0*p302)))+(2210.0*p31)+(-544.0*p30*p31)+(55.0*p302*p31)))+(3.0*p20*(-97240.0+(8840.0*p30)+(-544.0*p302)+(4.0*p11*(7735.0+(-884.0*p30)+(49.0*p302)))+(3.0*p21*(3094.0+(-748.0*p30)+(63.0*p302)))+(1326.0*p31)+(-612.0*p30*p31)+(75.0*p302*p31)))+(27.0*p102*(12376.0+(-408.0*p21)+(-272.0*p30)+(45.0*p21*p30)+(22.0*p11*(-136.0+(27.0*p20)+(5.0*p30)))+(7.0*p30*p31)+(3.0*p20*(-544.0+(55.0*p21)+(5.0*p31)))))+(9.0*p202*((9.0*p11*(-272.0+(21.0*p30)))+(2.0*(3094.0+(-238.0*p30)+(p21*(-544.0+(70.0*p30)))+(-102.0*p31)+(21.0*p30*p31)))))+(3.0*p10*((9.0*p11*(6188.0+(330.0*p202)+(-544.0*p30)+(21.0*p302)+(6.0*p20*(-476.0+(25.0*p30)))))+(27.0*p202*(-272.0+(45.0*p21)+(7.0*p31)))+(2.0*(-170170.0+(2.0*p21*(1547.0+(-544.0*p30)+(35.0*p302)))+(-68.0*p30*(-91.0+(3.0*p31)))+(7.0*p302*(-34.0+(3.0*p31)))))+(12.0*p20*((9.0*p21*(-68.0+(7.0*p30)))+(-68.0*(-91.0+p31))+(2.0*p30*(-136.0+(7.0*p31)))))))))+(-3.0*p002*((-297.0*p113*(-136.0+(39.0*p10)+(6.0*p20)))+(291720.0*p21)+(-92820.0*p10*p21)+(-27846.0*p20*p21)+(-55692.0*p212)+(22032.0*p10*p212)+(9792.0*p20*p212)+(4896.0*p213)+(-2025.0*p10*p213)+(-1134.0*p20*p213)+(-3978.0*p21*p30)+(1836.0*p212*p30)+(-252.0*p213*p30)+(1001.0*p013*(-816.0+(120.0*p10)+(15.0*p20)+p30))+(48620.0*p31)+(-18564.0*p10*p31)+(-9282.0*p20*p31)+(-26520.0*p21*p31)+(10608.0*p10*p21*p31)+(6732.0*p20*p21*p31)+(4284.0*p212*p31)+(-1701.0*p10*p212*p31)+(-1260.0*p20*p212*p31)+(-2210.0*p30*p31)+(1836.0*p21*p30*p31)+(-378.0*p212*p30*p31)+(-4420.0*p312)+(1632.0*p10*p312)+(1428.0*p20*p312)+(1632.0*p21*p312)+(-588.0*p10*p21*p312)+(-567.0*p20*p21*p312)+(544.0*p30*p312)+(-225.0*p21*p30*p312)+(272.0*p313)+(-84.0*p10*p313)+(-105.0*p20*p313)+(-55.0*p30*p313)+(-27.0*p112*(12376.0+(-1632.0*p21)+(15.0*p21*p30)+(-272.0*p31)+(7.0*p30*p31)+(22.0*p10*(-136.0+(27.0*p21)+(5.0*p31)))+(3.0*p20*(-136.0+(55.0*p21)+(15.0*p31)))))+(-33.0*p012*((-39.0*p11*(272.0+(7.0*p20)+p30))+(39.0*p10*(272.0+(7.0*p21)+p31))+(-2.0*((3.0*p21*(272.0+p30))+(-68.0*(-455.0+p30+(-1.0*p31)))+(-3.0*p20*(272.0+p31))))))+(-1.0*p01*(1361360.0+(-55692.0*p20)+(222768.0*p21)+(-7344.0*p20*p21)+(-14688.0*p212)+(1485.0*p20*p212)+(-6188.0*p30)+(135.0*p212*p30)+(-594.0*p112*(272.0+p30))+(24752.0*p31)+(-2448.0*p20*p31)+(-4896.0*p21*p31)+(810.0*p20*p21*p31)+(-272.0*p30*p31)+(126.0*p21*p30*p31)+(-544.0*p312)+(126.0*p20*p312)+(28.0*p30*p312)+(18.0*p11*(61880.0+(-4488.0*p21)+(204.0*p30)+(-544.0*p31)+(5.0*p30*p31)+(11.0*p20*(68.0+(18.0*p21)+(5.0*p31)))))+(9.0*p10*(-30940.0+(3003.0*p112)+(594.0*p212)+(-952.0*p31)+(25.0*p312)+(44.0*p21*(-136.0+(5.0*p31)))+(66.0*p11*(-136.0+(39.0*p21)+(6.0*p31)))))))+(-3.0*p11*(-340340.0+(74256.0*p21)+(-7344.0*p212)+(-816.0*p21*p30)+(189.0*p212*p30)+(12376.0*p31)+(-3264.0*p21*p31)+(-408.0*p30*p31)+(168.0*p21*p30*p31)+(-476.0*p312)+(42.0*p30*p312)+(p20*(6188.0+(-7344.0*p21)+(1215.0*p212)+(-2176.0*p31)+(756.0*p21*p31)+(140.0*p312)))+(9.0*p10*(6188.0+(330.0*p212)+(-544.0*p31)+(21.0*p312)+(6.0*p21*(-476.0+(25.0*p31)))))))))+(-3.0*p00*((-612612.0*p21)+(437580.0*p10*p21)+(-83538.0*p102*p21)+(175032.0*p20*p21)+(-71604.0*p10*p20*p21)+(-19890.0*p202*p21)+(175032.0*p212)+(-143208.0*p10*p212)+(29376.0*p102*p212)+(-79560.0*p20*p212)+(33048.0*p10*p20*p212)+(11016.0*p202*p212)+(-19890.0*p213)+(16524.0*p10*p213)+(-3402.0*p102*p213)+(11016.0*p20*p213)+(-4536.0*p10*p20*p213)+(-1701.0*p202*p213)+(29172.0*p21*p30)+(-13260.0*p10*p21*p30)+(-7956.0*p20*p21*p30)+(-15912.0*p212*p30)+(7344.0*p10*p212*p30)+(4896.0*p20*p212*p30)+(2448.0*p213*p30)+(-1134.0*p10*p213*p30)+(-810.0*p20*p213*p30)+(11.0*p013*(92820.0+(4095.0*p102)+(234.0*p202)+(-408.0*p30)+(5.0*p302)+(78.0*p10*(-408.0+(21.0*p20)+(2.0*p30)))+(12.0*p20*(-408.0+(5.0*p30)))))+(-9.0*p113*(6188.0+(594.0*p102)+(-135.0*p202)+(272.0*p30)+(-126.0*p20*p30)+(-28.0*p302)+(-18.0*p10*(204.0+(5.0*p30)))))+(-204204.0*p31)+(145860.0*p10*p31)+(-27846.0*p102*p31)+(116688.0*p20*p31)+(-39780.0*p10*p20*p31)+(-19890.0*p202*p31)+(145860.0*p21*p31)+(-106080.0*p10*p21*p31)+(20196.0*p102*p21*p31)+(-95472.0*p20*p21*p31)+(33048.0*p10*p20*p21*p31)+(17136.0*p202*p21*p31)+(-27846.0*p212*p31)+(20196.0*p10*p212*p31)+(-3780.0*p102*p212*p31)+(19584.0*p20*p212*p31)+(-6804.0*p10*p20*p212*p31)+(-3645.0*p202*p212*p31)+(48620.0*p30*p31)+(-13260.0*p10*p30*p31)+(-18564.0*p20*p30*p31)+(-37128.0*p21*p30*p31)+(11424.0*p10*p21*p30*p31)+(14688.0*p20*p21*p30*p31)+(7344.0*p212*p30*p31)+(-2430.0*p10*p212*p30*p31)+(-2970.0*p20*p212*p30*p31)+(-6188.0*p302*p31)+(3672.0*p21*p302*p31)+(-594.0*p212*p302*p31)+(48620.0*p312)+(-26520.0*p10*p312)+(4284.0*p102*p312)+(-37128.0*p20*p312)+(9792.0*p10*p20*p312)+(7344.0*p202*p312)+(-18564.0*p21*p312)+(10608.0*p10*p21*p312)+(-1701.0*p102*p21*p312)+(14688.0*p20*p21*p312)+(-4050.0*p10*p20*p21*p312)+(-2970.0*p202*p21*p312)+(-24752.0*p30*p312)+(4896.0*p10*p30*p312)+(9792.0*p20*p30*p312)+(8568.0*p21*p30*p312)+(-1980.0*p10*p21*p30*p312)+(-3564.0*p20*p21*p30*p312)+(4488.0*p302*p312)+(-1287.0*p21*p302*p312)+(-6188.0*p313)+(2448.0*p10*p313)+(-315.0*p102*p313)+(4896.0*p20*p313)+(-990.0*p10*p20*p313)+(-990.0*p202*p313)+(4488.0*p30*p313)+(-660.0*p10*p30*p313)+(-1716.0*p20*p30*p313)+(-1001.0*p302*p313)+(-9.0*p112*(-48620.0+(9282.0*p21)+(-1768.0*p30)+(204.0*p21*p30)+(204.0*p302)+(-63.0*p21*p302)+(2210.0*p31)+(-68.0*p30*p31)+(-15.0*p302*p31)+(12.0*p202*(68.0+(7.0*p31)))+(27.0*p102*(-136.0+(55.0*p21)+(15.0*p31)))+(-24.0*p20*((68.0*p21)+(-34.0*p30)+(7.0*p21*p30)+(34.0*p31)))+(2.0*p10*(12376.0+(27.0*(-136.0+(15.0*p20))*p21)+(272.0*p30)+(-952.0*p31)+(189.0*p20*p31)+(28.0*p30*p31)))))+(p012*(-2722720.0+(222768.0*p20)+(-14688.0*p202)+(-55692.0*p21)+(-7344.0*p20*p21)+(1485.0*p202*p21)+(24752.0*p30)+(-4896.0*p20*p30)+(-2448.0*p21*p30)+(810.0*p20*p21*p30)+(-544.0*p302)+(126.0*p21*p302)+(9.0*p11*(-30940.0+(594.0*p202)+(-952.0*p30)+(25.0*p302)+(44.0*p20*(-136.0+(5.0*p30)))))+(-6188.0*p31)+(135.0*p202*p31)+(-272.0*p30*p31)+(126.0*p20*p30*p31)+(28.0*p302*p31)+(18.0*p10*(61880.0+(748.0*p21)+(66.0*p20*(-68.0+(3.0*p21)))+(-544.0*p30)+(55.0*p21*p30)+(33.0*p11*(-136.0+(39.0*p20)+(6.0*p30)))+(204.0*p31)+(5.0*p30*p31)))+(297.0*p102*((91.0*p11)+(-2.0*(272.0+p31))))))+(p01*(2042040.0+(-291720.0*p20)+(27846.0*p202)+(291720.0*p21)+(-4896.0*p202*p21)+(-27846.0*p212)+(4896.0*p20*p212)+(-48620.0*p30)+(13260.0*p20*p30)+(10608.0*p21*p30)+(-4896.0*p20*p21*p30)+(-612.0*p212*p30)+(504.0*p20*p212*p30)+(2210.0*p302)+(-1224.0*p21*p302)+(189.0*p212*p302)+(27.0*p112*(-6188.0+(165.0*p202)+(-272.0*p30)+(14.0*p302)+(p20*(-816.0+(90.0*p30)))))+(48620.0*p31)+(-10608.0*p20*p31)+(612.0*p202*p31)+(-13260.0*p21*p31)+(4896.0*p20*p21*p31)+(-504.0*p202*p21*p31)+(-408.0*p20*p30*p31)+(408.0*p21*p30*p31)+(-272.0*p302*p31)+(90.0*p21*p302*p31)+(-2210.0*p312)+(1224.0*p20*p312)+(-189.0*p202*p312)+(272.0*p30*p312)+(-90.0*p20*p30*p312)+(-27.0*p102*(-6188.0+(165.0*p212)+(-272.0*p31)+(14.0*p312)+(22.0*p11*(68.0+(18.0*p21)+(5.0*p31)))+(p21*(-816.0+(90.0*p31)))))+(6.0*p11*(170170.0+(27.0*p202*(-136.0+(15.0*p21)))+(6188.0*p30)+(-306.0*p302)+(12.0*p21*(-1547.0+(-68.0*p30)+(7.0*p302)))+(-3094.0*p31)+(-68.0*p30*p31)+(21.0*p302*p31)+(2.0*p20*((136.0*(91.0+(2.0*p31)))+(7.0*p30*(-136.0+(27.0*p21)+(4.0*p31)))))))+(6.0*p10*(-170170.0+(-24752.0*p21)+(3672.0*p212)+(3094.0*p30)+(-544.0*p21*p30)+(99.0*p112*(68.0+(18.0*p20)+(5.0*p30)))+(-6188.0*p31)+(1904.0*p21*p31)+(68.0*p30*p31)+(-56.0*p21*p30*p31)+(306.0*p312)+(-21.0*p30*p312)+(-3.0*p20*(-6188.0+(135.0*p212)+(-272.0*p31)+(126.0*p21*p31)+(28.0*p312)))+(18.0*p11*((612.0*p21)+(-136.0*p30)+(15.0*p21*p30)+(136.0*p31)+(-3.0*p20*(204.0+(5.0*p31)))))))))+(-3.0*p11*(408408.0+(-145860.0*p21)+(19890.0*p212)+(9724.0*p30)+(-612.0*p212*p30)+(-1326.0*p302)+(816.0*p21*p302)+(-135.0*p212*p302)+(-38896.0*p31)+(13260.0*p21*p31)+(3536.0*p30*p31)+(-1632.0*p21*p30*p31)+(3094.0*p312)+(-816.0*p30*p312)+(66.0*p302*p312)+(9.0*p202*(-442.0+(84.0*p212)+(-272.0*p31)+(45.0*p312)+(6.0*p21*(-34.0+(21.0*p31)))))+(3.0*p102*((1215.0*p212)+(108.0*p21*(-68.0+(7.0*p31)))+(4.0*(1547.0+(-544.0*p31)+(35.0*p312)))))+(-2.0*p20*((3672.0*p212)+(136.0*p31*(-65.0+(8.0*p31)))+(p30*(2210.0+(544.0*p31)+(-165.0*p312)))+(-18.0*p21*(884.0+(-204.0*p31)+(p30*(34.0+(15.0*p31)))))))+(6.0*p10*((21.0*p212*((27.0*p20)+(4.0*(-34.0+p30))))+(p30*(-442.0+(-272.0*p31)+(45.0*p312)))+(2.0*(-12155.0+(-204.0*(-13.0+(3.0*p20))*p31)+((-187.0+(63.0*p20))*p312)))+(6.0*p21*((34.0*(91.0+(-9.0*p31)))+(12.0*p20*(-34.0+(7.0*p31)))+(p30*(-34.0+(21.0*p31)))))))))))+(-3.0*p01*((9.0*p103*(6188.0+(594.0*p112)+(-135.0*p212)+(272.0*p31)+(-126.0*p21*p31)+(-28.0*p312)+(-18.0*p11*(204.0+(5.0*p31)))))+(9.0*p203*((378.0*p112)+(189.0*p212)+(34.0*(65.0+(-8.0*p31)))+(18.0*p21*(-68.0+(5.0*p31)))+(18.0*p11*(-102.0+(28.0*p21)+(7.0*p31)))))+(9.0*p102*(-48620.0+(816.0*p212)+(2210.0*p30)+(-816.0*p21*p30)+(84.0*p212*p30)+(27.0*p112*(-136.0+(55.0*p20)+(15.0*p30)))+(-1768.0*p31)+(816.0*p21*p31)+(-68.0*p30*p31)+(204.0*p312)+(-15.0*p30*p312)+(2.0*p11*((27.0*p20*(-136.0+(15.0*p21)))+(136.0*(91.0+(2.0*p31)))+(7.0*p30*(-136.0+(27.0*p21)+(4.0*p31)))))+(-3.0*p20*(-3094.0+(-68.0*p31)+(21.0*p312)+(8.0*p21*(68.0+(7.0*p31)))))))+(p30*(204204.0+(-48620.0*p30)+(6188.0*p302)+(63.0*p112*(442.0+(-68.0*p30)+(5.0*p302)))+(18.0*p212*(1105.0+(-408.0*p30)+(55.0*p302)))+(-48620.0*p31)+(24752.0*p30*p31)+(-4488.0*p302*p31)+(6188.0*p312)+(-4488.0*p30*p312)+(1001.0*p302*p312)+(6.0*p11*((3.0*p21*(2210.0+(-544.0*p30)+(55.0*p302)))+(2210.0*(-11.0+p31))+(-68.0*p30*(-65.0+(12.0*p31)))+(2.0*p302*(-204.0+(55.0*p31)))))+(12.0*p21*((221.0*(-44.0+(7.0*p31)))+(-34.0*p30*(-91.0+(24.0*p31)))+(p302*(-408.0+(143.0*p31)))))))+(9.0*p202*((12.0*p112*(-272.0+(35.0*p30)))+(9.0*p212*(-136.0+(45.0*p30)))+(6.0*p11*(2652.0+(-374.0*p30)+(18.0*p21*(-34.0+(7.0*p30)))+(-136.0*p31)+(45.0*p30*p31)))+(p21*(8840.0+(-544.0*p31)+(p30*(-2176.0+(330.0*p31)))))+(2.0*((884.0*(-11.0+p31))+(p30*(1547.0+(-408.0*p31)+(33.0*p312)))))))+(3.0*p10*(408408.0+(-3978.0*p212)+(-38896.0*p30)+(17680.0*p21*p30)+(-2448.0*p212*p30)+(3094.0*p302)+(-2176.0*p21*p302)+(405.0*p212*p302)+(3.0*p112*((1215.0*p202)+(108.0*p20*(-68.0+(7.0*p30)))+(4.0*(1547.0+(-544.0*p30)+(35.0*p302)))))+(9724.0*p31)+(-4420.0*p21*p31)+(3536.0*p30*p31)+(-1088.0*p21*p30*p31)+(-816.0*p302*p31)+(330.0*p21*p302*p31)+(-1326.0*p312)+(66.0*p302*p312)+(9.0*p202*(2210.0+(-816.0*p21)+(84.0*p212)+(-68.0*p31)+(-15.0*p312)))+(6.0*p11*((21.0*p202*((27.0*p21)+(4.0*(-34.0+p31))))+(-442.0*(55.0+p31))+(-136.0*p30*(-39.0+(9.0*p21)+(2.0*p31)))+(p302*(-374.0+(126.0*p21)+(45.0*p31)))+(6.0*p20*(3094.0+(-306.0*p30)+(12.0*p21*(-34.0+(7.0*p30)))+(-34.0*p31)+(21.0*p30*p31)))))+(6.0*p20*((9.0*p212*(-34.0+(21.0*p30)))+(34.0*(-715.0+(p30*(65.0+(-8.0*p31)))+(4.0*p312)))+(6.0*p21*((34.0*(26.0+p31))+(3.0*p30*(-68.0+(5.0*p31)))))))))+(3.0*p20*(204204.0+(-48620.0*p30)+(6188.0*p302)+(9.0*p112*(3094.0+(-748.0*p30)+(63.0*p302)))+(6.0*p212*(1105.0+(-952.0*p30)+(165.0*p302)))+(-9724.0*p31)+(12376.0*p30*p31)+(-2856.0*p302*p31)+(-1224.0*p30*p312)+(429.0*p302*p312)+(12.0*p21*((221.0*(-22.0+p31))+(-204.0*p30*(-13.0+(2.0*p31)))+(p302*(-408.0+(99.0*p31)))))+(2.0*p11*((27.0*p21*(442.0+(-204.0*p30)+(25.0*p302)))+(2.0*((1105.0*(-33.0+p31))+(-136.0*p30*(-65.0+(7.0*p31)))+(p302*(-884.0+(165.0*p31)))))))))))));
	*accum = ((1.0/36.0)*((-3.0*p01)+(3.0*p012)+(-1.0*p013)+(p31*(3.0+(-3.0*p31)+p312))));
}


//=============================================================================//
//=========================== Rational Quadratics =============================//
//=============================================================================//

static void rquad(double *pixel, double *accum, Curve<3,3> *curve)
{
}

//=============================================================================//
//============================== Constructors =================================//
//=============================================================================//

template<>
FilterBspline2<1>::FilterBspline2()
{
	filter22[filter_elem_flip<W>(0,0)] = line_00;
	filter22[filter_elem_flip<W>(1,0)] = line_10;
	filter22[filter_elem_flip<W>(2,0)] = line_20;
	filter22[filter_elem_flip<W>(0,1)] = line_01;
	filter22[filter_elem_flip<W>(1,1)] = line_11;
	filter22[filter_elem_flip<W>(2,1)] = line_21;
	filter22[filter_elem_flip<W>(0,2)] = line_02;
	filter22[filter_elem_flip<W>(1,2)] = line_12;
	filter22[filter_elem_flip<W>(2,2)] = line_22;

	filter32[filter_elem_flip<W>(0,0)] = quad_00;
	filter32[filter_elem_flip<W>(1,0)] = quad_10;
	filter32[filter_elem_flip<W>(2,0)] = quad_20;
	filter32[filter_elem_flip<W>(0,1)] = quad_01;
	filter32[filter_elem_flip<W>(1,1)] = quad_11;
	filter32[filter_elem_flip<W>(2,1)] = quad_21;
	filter32[filter_elem_flip<W>(0,2)] = quad_02;
	filter32[filter_elem_flip<W>(1,2)] = quad_12;
	filter32[filter_elem_flip<W>(2,2)] = quad_22;

	filter42[filter_elem_flip<W>(0,0)] = cube_00;
	filter42[filter_elem_flip<W>(1,0)] = cube_10;
	filter42[filter_elem_flip<W>(2,0)] = cube_20;
	filter42[filter_elem_flip<W>(0,1)] = cube_01;
	filter42[filter_elem_flip<W>(1,1)] = cube_11;
	filter42[filter_elem_flip<W>(2,1)] = cube_21;
	filter42[filter_elem_flip<W>(0,2)] = cube_02;
	filter42[filter_elem_flip<W>(1,2)] = cube_12;
	filter42[filter_elem_flip<W>(2,2)] = cube_22;

	filter33[filter_elem_flip<W>(0,0)] = rquad;
	filter33[filter_elem_flip<W>(1,0)] = rquad;
	filter33[filter_elem_flip<W>(2,0)] = rquad;
	filter33[filter_elem_flip<W>(0,1)] = rquad;
	filter33[filter_elem_flip<W>(1,1)] = rquad;
	filter33[filter_elem_flip<W>(2,1)] = rquad;
	filter33[filter_elem_flip<W>(0,2)] = rquad;
	filter33[filter_elem_flip<W>(1,2)] = rquad;
	filter33[filter_elem_flip<W>(2,2)] = rquad;
}
