#include "filter_tent.h"

//=============================================================================//
//================================= Lines =====================================//
//=============================================================================//

static void line_00(double *pixel, double *accum, Curve<2,2> *curve)
{
	const double &p00 = curve->p[0].v[0];
	const double &p01 = curve->p[0].v[1];
	const double &p10 = curve->p[1].v[0];
	const double &p11 = curve->p[1].v[1];
	const double p002 = p00*p00;
	const double p012 = p01*p01;
	const double p102 = p10*p10;
	const double p112 = p11*p11;
	const double p003 = p00*p002;
	const double p013 = p01*p012;
	const double p103 = p10*p102;
	const double p113 = p11*p112;
	pixel[0] = ((1.0/24.0)*((-1.0*p01)+p11)*((2.0*p00*p10*(p01+p11))+(p002*((3.0*p01)+p11))+(p102*(p01+(3.0*p11)))));
	accum[0] = ((-1.0/4.0)*(p01+(-1.0*p11))*(p01+p11));
	accum[1] = 0.0;
	pixel[1] = ((1.0/60.0)*((-1.0*p01)+p11)*((p003*((4.0*p01)+p11))+(p002*p10*((3.0*p01)+(2.0*p11)))+(p00*p102*((2.0*p01)+(3.0*p11)))+(p103*(p01+(4.0*p11)))));
	accum[2] = ((1.0/12.0)*(p012+(-1.0*p112)));
	accum[3] = ((1.0/4.0)*((-1.0*p012)+p112));
	pixel[2] = ((1.0/60.0)*((-1.0*p01)+p11)*((p002*((6.0*p012)+(3.0*p01*p11)+p112))+(p00*p10*((3.0*p012)+(4.0*p01*p11)+(3.0*p112)))+(p102*(p012+(3.0*p01*p11)+(6.0*p112)))));
	accum[4] = ((1.0/6.0)*((-1.0*p013)+p113));
	accum[5] = 0.0;
}
static void line_10(double *pixel, double *accum, Curve<2,2> *curve)
{
	const double &p00 = curve->p[0].v[0];
	const double &p01 = curve->p[0].v[1];
	const double &p10 = curve->p[1].v[0];
	const double &p11 = curve->p[1].v[1];
	const double p002 = p00*p00;
	const double p012 = p01*p01;
	const double p102 = p10*p10;
	const double p112 = p11*p11;
	const double p003 = p00*p002;
	const double p013 = p01*p012;
	const double p103 = p10*p102;
	const double p113 = p11*p112;
	pixel[0] = ((1.0/24.0)*(p01+(-1.0*p11))*((p002*((3.0*p01)+p11))+(2.0*p00*((p01*(-4.0+p10))+((-2.0+p10)*p11)))+(p10*((p01*(-4.0+p10))+((-8.0+(3.0*p10))*p11)))));
	accum[0] = ((1.0/4.0)*((-1.0*p012)+p112));
	accum[1] = 0.0;
	pixel[1] = ((1.0/120.0)*((-1.0*p01)+p11)*((5.0*((2.0*p00*p10*(p01+p11))+(p002*((3.0*p01)+p11))+(p102*(p01+(3.0*p11)))))+(-2.0*((p003*((4.0*p01)+p11))+(p002*p10*((3.0*p01)+(2.0*p11)))+(p00*p102*((2.0*p01)+(3.0*p11)))+(p103*(p01+(4.0*p11)))))));
	accum[2] = ((1.0/6.0)*(p012+(-1.0*p112)));
	accum[3] = ((1.0/4.0)*((-1.0*p012)+p112));
	pixel[2] = ((1.0/60.0)*(p01+(-1.0*p11))*((p002*((6.0*p012)+(3.0*p01*p11)+p112))+(p10*((p012*(-5.0+p10))+(p01*(-10.0+(3.0*p10))*p11)+(3.0*(-5.0+(2.0*p10))*p112)))+(p00*((3.0*p012*(-5.0+p10))+(2.0*p01*(-5.0+(2.0*p10))*p11)+((-5.0+(3.0*p10))*p112)))));
	accum[4] = ((1.0/6.0)*((-1.0*p013)+p113));
	accum[5] = 0.0;
}
static void line_01(double *pixel, double *accum, Curve<2,2> *curve)
{
	const double &p00 = curve->p[0].v[0];
	const double &p01 = curve->p[0].v[1];
	const double &p10 = curve->p[1].v[0];
	const double &p11 = curve->p[1].v[1];
	const double p002 = p00*p00;
	const double p012 = p01*p01;
	const double p102 = p10*p10;
	const double p112 = p11*p11;
	const double p003 = p00*p002;
	const double p013 = p01*p012;
	const double p103 = p10*p102;
	const double p113 = p11*p112;
	pixel[0] = ((1.0/24.0)*(p01+(-1.0*p11))*((2.0*p00*p10*(-2.0+p01+p11))+(p002*(-4.0+(3.0*p01)+p11))+(p102*(-4.0+p01+(3.0*p11)))));
	accum[0] = ((1.0/4.0)*((-2.0*p01)+p012+(-1.0*(-2.0+p11)*p11)));
	accum[1] = 0.0;
	pixel[1] = ((1.0/60.0)*(p01+(-1.0*p11))*((p003*(-5.0+(4.0*p01)+p11))+(p002*p10*(-5.0+(3.0*p01)+(2.0*p11)))+(p00*p102*(-5.0+(2.0*p01)+(3.0*p11)))+(p103*(-5.0+p01+(4.0*p11)))));
	accum[2] = ((1.0/12.0)*((2.0*p01)+(-1.0*p012)+((-2.0+p11)*p11)));
	accum[3] = ((1.0/4.0)*((-2.0*p01)+p012+(-1.0*(-2.0+p11)*p11)));
	pixel[2] = ((1.0/120.0)*(p01+(-1.0*p11))*((p002*((12.0*p012)+(3.0*p01*(-5.0+(2.0*p11)))+(p11*(-5.0+(2.0*p11)))))+(2.0*p00*p10*((3.0*p012)+(p11*(-5.0+(3.0*p11)))+(p01*(-5.0+(4.0*p11)))))+(p102*((2.0*p012)+(3.0*p11*(-5.0+(4.0*p11)))+(p01*(-5.0+(6.0*p11)))))));
	accum[4] = ((1.0/12.0)*((-3.0*p012)+(2.0*p013)+((3.0+(-2.0*p11))*p112)));
	accum[5] = 0.0;
}
static void line_11(double *pixel, double *accum, Curve<2,2> *curve)
{
	const double &p00 = curve->p[0].v[0];
	const double &p01 = curve->p[0].v[1];
	const double &p10 = curve->p[1].v[0];
	const double &p11 = curve->p[1].v[1];
	const double p002 = p00*p00;
	const double p012 = p01*p01;
	const double p102 = p10*p10;
	const double p112 = p11*p11;
	const double p003 = p00*p002;
	const double p013 = p01*p012;
	const double p103 = p10*p102;
	const double p113 = p11*p112;
	pixel[0] = ((-1.0/24.0)*(p01+(-1.0*p11))*((2.0*p00*(6.0+(p01*(-4.0+p10))+(p10*(-2.0+p11))+(-2.0*p11)))+(p002*(-4.0+(3.0*p01)+p11))+(p10*(12.0+(p01*(-4.0+p10))+(-8.0*p11)+(p10*(-4.0+(3.0*p11)))))));
	accum[0] = ((1.0/4.0)*((-2.0*p01)+p012+(-1.0*(-2.0+p11)*p11)));
	accum[1] = 0.0;
	pixel[1] = ((-1.0/120.0)*(p01+(-1.0*p11))*((2.0*p003*(-5.0+(4.0*p01)+p11))+(2.0*p00*p10*(10.0+(-5.0*p10)+(p01*(-5.0+(2.0*p10)))+(-5.0*p11)+(3.0*p10*p11)))+(p002*(20.0+(-10.0*p10)+(3.0*p01*(-5.0+(2.0*p10)))+(-5.0*p11)+(4.0*p10*p11)))+(p102*(20.0+(-10.0*p10)+(p01*(-5.0+(2.0*p10)))+(-15.0*p11)+(8.0*p10*p11)))));
	accum[2] = ((1.0/6.0)*((2.0*p01)+(-1.0*p012)+((-2.0+p11)*p11)));
	accum[3] = ((1.0/4.0)*((-2.0*p01)+p012+(-1.0*(-2.0+p11)*p11)));
	pixel[2] = ((-1.0/120.0)*(p01+(-1.0*p11))*((p002*((12.0*p012)+(3.0*p01*(-5.0+(2.0*p11)))+(p11*(-5.0+(2.0*p11)))))+(2.0*p00*((3.0*p012*(-5.0+p10))+(p11*(10.0+(-5.0*p10)+(-5.0*p11)+(3.0*p10*p11)))+(p01*(20.0+(-5.0*p10)+(-10.0*p11)+(4.0*p10*p11)))))+(p10*((2.0*p012*(-5.0+p10))+(p01*(20.0+(-5.0*p10)+(-20.0*p11)+(6.0*p10*p11)))+(p11*(40.0+(-30.0*p11)+(3.0*p10*(-5.0+(4.0*p11)))))))));
	accum[4] = ((1.0/12.0)*((-3.0*p012)+(2.0*p013)+((3.0+(-2.0*p11))*p112)));
	accum[5] = 0.0;
}

//=============================================================================//
//=============================== Quadratics ==================================//
//=============================================================================//

static void quad_00(double *pixel, double *accum, Curve<3,2> *curve)
{
	const double &p00 = curve->p[0].v[0];
	const double &p01 = curve->p[0].v[1];
	const double &p10 = curve->p[1].v[0];
	const double &p11 = curve->p[1].v[1];
	const double &p20 = curve->p[2].v[0];
	const double &p21 = curve->p[2].v[1];
	const double p002 = p00*p00;
	const double p012 = p01*p01;
	const double p102 = p10*p10;
	const double p112 = p11*p11;
	const double p202 = p20*p20;
	const double p212 = p21*p21;
	const double p003 = p00*p002;
	const double p013 = p01*p012;
	const double p103 = p10*p102;
	const double p113 = p11*p112;
	const double p203 = p20*p202;
	const double p213 = p21*p212;
	pixel[0] = ((1.0/840.0)*((-16.0*p10*p112*p20)+(-20.0*p112*p202)+(-1.0*p012*((20.0*p102)+(12.0*p10*p20)+(3.0*p202)))+(16.0*p102*p11*p21)+(-60.0*p11*p202*p21)+(20.0*p102*p212)+(60.0*p10*p20*p212)+(105.0*p202*p212)+(p002*((-105.0*p012)+(20.0*p112)+(12.0*p11*p21)+(3.0*p212)+(10.0*p01*((6.0*p11)+p21))))+(-2.0*p01*((8.0*p102*p11)+(4.0*p10*p20*((3.0*p11)+p21))+(p202*((6.0*p11)+(5.0*p21)))))+(2.0*p00*((-5.0*p012*((6.0*p10)+p20))+(p20*p21*((4.0*p11)+(5.0*p21)))+(p01*((-4.0*p11*p20)+(4.0*p10*p21)))+(2.0*p10*((4.0*p112)+(6.0*p11*p21)+(3.0*p212)))))));
	accum[0] = ((1.0/4.0)*((-1.0*p012)+p212));
	accum[1] = 0.0;
	pixel[1] = ((1.0/1260.0)*((-1.0*p012*((8.0*p103)+(8.0*p102*p20)+(4.0*p10*p202)+p203))+(p003*((-84.0*p012)+(14.0*p112)+(6.0*p11*p21)+p212+(7.0*p01*((8.0*p11)+p21))))+(-1.0*p01*((8.0*p103*p11)+(4.0*p102*p20*((4.0*p11)+p21))+(2.0*p10*p202*((7.0*p11)+(4.0*p21)))+(p203*((6.0*p11)+(7.0*p21)))))+(p00*((-2.0*p012*((14.0*p102)+(6.0*p10*p20)+p202))+(12.0*p10*p20*p21*(p11+p21))+(8.0*p102*((p11+p21)*(p11+p21)))+(-1.0*p01*((2.0*p10)+p20)*((4.0*p10*p11)+(4.0*p11*p20)+(-2.0*p10*p21)+(p20*p21)))+(p202*((-2.0*p112)+(2.0*p11*p21)+(7.0*p212)))))+(2.0*((4.0*p103*p21*(p11+p21))+(-7.0*p203*(p112+(4.0*p11*p21)+(-6.0*p212)))+(2.0*p102*p20*((-2.0*p112)+(2.0*p11*p21)+(7.0*p212)))+(p10*p202*((-8.0*p112)+(-7.0*p11*p21)+(28.0*p212)))))+(p002*((-7.0*p012*((8.0*p10)+p20))+(p01*((14.0*p10*p11)+(-2.0*p11*p20)+(8.0*p10*p21)+(p20*p21)))+(2.0*((p20*((p11+p21)*(p11+p21)))+(p10*((8.0*p112)+(7.0*p11*p21)+(2.0*p212)))))))));
	accum[2] = ((1.0/12.0)*(p012+(-1.0*p212)));
	accum[3] = ((1.0/4.0)*((-1.0*p012)+p212));
	pixel[2] = ((1.0/1260.0)*((-1.0*p013*((14.0*p102)+(6.0*p10*p20)+p202))+(-2.0*p012*((p202*((2.0*p11)+p21))+(p102*((8.0*p11)+p21))+(p10*p20*((7.0*p11)+(2.0*p21)))))+(p002*((-126.0*p013)+(8.0*p113)+(8.0*p112*p21)+(4.0*p11*p212)+p213+(7.0*p012*((8.0*p11)+p21))+(2.0*p01*((14.0*p112)+(6.0*p11*p21)+p212))))+(-1.0*p01*((p102*((8.0*p112)+(-2.0*p212)))+(2.0*p10*p20*((8.0*p112)+(6.0*p11*p21)+p212))+(p202*((8.0*p112)+(12.0*p11*p21)+(7.0*p212)))))+(2.0*((p102*p21*((4.0*p112)+(8.0*p11*p21)+(7.0*p212)))+(-1.0*p202*((4.0*p113)+(14.0*p112*p21)+(28.0*p11*p212)+(-63.0*p213)))+(p10*p20*((-4.0*p113)+(-4.0*p112*p21)+(7.0*p11*p212)+(28.0*p213)))))+(p00*((-7.0*p013*((8.0*p10)+p20))+(-1.0*p012*((14.0*p10*p11)+(8.0*p11*p20)+(-2.0*p10*p21)+(p20*p21)))+(p20*p21*((4.0*p112)+(8.0*p11*p21)+(7.0*p212)))+(2.0*p10*((4.0*p113)+(8.0*p112*p21)+(7.0*p11*p212)+(3.0*p213)))+(p01*((2.0*p11)+p21)*((p20*((-2.0*p11)+p21))+(4.0*p10*(p11+p21))))))));
	accum[4] = ((1.0/6.0)*((-1.0*p013)+p213));
	accum[5] = 0.0;
}
static void quad_10(double *pixel, double *accum, Curve<3,2> *curve)
{
	const double &p00 = curve->p[0].v[0];
	const double &p01 = curve->p[0].v[1];
	const double &p10 = curve->p[1].v[0];
	const double &p11 = curve->p[1].v[1];
	const double &p20 = curve->p[2].v[0];
	const double &p21 = curve->p[2].v[1];
	const double p002 = p00*p00;
	const double p012 = p01*p01;
	const double p102 = p10*p10;
	const double p112 = p11*p11;
	const double p202 = p20*p20;
	const double p212 = p21*p21;
	const double p003 = p00*p002;
	const double p013 = p01*p012;
	const double p103 = p10*p102;
	const double p113 = p11*p112;
	const double p203 = p20*p202;
	const double p213 = p21*p212;
	pixel[0] = ((1.0/840.0)*((-56.0*p112*p20)+(16.0*p10*p112*p20)+(20.0*p112*p202)+(p012*((20.0*p102)+(4.0*p10*(-28.0+(3.0*p20)))+(p20*(-28.0+(3.0*p20)))))+(56.0*p10*p11*p21)+(-16.0*p102*p11*p21)+(-112.0*p11*p20*p21)+(60.0*p11*p202*p21)+(112.0*p10*p212)+(-20.0*p102*p212)+(280.0*p20*p212)+(-60.0*p10*p20*p212)+(-105.0*p202*p212)+(p002*((105.0*p012)+(-20.0*p112)+(-12.0*p11*p21)+(-3.0*p212)+(-10.0*p01*((6.0*p11)+p21))))+(2.0*p00*(((28.0+(-8.0*p10))*p112)+(5.0*p012*(-28.0+(6.0*p10)+p20))+(-4.0*p11*(-7.0+(3.0*p10)+p20)*p21)+((14.0+(-6.0*p10)+(-5.0*p20))*p212)+(2.0*p01*((2.0*p11*(14.0+p20))+((7.0+(-2.0*p10))*p21)))))+(2.0*p01*((8.0*p102*p11)+(4.0*p10*((p11*(-7.0+(3.0*p20)))+(p20*p21)))+(p20*((p11*(-28.0+(6.0*p20)))+((-14.0+(5.0*p20))*p21)))))));
	accum[0] = ((1.0/4.0)*((-1.0*p012)+p212));
	accum[1] = 0.0;
	pixel[1] = ((1.0/2520.0)*((-48.0*p10*p112*p20)+(16.0*p102*p112*p20)+(-60.0*p112*p202)+(32.0*p10*p112*p202)+(28.0*p112*p203)+(p012*((16.0*p103)+(4.0*p10*p20*(-9.0+(2.0*p20)))+(p202*(-9.0+(2.0*p20)))+(4.0*p102*(-15.0+(4.0*p20)))))+(48.0*p102*p11*p21)+(-16.0*p103*p11*p21)+(-16.0*p102*p11*p20*p21)+(-180.0*p11*p202*p21)+(28.0*p10*p11*p202*p21)+(112.0*p11*p203*p21)+(60.0*p102*p212)+(-16.0*p103*p212)+(180.0*p10*p20*p212)+(-56.0*p102*p20*p212)+(315.0*p202*p212)+(-112.0*p10*p202*p212)+(-168.0*p203*p212)+(2.0*p003*((84.0*p012)+(-14.0*p112)+(-6.0*p11*p21)+(-1.0*p212)+(-7.0*p01*((8.0*p11)+p21))))+(p002*((-4.0*p112*(-15.0+(8.0*p10)+p20))+(7.0*p012*(-45.0+(16.0*p10)+(2.0*p20)))+(-4.0*p11*(-9.0+(7.0*p10)+(2.0*p20))*p21)+((9.0+(-8.0*p10)+(-4.0*p20))*p212)+(-2.0*p01*((2.0*p11*(-45.0+(7.0*p10)+(-1.0*p20)))+((-15.0+(8.0*p10)+p20)*p21)))))+(2.0*p01*((8.0*p103*p11)+(4.0*p102*((p11*(-6.0+(4.0*p20)))+(p20*p21)))+(2.0*p10*p20*((-18.0*p11)+(7.0*p11*p20)+(-6.0*p21)+(4.0*p20*p21)))+(p202*((6.0*p11*(-3.0+p20))+((-15.0+(7.0*p20))*p21)))))+(2.0*p00*((p012*((28.0*p102)+(6.0*p10*(-15.0+(2.0*p20)))+(p20*(-15.0+(2.0*p20)))))+(-8.0*p102*((p11+p21)*(p11+p21)))+(p20*((2.0*p112*p20)+(-2.0*p11*(-6.0+p20)*p21)+((15.0+(-7.0*p20))*p212)))+(6.0*p10*((4.0*p112)+(-2.0*p11*(-3.0+p20)*p21)+((3.0+(-2.0*p20))*p212)))+(p01*((p102*((8.0*p11)+(-4.0*p21)))+(12.0*p10*((p11*p20)+p21))+(p20*((4.0*p11*(-3.0+p20))+(p20*p21)))))))));
	accum[2] = ((1.0/6.0)*(p012+(-1.0*p212)));
	accum[3] = ((1.0/4.0)*((-1.0*p012)+p212));
	pixel[2] = ((1.0/1260.0)*((-24.0*p113*p20)+(8.0*p10*p113*p20)+(8.0*p113*p202)+(p013*((14.0*p102)+(6.0*p10*(-15.0+p20))+((-15.0+p20)*p20)))+(24.0*p10*p112*p21)+(-8.0*p102*p112*p21)+(-60.0*p112*p20*p21)+(8.0*p10*p112*p20*p21)+(28.0*p112*p202*p21)+(60.0*p10*p11*p212)+(-16.0*p102*p11*p212)+(-90.0*p11*p20*p212)+(-14.0*p10*p11*p20*p212)+(56.0*p11*p202*p212)+(90.0*p10*p213)+(-14.0*p102*p213)+(315.0*p20*p213)+(-56.0*p10*p20*p213)+(-126.0*p202*p213)+(p012*((2.0*p102*((8.0*p11)+p21))+(p20*((p11*(-30.0+(4.0*p20)))+((-9.0+(2.0*p20))*p21)))+(2.0*p10*((p11*(-30.0+(7.0*p20)))+((-3.0+(2.0*p20))*p21)))))+(p002*((126.0*p013)+(-8.0*p113)+(-8.0*p112*p21)+(-4.0*p11*p212)+(-1.0*p213)+(-7.0*p012*((8.0*p11)+p21))+(-2.0*p01*((14.0*p112)+(6.0*p11*p21)+p212))))+(p00*((-8.0*(-3.0+p10)*p113)+(7.0*p013*(-45.0+(8.0*p10)+p20))+(-4.0*p112*(-9.0+(4.0*p10)+p20)*p21)+(-2.0*p11*(-15.0+(7.0*p10)+(4.0*p20))*p212)+((15.0+(-6.0*p10)+(-7.0*p20))*p213)+(p012*((2.0*p11*(45.0+(7.0*p10)+(4.0*p20)))+((15.0+(-2.0*p10)+p20)*p21)))+(p01*((p112*(60.0+(-8.0*p10)+(4.0*p20)))+(-12.0*(-3.0+p10)*p11*p21)+(-1.0*(-9.0+(4.0*p10)+p20)*p212)))))+(p01*((2.0*p10*((2.0*p11)+p21)*((p11*(-6.0+(4.0*p20)))+((3.0+p20)*p21)))+(p102*((8.0*p112)+(-2.0*p212)))+(p20*((4.0*p112*(-9.0+(2.0*p20)))+(12.0*p11*(-3.0+p20)*p21)+((-15.0+(7.0*p20))*p212)))))));
	accum[4] = ((1.0/6.0)*((-1.0*p013)+p213));
	accum[5] = 0.0;
}
static void quad_01(double *pixel, double *accum, Curve<3,2> *curve)
{
	const double &p00 = curve->p[0].v[0];
	const double &p01 = curve->p[0].v[1];
	const double &p10 = curve->p[1].v[0];
	const double &p11 = curve->p[1].v[1];
	const double &p20 = curve->p[2].v[0];
	const double &p21 = curve->p[2].v[1];
	const double p002 = p00*p00;
	const double p012 = p01*p01;
	const double p102 = p10*p10;
	const double p112 = p11*p11;
	const double p202 = p20*p20;
	const double p212 = p21*p21;
	const double p003 = p00*p002;
	const double p013 = p01*p012;
	const double p103 = p10*p102;
	const double p113 = p11*p112;
	const double p203 = p20*p202;
	const double p213 = p21*p212;
	pixel[0] = ((1.0/840.0)*((-56.0*p10*p11*p20)+(16.0*p10*p112*p20)+(-112.0*p11*p202)+(20.0*p112*p202)+(p012*((20.0*p102)+(12.0*p10*p20)+(3.0*p202)))+(56.0*p102*p21)+(-16.0*p102*p11*p21)+(112.0*p10*p20*p21)+(140.0*p202*p21)+(60.0*p11*p202*p21)+(-20.0*p102*p212)+(-60.0*p10*p20*p212)+(-105.0*p202*p212)+(p002*((105.0*p012)+(-20.0*p112)+((28.0+(-3.0*p21))*p21)+(-10.0*p01*(14.0+(6.0*p11)+p21))+(-4.0*p11*(-28.0+(3.0*p21)))))+(2.0*p01*((4.0*p102*(-7.0+(2.0*p11)))+(4.0*p10*p20*(-7.0+(3.0*p11)+p21))+(p202*(-14.0+(6.0*p11)+(5.0*p21)))))+(2.0*p00*((5.0*p012*((6.0*p10)+p20))+(p20*(14.0+(-4.0*p11)+(-5.0*p21))*p21)+(-2.0*p01*(((7.0+(-2.0*p11))*p20)+(2.0*p10*(14.0+p21))))+(-2.0*p10*((4.0*p112)+(p21*(-14.0+(3.0*p21)))+(2.0*p11*(-7.0+(3.0*p21)))))))));
	accum[0] = ((1.0/4.0)*((-2.0*p01)+p012+(-1.0*(-2.0+p21)*p21)));
	accum[1] = 0.0;
	pixel[1] = ((1.0/1260.0)*((-24.0*p102*p11*p20)+(8.0*p102*p112*p20)+(-60.0*p10*p11*p202)+(16.0*p10*p112*p202)+(-90.0*p11*p203)+(14.0*p112*p203)+(p012*((8.0*p103)+(8.0*p102*p20)+(4.0*p10*p202)+p203))+(24.0*p103*p21)+(-8.0*p103*p11*p21)+(60.0*p102*p20*p21)+(-8.0*p102*p11*p20*p21)+(90.0*p10*p202*p21)+(14.0*p10*p11*p202*p21)+(105.0*p203*p21)+(56.0*p11*p203*p21)+(-8.0*p103*p212)+(-28.0*p102*p20*p212)+(-56.0*p10*p202*p212)+(-84.0*p203*p212)+(p003*((84.0*p012)+(-14.0*p112)+(-6.0*p11*(-15.0+p21))+(-1.0*(-15.0+p21)*p21)+(-7.0*p01*(15.0+(8.0*p11)+p21))))+(p01*((8.0*p103*(-3.0+p11))+(4.0*p102*p20*(-9.0+(4.0*p11)+p21))+(2.0*p10*p202*(-15.0+(7.0*p11)+(4.0*p21)))+(p203*(-15.0+(6.0*p11)+(7.0*p21)))))+(p002*((7.0*p012*((8.0*p10)+p20))+(p20*((-2.0*p112)+(p11*(6.0+(-4.0*p21)))+((9.0+(-2.0*p21))*p21)))+(-1.0*p01*((p20*(15.0+(-2.0*p11)+p21))+(2.0*p10*(45.0+(7.0*p11)+(4.0*p21)))))+(-2.0*p10*((8.0*p112)+(p21*(-15.0+(2.0*p21)))+(p11*(-30.0+(7.0*p21)))))))+(p00*((2.0*p012*((14.0*p102)+(6.0*p10*p20)+p202))+(-12.0*p10*p20*p21*(-3.0+p11+p21))+(p01*((12.0*p10*(-3.0+p11)*p20)+(p102*(-60.0+(8.0*p11)+(-4.0*p21)))+(p202*(-9.0+(4.0*p11)+p21))))+(-4.0*p102*((2.0*p112)+(p21*(-9.0+(2.0*p21)))+(p11*(-6.0+(4.0*p21)))))+(-1.0*p202*((-2.0*p112)+(2.0*p11*(3.0+p21))+(p21*(-15.0+(7.0*p21)))))))));
	accum[2] = ((1.0/12.0)*((2.0*p01)+(-1.0*p012)+((-2.0+p21)*p21)));
	accum[3] = ((1.0/4.0)*((-2.0*p01)+p012+(-1.0*(-2.0+p21)*p21)));
	pixel[2] = ((1.0/2520.0)*((-48.0*p10*p112*p20)+(16.0*p10*p113*p20)+(-60.0*p112*p202)+(16.0*p113*p202)+(2.0*p013*((14.0*p102)+(6.0*p10*p20)+p202))+(48.0*p102*p11*p21)+(-16.0*p102*p112*p21)+(16.0*p10*p112*p20*p21)+(-180.0*p11*p202*p21)+(56.0*p112*p202*p21)+(60.0*p102*p212)+(-32.0*p102*p11*p212)+(180.0*p10*p20*p212)+(-28.0*p10*p11*p20*p212)+(315.0*p202*p212)+(112.0*p11*p202*p212)+(-28.0*p102*p213)+(-112.0*p10*p20*p213)+(-252.0*p202*p213)+(p012*((4.0*p102*(-15.0+(8.0*p11)+p21))+(4.0*p10*p20*(-9.0+(7.0*p11)+(2.0*p21)))+(p202*(-9.0+(8.0*p11)+(4.0*p21)))))+(p002*((252.0*p013)+(-16.0*p113)+(p112*(60.0+(-16.0*p21)))+(4.0*p11*(9.0+(-2.0*p21))*p21)+((9.0+(-2.0*p21))*p212)+(-7.0*p012*(45.0+(16.0*p11)+(2.0*p21)))+(-2.0*p01*((28.0*p112)+(6.0*p11*(-15.0+(2.0*p21)))+(p21*(-15.0+(2.0*p21)))))))+(2.0*p01*((2.0*p10*p20*((8.0*p112)+(6.0*p11*(-3.0+p21))+((-6.0+p21)*p21)))+(p102*((-24.0*p11)+(8.0*p112)+(-2.0*p212)))+(p202*((8.0*p112)+(6.0*p11*(-3.0+(2.0*p21)))+(p21*(-15.0+(7.0*p21)))))))+(2.0*p00*((7.0*p013*((8.0*p10)+p20))+(p20*p21*((-4.0*p112)+(p11*(12.0+(-8.0*p21)))+((15.0+(-7.0*p21))*p21)))+(p012*((2.0*p10*(-45.0+(7.0*p11)+(-1.0*p21)))+(p20*(-15.0+(8.0*p11)+p21))))+(-2.0*p10*((4.0*p113)+(3.0*(-3.0+p21)*p212)+(4.0*p112*(-3.0+(2.0*p21)))+(p11*p21*(-18.0+(7.0*p21)))))+(-1.0*p01*((4.0*p10*((2.0*p112)+(3.0*p11*p21)+((-3.0+p21)*p21)))+(p20*((12.0*p11)+(-4.0*p112)+p212))))))));
	accum[4] = ((1.0/12.0)*((-3.0*p012)+(2.0*p013)+((3.0+(-2.0*p21))*p212)));
	accum[5] = 0.0;
}
static void quad_11(double *pixel, double *accum, Curve<3,2> *curve)
{
	const double &p00 = curve->p[0].v[0];
	const double &p01 = curve->p[0].v[1];
	const double &p10 = curve->p[1].v[0];
	const double &p11 = curve->p[1].v[1];
	const double &p20 = curve->p[2].v[0];
	const double &p21 = curve->p[2].v[1];
	const double p002 = p00*p00;
	const double p012 = p01*p01;
	const double p102 = p10*p10;
	const double p112 = p11*p11;
	const double p202 = p20*p20;
	const double p212 = p21*p21;
	const double p003 = p00*p002;
	const double p013 = p01*p012;
	const double p103 = p10*p102;
	const double p113 = p11*p112;
	const double p203 = p20*p202;
	const double p213 = p21*p212;
	pixel[0] = ((1.0/840.0)*((-280.0*p11*p20)+(56.0*p10*p11*p20)+(56.0*p112*p20)+(-16.0*p10*p112*p20)+(112.0*p11*p202)+(-20.0*p112*p202)+(p012*((-20.0*p102)+((28.0+(-3.0*p20))*p20)+(-4.0*p10*(-28.0+(3.0*p20)))))+(280.0*p10*p21)+(-56.0*p102*p21)+(-56.0*p10*p11*p21)+(16.0*p102*p11*p21)+(420.0*p20*p21)+(-112.0*p10*p20*p21)+(112.0*p11*p20*p21)+(-140.0*p202*p21)+(-60.0*p11*p202*p21)+(-112.0*p10*p212)+(20.0*p102*p212)+(-280.0*p20*p212)+(60.0*p10*p20*p212)+(105.0*p202*p212)+(p002*((-105.0*p012)+(20.0*p112)+(10.0*p01*(14.0+(6.0*p11)+p21))+(4.0*p11*(-28.0+(3.0*p21)))+(p21*(-28.0+(3.0*p21)))))+(-2.0*p01*((4.0*p102*(-7.0+(2.0*p11)))+(4.0*p10*(35.0+(p11*(-7.0+(3.0*p20)))+(p20*(-7.0+p21))))+(p20*(70.0+(-14.0*p20)+(p11*(-28.0+(6.0*p20)))+(-14.0*p21)+(5.0*p20*p21)))))+(-2.0*p00*(((28.0+(-8.0*p10))*p112)+(5.0*p012*(-28.0+(6.0*p10)+p20))+(((p10*(28.0+(-6.0*p21)))+(p20*(14.0+(-5.0*p21)))+(14.0*(-5.0+p21)))*p21)+(2.0*p01*((2.0*p11*(14.0+p20))+(-2.0*p10*(14.0+p21))+(7.0*(15.0+(-1.0*p20)+p21))))+(-4.0*p11*(35.0+((-7.0+p20)*p21)+(p10*(-7.0+(3.0*p21)))))))));
	accum[0] = ((1.0/4.0)*((-2.0*p01)+p012+(-1.0*(-2.0+p21)*p21)));
	accum[1] = 0.0;
	pixel[1] = ((1.0/2520.0)*((-168.0*p10*p11*p20)+(48.0*p102*p11*p20)+(48.0*p10*p112*p20)+(-16.0*p102*p112*p20)+(-336.0*p11*p202)+(120.0*p10*p11*p202)+(60.0*p112*p202)+(-32.0*p10*p112*p202)+(180.0*p11*p203)+(-28.0*p112*p203)+(p012*((-16.0*p103)+(p102*(60.0+(-16.0*p20)))+(4.0*p10*(9.0+(-2.0*p20))*p20)+((9.0+(-2.0*p20))*p202)))+(168.0*p102*p21)+(-48.0*p103*p21)+(-48.0*p102*p11*p21)+(16.0*p103*p11*p21)+(336.0*p10*p20*p21)+(-120.0*p102*p20*p21)+(16.0*p102*p11*p20*p21)+(420.0*p202*p21)+(-180.0*p10*p202*p21)+(180.0*p11*p202*p21)+(-28.0*p10*p11*p202*p21)+(-210.0*p203*p21)+(-112.0*p11*p203*p21)+(-60.0*p102*p212)+(16.0*p103*p212)+(-180.0*p10*p20*p212)+(56.0*p102*p20*p212)+(-315.0*p202*p212)+(112.0*p10*p202*p212)+(168.0*p203*p212)+(-2.0*p003*((84.0*p012)+(-14.0*p112)+(-6.0*p11*(-15.0+p21))+(-1.0*(-15.0+p21)*p21)+(-7.0*p01*(15.0+(8.0*p11)+p21))))+(-2.0*p01*((8.0*p103*(-3.0+p11))+(4.0*p102*(21.0+(p11*(-6.0+(4.0*p20)))+(p20*(-9.0+p21))))+(2.0*p10*p20*(42.0+(-15.0*p20)+(p11*(-18.0+(7.0*p20)))+(-6.0*p21)+(4.0*p20*p21)))+(p202*(42.0+(6.0*p11*(-3.0+p20))+(-15.0*p21)+(p20*(-15.0+(7.0*p21)))))))+(p002*((4.0*p112*(-15.0+(8.0*p10)+p20))+(-7.0*p012*(-45.0+(16.0*p10)+(2.0*p20)))+(2.0*p01*(-210.0+(15.0*p20)+(-2.0*p11*(45.0+p20))+(-15.0*p21)+(p20*p21)+(2.0*p10*(45.0+(7.0*p11)+(4.0*p21)))))+(4.0*p11*(84.0+(-9.0*p21)+(p20*(-3.0+(2.0*p21)))+(p10*(-30.0+(7.0*p21)))))+(p21*(84.0+(-9.0*p21)+(2.0*p20*(-9.0+(2.0*p21)))+(p10*(-60.0+(8.0*p21)))))))+(-2.0*p00*((p012*((28.0*p102)+(6.0*p10*(-15.0+(2.0*p20)))+(p20*(-15.0+(2.0*p20)))))+(-4.0*p102*((2.0*p112)+(p21*(-9.0+(2.0*p21)))+(p11*(-6.0+(4.0*p21)))))+(6.0*p10*((4.0*p112)+(p21*(-14.0+(-2.0*p20*(-3.0+p21))+(3.0*p21)))+(-2.0*p11*(7.0+((-3.0+p20)*p21)))))+(p20*((2.0*p112*p20)+(p21*(-42.0+(p20*(15.0+(-7.0*p21)))+(15.0*p21)))+(-2.0*p11*((-6.0*p21)+(p20*(3.0+p21))))))+(p01*((p20*(42.0+(4.0*p11*(-3.0+p20))+(p20*(-9.0+p21))))+(12.0*p10*(14.0+((-3.0+p11)*p20)+p21))+(p102*((8.0*p11)+(-4.0*(15.0+p21))))))))));
	accum[2] = ((1.0/6.0)*((2.0*p01)+(-1.0*p012)+((-2.0+p21)*p21)));
	accum[3] = ((1.0/4.0)*((-2.0*p01)+p012+(-1.0*(-2.0+p21)*p21)));
	pixel[2] = ((1.0/2520.0)*((-168.0*p112*p20)+(48.0*p10*p112*p20)+(48.0*p113*p20)+(-16.0*p10*p113*p20)+(60.0*p112*p202)+(-16.0*p113*p202)+(-2.0*p013*((14.0*p102)+(6.0*p10*(-15.0+p20))+((-15.0+p20)*p20)))+(168.0*p10*p11*p21)+(-48.0*p102*p11*p21)+(-48.0*p10*p112*p21)+(16.0*p102*p112*p21)+(-336.0*p11*p20*p21)+(120.0*p112*p20*p21)+(-16.0*p10*p112*p20*p21)+(180.0*p11*p202*p21)+(-56.0*p112*p202*p21)+(336.0*p10*p212)+(-60.0*p102*p212)+(-120.0*p10*p11*p212)+(32.0*p102*p11*p212)+(840.0*p20*p212)+(-180.0*p10*p20*p212)+(180.0*p11*p20*p212)+(28.0*p10*p11*p20*p212)+(-315.0*p202*p212)+(-112.0*p11*p202*p212)+(-180.0*p10*p213)+(28.0*p102*p213)+(-630.0*p20*p213)+(112.0*p10*p20*p213)+(252.0*p202*p213)+(-1.0*p012*((4.0*p102*(-15.0+(8.0*p11)+p21))+(4.0*p10*(84.0+(-9.0*p20)+(p11*(-30.0+(7.0*p20)))+(-3.0*p21)+(2.0*p20*p21)))+(p20*(84.0+(-9.0*p20)+(p11*(-60.0+(8.0*p20)))+(-18.0*p21)+(4.0*p20*p21)))))+(p002*((-252.0*p013)+(16.0*p113)+(4.0*p11*p21*(-9.0+(2.0*p21)))+(p212*(-9.0+(2.0*p21)))+(7.0*p012*(45.0+(16.0*p11)+(2.0*p21)))+(4.0*p112*(-15.0+(4.0*p21)))+(2.0*p01*((28.0*p112)+(6.0*p11*(-15.0+(2.0*p21)))+(p21*(-15.0+(2.0*p21)))))))+(-2.0*p00*((-8.0*(-3.0+p10)*p113)+(7.0*p013*(-45.0+(8.0*p10)+p20))+(p212*(-42.0+(p20*(15.0+(-7.0*p21)))+(-6.0*p10*(-3.0+p21))+(15.0*p21)))+(p012*(420.0+(-15.0*p20)+(p11*(90.0+(8.0*p20)))+(2.0*p10*(-45.0+(7.0*p11)+(-1.0*p21)))+(15.0*p21)+(p20*p21)))+(-4.0*p112*(21.0+((-9.0+p20)*p21)+(p10*(-6.0+(4.0*p21)))))+(-2.0*p11*p21*(42.0+(-15.0*p21)+(p20*(-6.0+(4.0*p21)))+(p10*(-18.0+(7.0*p21)))))+(-1.0*p01*((p112*((8.0*p10)+(-4.0*(15.0+p20))))+(12.0*p11*(14.0+p20+((-3.0+p10)*p21)))+(p21*(42.0+(4.0*p10*(-3.0+p21))+((-9.0+p20)*p21)))))))+(-2.0*p01*((p102*((-24.0*p11)+(8.0*p112)+(-2.0*p212)))+(2.0*p10*((4.0*p112*(-3.0+(2.0*p20)))+(6.0*p11*(7.0+(p20*(-3.0+p21))))+(p21*((p20*(-6.0+p21))+(3.0*p21)))))+(p20*((4.0*p112*(-9.0+(2.0*p20)))+(6.0*p11*(14.0+(-3.0*p20)+(-6.0*p21)+(2.0*p20*p21)))+(p21*(42.0+(-15.0*p20)+(-15.0*p21)+(7.0*p20*p21)))))))));
	accum[4] = ((1.0/12.0)*((-3.0*p012)+(2.0*p013)+((3.0+(-2.0*p21))*p212)));
	accum[5] = 0.0;
}

//=============================================================================//
//================================= Cubics ====================================//
//=============================================================================//

static void cube_00(double *pixel, double *accum, Curve<4,2> *curve)
{
	const double &p00 = curve->p[0].v[0];
	const double &p01 = curve->p[0].v[1];
	const double &p10 = curve->p[1].v[0];
	const double &p11 = curve->p[1].v[1];
	const double &p20 = curve->p[2].v[0];
	const double &p21 = curve->p[2].v[1];
	const double &p30 = curve->p[3].v[0];
	const double &p31 = curve->p[3].v[1];
	const double p002 = p00*p00;
	const double p012 = p01*p01;
	const double p102 = p10*p10;
	const double p112 = p11*p11;
	const double p202 = p20*p20;
	const double p212 = p21*p21;
	const double p302 = p30*p30;
	const double p312 = p31*p31;
	const double p003 = p00*p002;
	const double p013 = p01*p012;
	const double p103 = p10*p102;
	const double p113 = p11*p112;
	const double p203 = p20*p202;
	const double p213 = p21*p212;
	const double p303 = p30*p302;
	const double p313 = p31*p312;
	pixel[0] = ((1.0/18480.0)*((-1.0*p012*((378.0*p102)+(63.0*p202)+(30.0*p20*p30)+(5.0*p302)+(42.0*p10*((6.0*p20)+p30))))+(p002*((-2310.0*p012)+(378.0*p112)+(63.0*p212)+(30.0*p21*p31)+(5.0*p312)+(42.0*p11*((6.0*p21)+p31))+(28.0*p01*((45.0*p11)+(9.0*p21)+p31))))+(-2.0*p00*((-126.0*p10*p112)+(-189.0*p10*p11*p21)+(-54.0*p11*p20*p21)+(-81.0*p10*p212)+(-45.0*p20*p212)+(9.0*p112*p30)+(-9.0*p212*p30)+(14.0*p012*((45.0*p10)+(9.0*p20)+p30))+(-54.0*p10*p11*p31)+(-30.0*p11*p20*p31)+(-60.0*p10*p21*p31)+(-54.0*p20*p21*p31)+(-6.0*p11*p30*p31)+(-21.0*p21*p30*p31)+(-15.0*p10*p312)+(-21.0*p20*p312)+(-14.0*p30*p312)+(3.0*p01*((2.0*p21*p30)+(7.0*p11*((4.0*p20)+p30))+(-2.0*p20*p31)+(-7.0*p10*((4.0*p21)+p31))))))+(-2.0*p01*((45.0*p202*p21)+(54.0*p20*p21*p30)+(21.0*p21*p302)+(3.0*p11*((27.0*p202)+(20.0*p20*p30)+(5.0*p302)))+(9.0*p102*((14.0*p11)+(-1.0*p31)))+(9.0*p202*p31)+(21.0*p20*p30*p31)+(14.0*p302*p31)+(3.0*p10*((9.0*p11*((7.0*p20)+(2.0*p30)))+(2.0*((9.0*p20*p21)+(5.0*p21*p30)+(p30*p31)))))))+(3.0*((-3.0*p112*((15.0*p202)+(18.0*p20*p30)+(7.0*p302)))+(-2.0*p11*((27.0*p202*p21)+(42.0*p302*(p21+p31))+(7.0*p20*p30*((9.0*p21)+(4.0*p31)))))+(3.0*p102*((15.0*p212)+(18.0*p21*p31)+(7.0*p312)+(2.0*p11*((9.0*p21)+(5.0*p31)))))+(p10*((-6.0*p112*((9.0*p20)+(5.0*p30)))+(28.0*p30*p31*((2.0*p21)+(3.0*p31)))+(-36.0*p11*((p21*p30)+(-1.0*p20*p31)))+(6.0*p20*((9.0*p212)+(21.0*p21*p31)+(14.0*p312)))))+(14.0*((3.0*p202*p31*((2.0*p21)+(3.0*p31)))+(-6.0*p20*p30*(p212+(-5.0*p312)))+(p302*((-9.0*p212)+(-30.0*p21*p31)+(55.0*p312)))))))));
	accum[0] = ((1.0/4.0)*((-1.0*p012)+p312));
	accum[1] = 0.0;
	pixel[1] = ((1.0/120120.0)*((-324.0*p102*p112*p20)+(-486.0*p10*p112*p202)+(-243.0*p112*p203)+(324.0*p103*p11*p21)+(243.0*p102*p11*p20*p21)+(-243.0*p10*p11*p202*p21)+(-324.0*p11*p203*p21)+(243.0*p103*p212)+(486.0*p102*p20*p212)+(324.0*p10*p202*p212)+(-162.0*p102*p112*p30)+(-486.0*p10*p112*p20*p30)+(-432.0*p112*p202*p30)+(-81.0*p102*p11*p21*p30)+(-648.0*p10*p11*p20*p21*p30)+(-972.0*p11*p202*p21*p30)+(108.0*p102*p212*p30)+(-486.0*p202*p212*p30)+(-144.0*p10*p112*p302)+(-324.0*p112*p20*p302)+(-324.0*p10*p11*p21*p302)+(-1134.0*p11*p20*p21*p302)+(-162.0*p10*p212*p302)+(-1188.0*p20*p212*p302)+(-108.0*p112*p303)+(-594.0*p11*p21*p303)+(-1188.0*p212*p303)+(-1.0*p012*((594.0*p103)+(72.0*p203)+(63.0*p202*p30)+(24.0*p20*p302)+(4.0*p303)+(108.0*p102*((6.0*p20)+p30))+(3.0*p10*((108.0*p202)+(48.0*p20*p30)+(7.0*p302)))))+(162.0*p103*p11*p31)+(324.0*p102*p11*p20*p31)+(216.0*p10*p11*p202*p31)+(243.0*p103*p21*p31)+(756.0*p102*p20*p21*p31)+(972.0*p10*p202*p21*p31)+(486.0*p203*p21*p31)+(72.0*p102*p11*p30*p31)+(-324.0*p11*p202*p30*p31)+(324.0*p102*p21*p30*p31)+(972.0*p10*p20*p21*p30*p31)+(594.0*p202*p21*p30*p31)+(-108.0*p10*p11*p302*p31)+(-792.0*p11*p20*p302*p31)+(198.0*p10*p21*p302*p31)+(-1188.0*p20*p21*p302*p31)+(-792.0*p11*p303*p31)+(-5148.0*p21*p303*p31)+(72.0*p103*p312)+(324.0*p102*p20*p312)+(648.0*p10*p202*p312)+(594.0*p203*p312)+(216.0*p102*p30*p312)+(1188.0*p10*p20*p30*p312)+(2376.0*p202*p30*p312)+(792.0*p10*p302*p312)+(5148.0*p20*p302*p312)+(8008.0*p303*p312)+(2.0*p003*((-4004.0*p012)+(594.0*p112)+(33.0*p01*((78.0*p11)+(12.0*p21)+p31))+(9.0*p11*((33.0*p21)+(4.0*p31)))+(2.0*((27.0*p212)+(9.0*p21*p31)+p312))))+(-3.0*p01*((81.0*p11*p203)+(54.0*p203*p21)+(99.0*p11*p202*p30)+(96.0*p202*p21*p30)+(52.0*p11*p20*p302)+(72.0*p20*p21*p302)+(12.0*p11*p303)+(24.0*p21*p303)+(6.0*p103*((27.0*p11)+(-2.0*p31)))+(12.0*p203*p31)+(36.0*p202*p30*p31)+(42.0*p20*p302*p31)+(22.0*p303*p31)+(3.0*p102*((24.0*p20*p21)+(12.0*p21*p30)+(4.0*p11*((27.0*p20)+(7.0*p30)))+(-3.0*p20*p31)+(p30*p31)))+(p10*((3.0*p11*((84.0*p202)+(54.0*p20*p30)+(11.0*p302)))+(9.0*p202*((12.0*p21)+p31))+(12.0*p20*p30*((9.0*p21)+(2.0*p31)))+(4.0*p302*((8.0*p21)+(3.0*p31)))))))+(p002*((162.0*p112*p20)+(324.0*p11*p20*p21)+(144.0*p20*p212)+(36.0*p11*p21*p30)+(27.0*p212*p30)+(-66.0*p012*((78.0*p10)+(12.0*p20)+p30))+(96.0*p11*p20*p31)+(99.0*p20*p21*p31)+(18.0*p11*p30*p31)+(27.0*p21*p30*p31)+(21.0*p20*p312)+(8.0*p30*p312)+(6.0*p10*((198.0*p112)+(189.0*p11*p21)+(54.0*p212)+(36.0*p11*p31)+(26.0*p21*p31)+(4.0*p312)))+(2.0*p01*((-99.0*p11*p20)+(54.0*p20*p21)+(-27.0*p11*p30)+(18.0*p20*p31)+(2.0*p30*p31)+(9.0*p10*((66.0*p11)+(44.0*p21)+(7.0*p31)))))))+(p00*((-4.0*p012*((594.0*p102)+(9.0*p10*((33.0*p20)+(4.0*p30)))+(2.0*((27.0*p202)+(9.0*p20*p30)+p302))))+(-1.0*p01*((72.0*p202*p21)+(72.0*p20*p21*p30)+(18.0*p21*p302)+(3.0*p11*((108.0*p202)+(56.0*p20*p30)+(9.0*p302)))+(-9.0*p202*p31)+(6.0*p20*p30*p31)+(4.0*p302*p31)+(6.0*p10*((8.0*p21*p30)+(18.0*p11*((9.0*p20)+(2.0*p30)))+(-1.0*((12.0*p20)+p30)*p31)))+(54.0*p102*((11.0*p11)+(-2.0*((3.0*p21)+p31))))))+(3.0*((54.0*p202*p212)+(24.0*p20*p212*p30)+(-9.0*p112*(((2.0*p20)+p30)*((2.0*p20)+p30)))+(84.0*p202*p21*p31)+(72.0*p20*p21*p30*p31)+(18.0*p21*p302*p31)+(36.0*p202*p312)+(48.0*p20*p30*p312)+(22.0*p302*p312)+(p11*((-12.0*p21*p302)+(-2.0*p20*p30*((9.0*p21)+(-8.0*p31)))+(9.0*p202*((3.0*p21)+(4.0*p31)))))+(3.0*p102*((54.0*p112)+(48.0*p212)+(33.0*p21*p31)+(7.0*p312)+(4.0*p11*((27.0*p21)+(8.0*p31)))))+(2.0*p10*((-12.0*p112*p30)+(2.0*p30*((9.0*p212)+(14.0*p21*p31)+(6.0*p312)))+(3.0*p20*((27.0*p212)+(27.0*p21*p31)+(8.0*p312)))+(3.0*p11*((18.0*p20*((2.0*p21)+p31))+(p30*((3.0*p21)+(4.0*p31)))))))))))));
	accum[2] = ((1.0/12.0)*(p012+(-1.0*p312)));
	accum[3] = ((1.0/4.0)*((-1.0*p012)+p312));
	pixel[2] = ((1.0/120120.0)*((-2.0*p013*((594.0*p102)+(9.0*p10*((33.0*p20)+(4.0*p30)))+(2.0*((27.0*p202)+(9.0*p20*p30)+p302))))+(-1.0*p012*((144.0*p202*p21)+(54.0*p102*((22.0*p11)+(3.0*p21)))+(99.0*p20*p21*p30)+(21.0*p21*p302)+(12.0*p11*((27.0*p202)+(13.0*p20*p30)+(2.0*p302)))+(27.0*p202*p31)+(27.0*p20*p30*p31)+(8.0*p302*p31)+(6.0*p10*((54.0*p20*p21)+(16.0*p21*p30)+(9.0*p11*((21.0*p20)+(4.0*p30)))+(6.0*p20*p31)+(3.0*p30*p31)))))+(-3.0*p01*((54.0*p202*p212)+(84.0*p20*p212*p30)+(36.0*p212*p302)+(3.0*p112*((48.0*p202)+(33.0*p20*p30)+(7.0*p302)))+(24.0*p202*p21*p31)+(72.0*p20*p21*p30*p31)+(48.0*p21*p302*p31)+(18.0*p20*p30*p312)+(22.0*p302*p312)+(3.0*p102*((54.0*p112)+(-8.0*p11*p31)+(-3.0*(((2.0*p21)+p31)*((2.0*p21)+p31)))))+(2.0*p11*((12.0*p302*((2.0*p21)+p31))+(9.0*p202*((9.0*p21)+(2.0*p31)))+(p20*p30*((81.0*p21)+(28.0*p31)))))+(p10*((12.0*p112*((27.0*p20)+(8.0*p30)))+(4.0*p21*p30*((9.0*p21)+(4.0*p31)))+(6.0*p11*((36.0*p20*p21)+(18.0*p21*p30)+(3.0*p20*p31)+(4.0*p30*p31)))+(3.0*p20*((9.0*p212)+(-6.0*p21*p31)+(-4.0*p312)))))))+(p002*((-12012.0*p013)+(594.0*p113)+(72.0*p213)+(63.0*p212*p31)+(24.0*p21*p312)+(4.0*p313)+(108.0*p112*((6.0*p21)+p31))+(66.0*p012*((78.0*p11)+(12.0*p21)+p31))+(3.0*p11*((108.0*p212)+(48.0*p21*p31)+(7.0*p312)))+(4.0*p01*((594.0*p112)+(9.0*p11*((33.0*p21)+(4.0*p31)))+(2.0*((27.0*p212)+(9.0*p21*p31)+p312))))))+(p00*((-66.0*p013*((78.0*p10)+(12.0*p20)+p30))+(-2.0*p012*((396.0*p11*p20)+(54.0*p20*p21)+(63.0*p11*p30)+(18.0*p21*p30)+(9.0*p10*((66.0*p11)+(-11.0*p21)+(-3.0*p31)))+(2.0*p30*p31)))+(p01*((72.0*p20*p212)+(-9.0*p212*p30)+(-108.0*p112*((3.0*p20)+p30))+(72.0*p20*p21*p31)+(6.0*p21*p30*p31)+(18.0*p20*p312)+(4.0*p30*p312)+(-6.0*p11*((12.0*p21*p30)+(-8.0*p20*p31)+(p30*p31)))+(3.0*p10*((198.0*p112)+(108.0*p212)+(56.0*p21*p31)+(9.0*p312)+(36.0*p11*((9.0*p21)+(2.0*p31)))))))+(3.0*((54.0*p20*p213)+(-12.0*p113*p30)+(12.0*p213*p30)+(96.0*p20*p212*p31)+(36.0*p212*p30*p31)+(72.0*p20*p21*p312)+(42.0*p21*p30*p312)+(24.0*p20*p313)+(22.0*p30*p313)+(3.0*p112*((p30*((-3.0*p21)+p31))+(12.0*p20*((2.0*p21)+p31))))+(p11*((3.0*p30*((3.0*p212)+(8.0*p21*p31)+(4.0*p312)))+(4.0*p20*((27.0*p212)+(27.0*p21*p31)+(8.0*p312)))))+(p10*((162.0*p113)+(81.0*p213)+(99.0*p212*p31)+(52.0*p21*p312)+(12.0*p313)+(12.0*p112*((27.0*p21)+(7.0*p31)))+(3.0*p11*((84.0*p212)+(54.0*p21*p31)+(11.0*p312)))))))))+(3.0*((-3.0*p113*((27.0*p202)+(27.0*p20*p30)+(8.0*p302)))+(-18.0*p112*((2.0*p302*((3.0*p21)+(2.0*p31)))+(p202*((9.0*p21)+(2.0*p31)))+(2.0*p20*p30*((7.0*p21)+(3.0*p31)))))+(-6.0*p11*((9.0*p202*((2.0*p212)+(-1.0*p312)))+(p20*p30*((54.0*p212)+(54.0*p21*p31)+(11.0*p312)))+(2.0*p302*((18.0*p212)+(33.0*p21*p31)+(22.0*p312)))))+(3.0*p102*((18.0*p112*((2.0*p21)+p31))+(2.0*p11*((27.0*p212)+(27.0*p21*p31)+(8.0*p312)))+(3.0*((9.0*p213)+(16.0*p212*p31)+(12.0*p21*p312)+(4.0*p313)))))+(2.0*((9.0*p202*p31*((9.0*p212)+(22.0*p21*p31)+(22.0*p312)))+(-11.0*p302*((9.0*p213)+(36.0*p212*p31)+(78.0*p21*p312)+(-182.0*p313)))+(3.0*p20*p30*((-27.0*p213)+(-33.0*p212*p31)+(66.0*p21*p312)+(286.0*p313)))))+(-3.0*p10*((18.0*p113*((2.0*p20)+p30))+(p112*((27.0*p20*p21)+(36.0*p21*p30)+(-9.0*p20*p31)+(8.0*p30*p31)))+(-3.0*p11*((4.0*p30*((-2.0*p212)+p312))+(3.0*p20*((3.0*p212)+(8.0*p21*p31)+(4.0*p312)))))+(-2.0*((2.0*p30*p31*((9.0*p212)+(22.0*p21*p31)+(22.0*p312)))+(3.0*p20*((6.0*p213)+(18.0*p212*p31)+(21.0*p21*p312)+(11.0*p313)))))))))));
	accum[4] = ((1.0/6.0)*((-1.0*p013)+p313));
	accum[5] = 0.0;
}
static void cube_10(double *pixel, double *accum, Curve<4,2> *curve)
{
	const double &p00 = curve->p[0].v[0];
	const double &p01 = curve->p[0].v[1];
	const double &p10 = curve->p[1].v[0];
	const double &p11 = curve->p[1].v[1];
	const double &p20 = curve->p[2].v[0];
	const double &p21 = curve->p[2].v[1];
	const double &p30 = curve->p[3].v[0];
	const double &p31 = curve->p[3].v[1];
	const double p002 = p00*p00;
	const double p012 = p01*p01;
	const double p102 = p10*p10;
	const double p112 = p11*p11;
	const double p202 = p20*p20;
	const double p212 = p21*p21;
	const double p302 = p30*p30;
	const double p312 = p31*p31;
	const double p003 = p00*p002;
	const double p013 = p01*p012;
	const double p103 = p10*p102;
	const double p113 = p11*p112;
	const double p203 = p20*p202;
	const double p213 = p21*p212;
	const double p303 = p30*p302;
	const double p313 = p31*p312;
	pixel[0] = ((1.0/18480.0)*((p012*((378.0*p102)+(63.0*p202)+(30.0*p20*p30)+(5.0*p302)+(42.0*p10*((6.0*p20)+p30))))+(p002*((2310.0*p012)+(-378.0*p112)+(-63.0*p212)+(-30.0*p21*p31)+(-5.0*p312)+(-42.0*p11*((6.0*p21)+p31))+(-28.0*p01*((45.0*p11)+(9.0*p21)+p31))))+(2.0*p00*((-126.0*p10*p112)+(-189.0*p10*p11*p21)+(-54.0*p11*p20*p21)+(-81.0*p10*p212)+(-45.0*p20*p212)+(9.0*p112*p30)+(-9.0*p212*p30)+(14.0*p012*((45.0*p10)+(9.0*p20)+p30))+(-54.0*p10*p11*p31)+(-30.0*p11*p20*p31)+(-60.0*p10*p21*p31)+(-54.0*p20*p21*p31)+(-6.0*p11*p30*p31)+(-21.0*p21*p30*p31)+(-15.0*p10*p312)+(-21.0*p20*p312)+(-14.0*p30*p312)+(3.0*p01*((2.0*p21*p30)+(7.0*p11*((4.0*p20)+p30))+(-2.0*p20*p31)+(-7.0*p10*((4.0*p21)+p31))))))+(22.0*((-27.0*p112*p20)+(27.0*p10*p11*p21)+(-27.0*p11*p20*p21)+(27.0*p10*p212)+(-18.0*p112*p30)+(-45.0*p11*p21*p30)+(-45.0*p212*p30)+(-5.0*p012*((21.0*p10)+(6.0*p20)+p30))+(18.0*p10*p11*p31)+(45.0*p10*p21*p31)+(45.0*p20*p21*p31)+(-30.0*p11*p30*p31)+(-105.0*p21*p30*p31)+(30.0*p10*p312)+(105.0*p20*p312)+(280.0*p30*p312)+(-1.0*p01*((45.0*p10*p11)+(45.0*p11*p20)+(18.0*p20*p21)+(15.0*p11*p30)+(12.0*p21*p30)+(-3.0*p10*p31)+(3.0*p20*p31)+(5.0*p30*p31)))+(p00*((-280.0*p012)+(45.0*p112)+(45.0*p11*p21)+(18.0*p212)+(12.0*p11*p31)+(15.0*p21*p31)+(5.0*p312)+(5.0*p01*((21.0*p11)+(6.0*p21)+p31))))))+(2.0*p01*((45.0*p202*p21)+(54.0*p20*p21*p30)+(21.0*p21*p302)+(3.0*p11*((27.0*p202)+(20.0*p20*p30)+(5.0*p302)))+(9.0*p102*((14.0*p11)+(-1.0*p31)))+(9.0*p202*p31)+(21.0*p20*p30*p31)+(14.0*p302*p31)+(3.0*p10*((9.0*p11*((7.0*p20)+(2.0*p30)))+(2.0*((9.0*p20*p21)+(5.0*p21*p30)+(p30*p31)))))))+(-3.0*((-3.0*p112*((15.0*p202)+(18.0*p20*p30)+(7.0*p302)))+(-2.0*p11*((27.0*p202*p21)+(42.0*p302*(p21+p31))+(7.0*p20*p30*((9.0*p21)+(4.0*p31)))))+(3.0*p102*((15.0*p212)+(18.0*p21*p31)+(7.0*p312)+(2.0*p11*((9.0*p21)+(5.0*p31)))))+(p10*((-6.0*p112*((9.0*p20)+(5.0*p30)))+(28.0*p30*p31*((2.0*p21)+(3.0*p31)))+(-36.0*p11*((p21*p30)+(-1.0*p20*p31)))+(6.0*p20*((9.0*p212)+(21.0*p21*p31)+(14.0*p312)))))+(14.0*((3.0*p202*p31*((2.0*p21)+(3.0*p31)))+(-6.0*p20*p30*(p212+(-5.0*p312)))+(p302*((-9.0*p212)+(-30.0*p21*p31)+(55.0*p312)))))))));
	accum[0] = ((1.0/4.0)*((-1.0*p012)+p312));
	accum[1] = 0.0;
	pixel[1] = ((1.0/240240.0)*((13.0*((-1.0*p012*((378.0*p102)+(63.0*p202)+(30.0*p20*p30)+(5.0*p302)+(42.0*p10*((6.0*p20)+p30))))+(-1.0*p002*((2310.0*p012)+(-378.0*p112)+(-63.0*p212)+(-30.0*p21*p31)+(-5.0*p312)+(-42.0*p11*((6.0*p21)+p31))+(-28.0*p01*((45.0*p11)+(9.0*p21)+p31))))+(-2.0*p00*((-126.0*p10*p112)+(-189.0*p10*p11*p21)+(-54.0*p11*p20*p21)+(-81.0*p10*p212)+(-45.0*p20*p212)+(9.0*p112*p30)+(-9.0*p212*p30)+(14.0*p012*((45.0*p10)+(9.0*p20)+p30))+(-54.0*p10*p11*p31)+(-30.0*p11*p20*p31)+(-60.0*p10*p21*p31)+(-54.0*p20*p21*p31)+(-6.0*p11*p30*p31)+(-21.0*p21*p30*p31)+(-15.0*p10*p312)+(-21.0*p20*p312)+(-14.0*p30*p312)+(3.0*p01*((2.0*p21*p30)+(7.0*p11*((4.0*p20)+p30))+(-2.0*p20*p31)+(-7.0*p10*((4.0*p21)+p31))))))+(-2.0*p01*((45.0*p202*p21)+(54.0*p20*p21*p30)+(21.0*p21*p302)+(3.0*p11*((27.0*p202)+(20.0*p20*p30)+(5.0*p302)))+(9.0*p102*((14.0*p11)+(-1.0*p31)))+(9.0*p202*p31)+(21.0*p20*p30*p31)+(14.0*p302*p31)+(3.0*p10*((9.0*p11*((7.0*p20)+(2.0*p30)))+(2.0*((9.0*p20*p21)+(5.0*p21*p30)+(p30*p31)))))))+(3.0*((-3.0*p112*((15.0*p202)+(18.0*p20*p30)+(7.0*p302)))+(-2.0*p11*((27.0*p202*p21)+(42.0*p302*(p21+p31))+(7.0*p20*p30*((9.0*p21)+(4.0*p31)))))+(3.0*p102*((15.0*p212)+(18.0*p21*p31)+(7.0*p312)+(2.0*p11*((9.0*p21)+(5.0*p31)))))+(p10*((-6.0*p112*((9.0*p20)+(5.0*p30)))+(28.0*p30*p31*((2.0*p21)+(3.0*p31)))+(-36.0*p11*((p21*p30)+(-1.0*p20*p31)))+(6.0*p20*((9.0*p212)+(21.0*p21*p31)+(14.0*p312)))))+(14.0*((3.0*p202*p31*((2.0*p21)+(3.0*p31)))+(-6.0*p20*p30*(p212+(-5.0*p312)))+(p302*((-9.0*p212)+(-30.0*p21*p31)+(55.0*p312)))))))))+(2.0*((324.0*p102*p112*p20)+(486.0*p10*p112*p202)+(243.0*p112*p203)+(-324.0*p103*p11*p21)+(-243.0*p102*p11*p20*p21)+(243.0*p10*p11*p202*p21)+(324.0*p11*p203*p21)+(-243.0*p103*p212)+(-486.0*p102*p20*p212)+(-324.0*p10*p202*p212)+(162.0*p102*p112*p30)+(486.0*p10*p112*p20*p30)+(432.0*p112*p202*p30)+(81.0*p102*p11*p21*p30)+(648.0*p10*p11*p20*p21*p30)+(972.0*p11*p202*p21*p30)+(-108.0*p102*p212*p30)+(486.0*p202*p212*p30)+(144.0*p10*p112*p302)+(324.0*p112*p20*p302)+(324.0*p10*p11*p21*p302)+(1134.0*p11*p20*p21*p302)+(162.0*p10*p212*p302)+(1188.0*p20*p212*p302)+(108.0*p112*p303)+(594.0*p11*p21*p303)+(1188.0*p212*p303)+(p012*((594.0*p103)+(72.0*p203)+(63.0*p202*p30)+(24.0*p20*p302)+(4.0*p303)+(108.0*p102*((6.0*p20)+p30))+(3.0*p10*((108.0*p202)+(48.0*p20*p30)+(7.0*p302)))))+(-162.0*p103*p11*p31)+(-324.0*p102*p11*p20*p31)+(-216.0*p10*p11*p202*p31)+(-243.0*p103*p21*p31)+(-756.0*p102*p20*p21*p31)+(-972.0*p10*p202*p21*p31)+(-486.0*p203*p21*p31)+(-72.0*p102*p11*p30*p31)+(324.0*p11*p202*p30*p31)+(-324.0*p102*p21*p30*p31)+(-972.0*p10*p20*p21*p30*p31)+(-594.0*p202*p21*p30*p31)+(108.0*p10*p11*p302*p31)+(792.0*p11*p20*p302*p31)+(-198.0*p10*p21*p302*p31)+(1188.0*p20*p21*p302*p31)+(792.0*p11*p303*p31)+(5148.0*p21*p303*p31)+(-72.0*p103*p312)+(-324.0*p102*p20*p312)+(-648.0*p10*p202*p312)+(-594.0*p203*p312)+(-216.0*p102*p30*p312)+(-1188.0*p10*p20*p30*p312)+(-2376.0*p202*p30*p312)+(-792.0*p10*p302*p312)+(-5148.0*p20*p302*p312)+(-8008.0*p303*p312)+(2.0*p003*((4004.0*p012)+(-594.0*p112)+(-33.0*p01*((78.0*p11)+(12.0*p21)+p31))+(-9.0*p11*((33.0*p21)+(4.0*p31)))+(-2.0*((27.0*p212)+(9.0*p21*p31)+p312))))+(3.0*p01*((81.0*p11*p203)+(54.0*p203*p21)+(99.0*p11*p202*p30)+(96.0*p202*p21*p30)+(52.0*p11*p20*p302)+(72.0*p20*p21*p302)+(12.0*p11*p303)+(24.0*p21*p303)+(6.0*p103*((27.0*p11)+(-2.0*p31)))+(12.0*p203*p31)+(36.0*p202*p30*p31)+(42.0*p20*p302*p31)+(22.0*p303*p31)+(3.0*p102*((24.0*p20*p21)+(12.0*p21*p30)+(4.0*p11*((27.0*p20)+(7.0*p30)))+(-3.0*p20*p31)+(p30*p31)))+(p10*((3.0*p11*((84.0*p202)+(54.0*p20*p30)+(11.0*p302)))+(9.0*p202*((12.0*p21)+p31))+(12.0*p20*p30*((9.0*p21)+(2.0*p31)))+(4.0*p302*((8.0*p21)+(3.0*p31)))))))+(p002*((-1188.0*p10*p112)+(-162.0*p112*p20)+(-1134.0*p10*p11*p21)+(-324.0*p11*p20*p21)+(-324.0*p10*p212)+(-144.0*p20*p212)+(-36.0*p11*p21*p30)+(-27.0*p212*p30)+(66.0*p012*((78.0*p10)+(12.0*p20)+p30))+(-216.0*p10*p11*p31)+(-96.0*p11*p20*p31)+(-156.0*p10*p21*p31)+(-99.0*p20*p21*p31)+(-18.0*p11*p30*p31)+(-27.0*p21*p30*p31)+(-24.0*p10*p312)+(-21.0*p20*p312)+(-8.0*p30*p312)+(-2.0*p01*((-99.0*p11*p20)+(54.0*p20*p21)+(-27.0*p11*p30)+(18.0*p20*p31)+(2.0*p30*p31)+(9.0*p10*((66.0*p11)+(44.0*p21)+(7.0*p31)))))))+(p00*((4.0*p012*((594.0*p102)+(9.0*p10*((33.0*p20)+(4.0*p30)))+(2.0*((27.0*p202)+(9.0*p20*p30)+p302))))+(p01*((72.0*p202*p21)+(72.0*p20*p21*p30)+(18.0*p21*p302)+(3.0*p11*((108.0*p202)+(56.0*p20*p30)+(9.0*p302)))+(-9.0*p202*p31)+(6.0*p20*p30*p31)+(4.0*p302*p31)+(6.0*p10*((8.0*p21*p30)+(18.0*p11*((9.0*p20)+(2.0*p30)))+(-1.0*((12.0*p20)+p30)*p31)))+(54.0*p102*((11.0*p11)+(-2.0*((3.0*p21)+p31))))))+(-3.0*((54.0*p202*p212)+(24.0*p20*p212*p30)+(-9.0*p112*(((2.0*p20)+p30)*((2.0*p20)+p30)))+(84.0*p202*p21*p31)+(72.0*p20*p21*p30*p31)+(18.0*p21*p302*p31)+(36.0*p202*p312)+(48.0*p20*p30*p312)+(22.0*p302*p312)+(p11*((-12.0*p21*p302)+(-2.0*p20*p30*((9.0*p21)+(-8.0*p31)))+(9.0*p202*((3.0*p21)+(4.0*p31)))))+(3.0*p102*((54.0*p112)+(48.0*p212)+(33.0*p21*p31)+(7.0*p312)+(4.0*p11*((27.0*p21)+(8.0*p31)))))+(2.0*p10*((-12.0*p112*p30)+(2.0*p30*((9.0*p212)+(14.0*p21*p31)+(6.0*p312)))+(3.0*p20*((27.0*p212)+(27.0*p21*p31)+(8.0*p312)))+(3.0*p11*((18.0*p20*((2.0*p21)+p31))+(p30*((3.0*p21)+(4.0*p31)))))))))))))));
	accum[2] = ((1.0/6.0)*(p012+(-1.0*p312)));
	accum[3] = ((1.0/4.0)*((-1.0*p012)+p312));
	pixel[2] = ((1.0/120120.0)*((2.0*p013*((594.0*p102)+(54.0*p202)+(9.0*p20*(-91.0+(2.0*p30)))+(p30*(-91.0+(2.0*p30)))+(9.0*p10*(-455.0+(33.0*p20)+(4.0*p30)))))+(p012*((-819.0*p20*p21)+(144.0*p202*p21)+(54.0*p102*((22.0*p11)+(3.0*p21)))+(-273.0*p21*p30)+(99.0*p20*p21*p30)+(21.0*p21*p302)+(6.0*p11*((54.0*p202)+(13.0*p20*(-35.0+(2.0*p30)))+(p30*(-91.0+(4.0*p30)))))+(-117.0*p20*p31)+(27.0*p202*p31)+(-65.0*p30*p31)+(27.0*p20*p30*p31)+(8.0*p302*p31)+(6.0*p10*((9.0*p11*(-91.0+(21.0*p20)+(4.0*p30)))+(p21*(-91.0+(54.0*p20)+(16.0*p30)))+(3.0*((2.0*p20)+p30)*p31)))))+(p00*((585.0*p213)+(-243.0*p10*p213)+(-162.0*p20*p213)+(-18.0*p113*(-91.0+(27.0*p10)+(-2.0*p30)))+(-36.0*p213*p30)+(66.0*p013*(-455.0+(78.0*p10)+(12.0*p20)+p30))+(819.0*p212*p31)+(-297.0*p10*p212*p31)+(-288.0*p20*p212*p31)+(-108.0*p212*p30*p31)+(546.0*p21*p312)+(-156.0*p10*p21*p312)+(-216.0*p20*p21*p312)+(-126.0*p21*p30*p312)+(182.0*p313)+(-36.0*p10*p313)+(-72.0*p20*p313)+(-66.0*p30*p313)+(-9.0*p112*((3.0*p21*(-91.0+(36.0*p10)+(8.0*p20)+(-1.0*p30)))+((-65.0+(28.0*p10)+(12.0*p20)+p30)*p31)))+(2.0*p012*((9.0*p21*(91.0+(-11.0*p10)+(6.0*p20)+(2.0*p30)))+(9.0*p11*(455.0+(66.0*p10)+(44.0*p20)+(7.0*p30)))+((91.0+(-27.0*p10)+(2.0*p30))*p31)))+(-3.0*p11*((9.0*p212*(-65.0+(28.0*p10)+(12.0*p20)+p30))+(6.0*p21*(-65.0+(27.0*p10)+(18.0*p20)+(4.0*p30))*p31)+((-91.0+(33.0*p10)+(32.0*p20)+(12.0*p30))*p312)))+(p01*((-54.0*p112*(-91.0+(11.0*p10)+(-6.0*p20)+(-2.0*p30)))+(-9.0*p212*(-91.0+(36.0*p10)+(8.0*p20)+(-1.0*p30)))+(-6.0*p21*(-65.0+(28.0*p10)+(12.0*p20)+p30)*p31)+(-1.0*(-65.0+(27.0*p10)+(18.0*p20)+(4.0*p30))*p312)+(-6.0*p11*((6.0*p21*(-91.0+(27.0*p10)+(-2.0*p30)))+((-91.0+(36.0*p10)+(8.0*p20)+(-1.0*p30))*p31)))))))+(p002*((12012.0*p013)+(-594.0*p113)+(-72.0*p213)+(-63.0*p212*p31)+(-24.0*p21*p312)+(-4.0*p313)+(-108.0*p112*((6.0*p21)+p31))+(-66.0*p012*((78.0*p11)+(12.0*p21)+p31))+(-3.0*p11*((108.0*p212)+(48.0*p21*p31)+(7.0*p312)))+(-4.0*p01*((594.0*p112)+(9.0*p11*((33.0*p21)+(4.0*p31)))+(2.0*((27.0*p212)+(9.0*p21*p31)+p312))))))+(3.0*((3.0*p113*((27.0*p202)+(9.0*p20*(-13.0+(4.0*p10)+(3.0*p30)))+(p30*(-65.0+(18.0*p10)+(8.0*p30)))))+(-9.0*p102*((9.0*p213)+(16.0*p212*p31)+(12.0*p21*p312)+(4.0*p313)))+(-1.0*p10*((27.0*(-13.0+(4.0*p20))*p213)+(9.0*p212*(-91.0+(36.0*p20)+(12.0*p30))*p31)+(2.0*p21*(-455.0+(189.0*p20)+(132.0*p30))*p312)+(6.0*(-91.0+(33.0*p20)+(44.0*p30))*p313)))+(-2.0*((-3.0*p213*p30*(-91.0+(27.0*p20)+(33.0*p30)))+(3.0*p212*((27.0*p202)+(3.0*(91.0+(-44.0*p30))*p30)+(-1.0*p20*(91.0+(33.0*p30))))*p31)+(3.0*p21*((66.0*p202)+(13.0*(35.0+(-22.0*p30))*p30)+(3.0*p20*(-91.0+(22.0*p30))))*p312)+(((198.0*p202)+(1001.0*p30*(-5.0+(2.0*p30)))+(39.0*p20*(-35.0+(22.0*p30))))*p313)))+(-3.0*p112*((18.0*p102*((2.0*p21)+p31))+(-6.0*p202*((9.0*p21)+(2.0*p31)))+(p20*((195.0*p21)+(-84.0*p21*p30)+(39.0*p31)+(-36.0*p30*p31)))+(p30*((195.0*p21)+(-36.0*p21*p30)+(91.0*p31)+(-24.0*p30*p31)))+(-1.0*p10*((9.0*p21*(13.0+(3.0*p20)+(4.0*p30)))+((65.0+(-9.0*p20)+(8.0*p30))*p31)))))+(p11*((54.0*p202*((2.0*p212)+(-1.0*p312)))+(-6.0*p102*((27.0*p212)+(27.0*p21*p31)+(8.0*p312)))+(-3.0*p10*((3.0*p212*(-65.0+(9.0*p20)+(-8.0*p30)))+(18.0*(-13.0+(4.0*p20))*p21*p31)+((-91.0+(36.0*p20)+(12.0*p30))*p312)))+(p20*((27.0*p212*(-13.0+(12.0*p30)))+(324.0*p21*p30*p31)+(2.0*(91.0+(33.0*p30))*p312)))+(3.0*p30*((3.0*p212*(-91.0+(24.0*p30)))+(4.0*p21*(-91.0+(33.0*p30))*p31)+(2.0*(-91.0+(44.0*p30))*p312)))))))+(p01*((-585.0*p20*p212)+(162.0*p202*p212)+(-585.0*p212*p30)+(252.0*p20*p212*p30)+(108.0*p212*p302)+(9.0*p112*((48.0*p202)+(7.0*(-13.0+p30)*p30)+(3.0*p20*(-91.0+(11.0*p30)))))+(-234.0*p20*p21*p31)+(72.0*p202*p21*p31)+(-546.0*p21*p30*p31)+(216.0*p20*p21*p30*p31)+(144.0*p21*p302*p31)+(-182.0*p30*p312)+(54.0*p20*p30*p312)+(66.0*p302*p312)+(9.0*p102*((54.0*p112)+(-8.0*p11*p31)+(-3.0*(((2.0*p21)+p31)*((2.0*p21)+p31)))))+(6.0*p11*((9.0*p202*((9.0*p21)+(2.0*p31)))+(p30*((3.0*p21*(-65.0+(8.0*p30)))+((-65.0+(12.0*p30))*p31)))+(p20*((27.0*p21*(-13.0+(3.0*p30)))+((-65.0+(28.0*p30))*p31)))))+(3.0*p10*((9.0*p212*(13.0+(3.0*p20)+(4.0*p30)))+(6.0*p112*(-91.0+(54.0*p20)+(16.0*p30)))+(-2.0*p21*(-65.0+(9.0*p20)+(-8.0*p30))*p31)+(3.0*(13.0+(-4.0*p20))*p312)+(6.0*p11*((18.0*p21*p30)+(13.0*p31)+(4.0*p30*p31)+(3.0*p20*((12.0*p21)+p31))))))))));
	accum[4] = ((1.0/6.0)*((-1.0*p013)+p313));
	accum[5] = 0.0;
}
static void cube_01(double *pixel, double *accum, Curve<4,2> *curve)
{
	const double &p00 = curve->p[0].v[0];
	const double &p01 = curve->p[0].v[1];
	const double &p10 = curve->p[1].v[0];
	const double &p11 = curve->p[1].v[1];
	const double &p20 = curve->p[2].v[0];
	const double &p21 = curve->p[2].v[1];
	const double &p30 = curve->p[3].v[0];
	const double &p31 = curve->p[3].v[1];
	const double p002 = p00*p00;
	const double p012 = p01*p01;
	const double p102 = p10*p10;
	const double p112 = p11*p11;
	const double p202 = p20*p20;
	const double p212 = p21*p21;
	const double p302 = p30*p30;
	const double p312 = p31*p31;
	const double p003 = p00*p002;
	const double p013 = p01*p012;
	const double p103 = p10*p102;
	const double p113 = p11*p112;
	const double p203 = p20*p202;
	const double p213 = p21*p212;
	const double p303 = p30*p302;
	const double p313 = p31*p312;
	pixel[0] = ((1.0/18480.0)*((p012*((378.0*p102)+(63.0*p202)+(30.0*p20*p30)+(5.0*p302)+(42.0*p10*((6.0*p20)+p30))))+(p002*((2310.0*p012)+(-378.0*p112)+(-63.0*p212)+(-30.0*p21*p31)+(-5.0*p312)+(-42.0*p11*((6.0*p21)+p31))+(-28.0*p01*((45.0*p11)+(9.0*p21)+p31))))+(22.0*((-27.0*p10*p11*p20)+(-27.0*p11*p202)+(27.0*p102*p21)+(27.0*p10*p20*p21)+(-18.0*p10*p11*p30)+(-45.0*p11*p20*p30)+(-45.0*p20*p21*p30)+(-30.0*p11*p302)+(-105.0*p21*p302)+(-1.0*p01*((45.0*p102)+(45.0*p10*p20)+(18.0*p202)+(12.0*p10*p30)+(15.0*p20*p30)+(5.0*p302)))+(18.0*p102*p31)+(45.0*p10*p20*p31)+(45.0*p202*p31)+(30.0*p10*p30*p31)+(105.0*p20*p30*p31)+(140.0*p302*p31)+(5.0*p002*((-28.0*p01)+(21.0*p11)+(6.0*p21)+p31))+(p00*((18.0*p20*p21)+(-3.0*p11*p30)+(3.0*p21*p30)+(-5.0*p01*((21.0*p10)+(6.0*p20)+p30))+(12.0*p20*p31)+(5.0*p30*p31)+(15.0*p10*((3.0*p11)+(3.0*p21)+p31))))))+(2.0*p00*((-126.0*p10*p112)+(-189.0*p10*p11*p21)+(-54.0*p11*p20*p21)+(-81.0*p10*p212)+(-45.0*p20*p212)+(9.0*p112*p30)+(-9.0*p212*p30)+(14.0*p012*((45.0*p10)+(9.0*p20)+p30))+(-54.0*p10*p11*p31)+(-30.0*p11*p20*p31)+(-60.0*p10*p21*p31)+(-54.0*p20*p21*p31)+(-6.0*p11*p30*p31)+(-21.0*p21*p30*p31)+(-15.0*p10*p312)+(-21.0*p20*p312)+(-14.0*p30*p312)+(3.0*p01*((2.0*p21*p30)+(7.0*p11*((4.0*p20)+p30))+(-2.0*p20*p31)+(-7.0*p10*((4.0*p21)+p31))))))+(2.0*p01*((45.0*p202*p21)+(54.0*p20*p21*p30)+(21.0*p21*p302)+(3.0*p11*((27.0*p202)+(20.0*p20*p30)+(5.0*p302)))+(9.0*p102*((14.0*p11)+(-1.0*p31)))+(9.0*p202*p31)+(21.0*p20*p30*p31)+(14.0*p302*p31)+(3.0*p10*((9.0*p11*((7.0*p20)+(2.0*p30)))+(2.0*((9.0*p20*p21)+(5.0*p21*p30)+(p30*p31)))))))+(-3.0*((-3.0*p112*((15.0*p202)+(18.0*p20*p30)+(7.0*p302)))+(-2.0*p11*((27.0*p202*p21)+(42.0*p302*(p21+p31))+(7.0*p20*p30*((9.0*p21)+(4.0*p31)))))+(3.0*p102*((15.0*p212)+(18.0*p21*p31)+(7.0*p312)+(2.0*p11*((9.0*p21)+(5.0*p31)))))+(p10*((-6.0*p112*((9.0*p20)+(5.0*p30)))+(28.0*p30*p31*((2.0*p21)+(3.0*p31)))+(-36.0*p11*((p21*p30)+(-1.0*p20*p31)))+(6.0*p20*((9.0*p212)+(21.0*p21*p31)+(14.0*p312)))))+(14.0*((3.0*p202*p31*((2.0*p21)+(3.0*p31)))+(-6.0*p20*p30*(p212+(-5.0*p312)))+(p302*((-9.0*p212)+(-30.0*p21*p31)+(55.0*p312)))))))));
	accum[0] = ((1.0/4.0)*((-2.0*p01)+p012+(-1.0*(-2.0+p31)*p31)));
	accum[1] = 0.0;
	pixel[1] = ((1.0/120120.0)*((-1053.0*p102*p11*p20)+(324.0*p102*p112*p20)+(-1755.0*p10*p11*p202)+(486.0*p10*p112*p202)+(-1053.0*p11*p203)+(243.0*p112*p203)+(1053.0*p103*p21)+(-324.0*p103*p11*p21)+(1755.0*p102*p20*p21)+(-243.0*p102*p11*p20*p21)+(1053.0*p10*p202*p21)+(243.0*p10*p11*p202*p21)+(324.0*p11*p203*p21)+(-243.0*p103*p212)+(-486.0*p102*p20*p212)+(-324.0*p10*p202*p212)+(-585.0*p102*p11*p30)+(162.0*p102*p112*p30)+(-2106.0*p10*p11*p20*p30)+(486.0*p10*p112*p20*p30)+(-2457.0*p11*p202*p30)+(432.0*p112*p202*p30)+(351.0*p102*p21*p30)+(81.0*p102*p11*p21*p30)+(648.0*p10*p11*p20*p21*p30)+(-1638.0*p202*p21*p30)+(972.0*p11*p202*p21*p30)+(-108.0*p102*p212*p30)+(486.0*p202*p212*p30)+(-819.0*p10*p11*p302)+(144.0*p10*p112*p302)+(-2730.0*p11*p20*p302)+(324.0*p112*p20*p302)+(-546.0*p10*p21*p302)+(324.0*p10*p11*p21*p302)+(-4914.0*p20*p21*p302)+(1134.0*p11*p20*p21*p302)+(162.0*p10*p212*p302)+(1188.0*p20*p212*p302)+(-1638.0*p11*p303)+(108.0*p112*p303)+(-8190.0*p21*p303)+(594.0*p11*p21*p303)+(1188.0*p212*p303)+(p012*((594.0*p103)+(72.0*p203)+(63.0*p202*p30)+(24.0*p20*p302)+(4.0*p303)+(108.0*p102*((6.0*p20)+p30))+(3.0*p10*((108.0*p202)+(48.0*p20*p30)+(7.0*p302)))))+(585.0*p103*p31)+(-162.0*p103*p11*p31)+(1755.0*p102*p20*p31)+(-324.0*p102*p11*p20*p31)+(2457.0*p10*p202*p31)+(-216.0*p10*p11*p202*p31)+(1638.0*p203*p31)+(-243.0*p103*p21*p31)+(-756.0*p102*p20*p21*p31)+(-972.0*p10*p202*p21*p31)+(-486.0*p203*p21*p31)+(819.0*p102*p30*p31)+(-72.0*p102*p11*p30*p31)+(3276.0*p10*p20*p30*p31)+(4914.0*p202*p30*p31)+(324.0*p11*p202*p30*p31)+(-324.0*p102*p21*p30*p31)+(-972.0*p10*p20*p21*p30*p31)+(-594.0*p202*p21*p30*p31)+(1638.0*p10*p302*p31)+(108.0*p10*p11*p302*p31)+(8190.0*p20*p302*p31)+(792.0*p11*p20*p302*p31)+(-198.0*p10*p21*p302*p31)+(1188.0*p20*p21*p302*p31)+(10010.0*p303*p31)+(792.0*p11*p303*p31)+(5148.0*p21*p303*p31)+(-72.0*p103*p312)+(-324.0*p102*p20*p312)+(-648.0*p10*p202*p312)+(-594.0*p203*p312)+(-216.0*p102*p30*p312)+(-1188.0*p10*p20*p30*p312)+(-2376.0*p202*p30*p312)+(-792.0*p10*p302*p312)+(-5148.0*p20*p302*p312)+(-8008.0*p303*p312)+(2.0*p003*((4004.0*p012)+(-594.0*p112)+(819.0*p21)+(-54.0*p212)+(91.0*p31)+(-18.0*p21*p31)+(-2.0*p312)+(-11.0*p01*(455.0+(234.0*p11)+(36.0*p21)+(3.0*p31)))+(-9.0*p11*(-455.0+(33.0*p21)+(4.0*p31)))))+(p002*((546.0*p11*p20)+(-162.0*p112*p20)+(819.0*p20*p21)+(-324.0*p11*p20*p21)+(-144.0*p20*p212)+(117.0*p21*p30)+(-36.0*p11*p21*p30)+(-27.0*p212*p30)+(66.0*p012*((78.0*p10)+(12.0*p20)+p30))+(273.0*p20*p31)+(-96.0*p11*p20*p31)+(-99.0*p20*p21*p31)+(65.0*p30*p31)+(-18.0*p11*p30*p31)+(-27.0*p21*p30*p31)+(-21.0*p20*p312)+(-8.0*p30*p312)+(-6.0*p10*((198.0*p112)+(54.0*p212)+(13.0*p21*(-35.0+(2.0*p31)))+(p31*(-91.0+(4.0*p31)))+(9.0*p11*(-91.0+(21.0*p21)+(4.0*p31)))))+(-2.0*p01*((p30*(91.0+(-27.0*p11)+(2.0*p31)))+(9.0*p20*(91.0+(-11.0*p11)+(6.0*p21)+(2.0*p31)))+(9.0*p10*(455.0+(66.0*p11)+(44.0*p21)+(7.0*p31)))))))+(p01*((18.0*p103*(-91.0+(27.0*p11)+(-2.0*p31)))+(9.0*p203*(-65.0+(27.0*p11)+(18.0*p21)+(4.0*p31)))+(9.0*p202*p30*(-91.0+(33.0*p11)+(32.0*p21)+(12.0*p31)))+(6.0*p20*p302*(-91.0+(26.0*p11)+(36.0*p21)+(21.0*p31)))+(2.0*p303*(-91.0+(18.0*p11)+(36.0*p21)+(33.0*p31)))+(9.0*p102*((3.0*p20*(-91.0+(36.0*p11)+(8.0*p21)+(-1.0*p31)))+(p30*(-65.0+(28.0*p11)+(12.0*p21)+p31))))+(3.0*p10*((9.0*p202*(-65.0+(28.0*p11)+(12.0*p21)+p31))+(6.0*p20*p30*(-65.0+(27.0*p11)+(18.0*p21)+(4.0*p31)))+(p302*(-91.0+(33.0*p11)+(32.0*p21)+(12.0*p31)))))))+(p00*((-351.0*p11*p202)+(108.0*p112*p202)+(585.0*p202*p21)+(-81.0*p11*p202*p21)+(-162.0*p202*p212)+(-390.0*p11*p20*p30)+(108.0*p112*p20*p30)+(234.0*p20*p21*p30)+(54.0*p11*p20*p21*p30)+(-72.0*p20*p212*p30)+(-117.0*p11*p302)+(27.0*p112*p302)+(36.0*p11*p21*p302)+(4.0*p012*((594.0*p102)+(9.0*p10*((33.0*p20)+(4.0*p30)))+(2.0*((27.0*p202)+(9.0*p20*p30)+p302))))+(585.0*p202*p31)+(-108.0*p11*p202*p31)+(-252.0*p202*p21*p31)+(546.0*p20*p30*p31)+(-48.0*p11*p20*p30*p31)+(-216.0*p20*p21*p30*p31)+(182.0*p302*p31)+(-54.0*p21*p302*p31)+(-108.0*p202*p312)+(-144.0*p20*p30*p312)+(-66.0*p302*p312)+(p01*((6.0*p10*((6.0*p20*(-91.0+(27.0*p11)+(-2.0*p31)))+(p30*(-91.0+(36.0*p11)+(8.0*p21)+(-1.0*p31)))))+(54.0*p102*(-91.0+(11.0*p11)+(-6.0*p21)+(-2.0*p31)))+(9.0*p202*(-91.0+(36.0*p11)+(8.0*p21)+(-1.0*p31)))+(6.0*p20*p30*(-65.0+(28.0*p11)+(12.0*p21)+p31))+(p302*(-65.0+(27.0*p11)+(18.0*p21)+(4.0*p31)))))+(-9.0*p102*((54.0*p112)+(48.0*p212)+(7.0*(-13.0+p31)*p31)+(3.0*p21*(-91.0+(11.0*p31)))+(2.0*p11*(-91.0+(54.0*p21)+(16.0*p31)))))+(-6.0*p10*((3.0*p20*((27.0*p212)+(9.0*p21*(-13.0+(4.0*p11)+(3.0*p31)))+(p31*(-65.0+(18.0*p11)+(8.0*p31)))))+(p30*((-12.0*p112)+(18.0*p212)+(3.0*p11*(13.0+(3.0*p21)+(4.0*p31)))+(p31*(-65.0+(12.0*p31)))+(p21*(-65.0+(28.0*p31)))))))))));
	accum[2] = ((1.0/12.0)*((2.0*p01)+(-1.0*p012)+((-2.0+p31)*p31)));
	accum[3] = ((1.0/4.0)*((-2.0*p01)+p012+(-1.0*(-2.0+p31)*p31)));
	pixel[2] = ((1.0/240240.0)*((4.0*p013*((594.0*p102)+(9.0*p10*((33.0*p20)+(4.0*p30)))+(2.0*((27.0*p202)+(9.0*p20*p30)+p302))))+(p012*((54.0*p102*(-91.0+(44.0*p11)+(6.0*p21)))+(9.0*p202*(-91.0+(72.0*p11)+(32.0*p21)+(6.0*p31)))+(6.0*p20*p30*(-65.0+(52.0*p11)+(33.0*p21)+(9.0*p31)))+(p302*(-65.0+(48.0*p11)+(42.0*p21)+(16.0*p31)))+(6.0*p10*((6.0*p20*(-91.0+(63.0*p11)+(18.0*p21)+(2.0*p31)))+(p30*(-91.0+(72.0*p11)+(32.0*p21)+(6.0*p31)))))))+(p002*((24024.0*p013)+(-1188.0*p113)+(819.0*p212)+(-144.0*p213)+(390.0*p21*p31)+(-126.0*p212*p31)+(65.0*p312)+(-48.0*p21*p312)+(-8.0*p313)+(-66.0*p012*(455.0+(156.0*p11)+(24.0*p21)+(2.0*p31)))+(-54.0*p112*(-91.0+(24.0*p21)+(4.0*p31)))+(-6.0*p11*((108.0*p212)+(7.0*(-13.0+p31)*p31)+(6.0*p21*(-91.0+(8.0*p31)))))+(-4.0*p01*((1188.0*p112)+(108.0*p212)+(9.0*p21*(-91.0+(4.0*p31)))+(p31*(-91.0+(4.0*p31)))+(9.0*p11*(-455.0+(66.0*p21)+(8.0*p31)))))))+(2.0*p01*((-585.0*p202*p21)+(162.0*p202*p212)+(-702.0*p20*p21*p30)+(252.0*p20*p212*p30)+(-273.0*p21*p302)+(108.0*p212*p302)+(9.0*p112*((48.0*p202)+(33.0*p20*p30)+(7.0*p302)))+(-117.0*p202*p31)+(72.0*p202*p21*p31)+(-273.0*p20*p30*p31)+(216.0*p20*p21*p30*p31)+(-182.0*p302*p31)+(144.0*p21*p302*p31)+(54.0*p20*p30*p312)+(66.0*p302*p312)+(9.0*p102*((54.0*p112)+(-12.0*p212)+(-12.0*p21*p31)+((13.0+(-3.0*p31))*p31)+(-2.0*p11*(91.0+(4.0*p31)))))+(3.0*p11*((9.0*p202*(-39.0+(18.0*p21)+(4.0*p31)))+(p302*(-65.0+(48.0*p21)+(24.0*p31)))+(2.0*p20*p30*(-130.0+(81.0*p21)+(28.0*p31)))))+(3.0*p10*((12.0*p112*((27.0*p20)+(8.0*p30)))+(3.0*p20*((9.0*p212)+(-4.0*p312)+(-6.0*p21*(13.0+p31))))+(3.0*p11*((3.0*p20*(-91.0+(24.0*p21)+(2.0*p31)))+(2.0*p30*(-39.0+(18.0*p21)+(4.0*p31)))))+(2.0*p30*((18.0*p212)+(-13.0*p31)+(p21*(-65.0+(8.0*p31)))))))))+(2.0*p00*((702.0*p11*p20*p21)+(-216.0*p112*p20*p21)+(585.0*p20*p212)+(-324.0*p11*p20*p212)+(-162.0*p20*p213)+(-117.0*p112*p30)+(36.0*p113*p30)+(27.0*p112*p21*p30)+(117.0*p212*p30)+(-27.0*p11*p212*p30)+(-36.0*p213*p30)+(66.0*p013*((78.0*p10)+(12.0*p20)+p30))+(390.0*p11*p20*p31)+(-108.0*p112*p20*p31)+(702.0*p20*p21*p31)+(-324.0*p11*p20*p21*p31)+(-288.0*p20*p212*p31)+(78.0*p11*p30*p31)+(-9.0*p112*p30*p31)+(273.0*p21*p30*p31)+(-72.0*p11*p21*p30*p31)+(-108.0*p212*p30*p31)+(273.0*p20*p312)+(-96.0*p11*p20*p312)+(-216.0*p20*p21*p312)+(182.0*p30*p312)+(-36.0*p11*p30*p312)+(-126.0*p21*p30*p312)+(-72.0*p20*p313)+(-66.0*p30*p313)+(2.0*p012*((9.0*p20*(-91.0+(44.0*p11)+(6.0*p21)))+(9.0*p10*(-455.0+(66.0*p11)+(-11.0*p21)+(-3.0*p31)))+(p30*(-91.0+(63.0*p11)+(18.0*p21)+(2.0*p31)))))+(-1.0*p01*((72.0*p20*p212)+(78.0*p21*p30)+(-9.0*p212*p30)+(-108.0*p112*((3.0*p20)+p30))+(-78.0*p20*p31)+(72.0*p20*p21*p31)+(6.0*p21*p30*p31)+(18.0*p20*p312)+(4.0*p30*p312)+(3.0*p11*((p30*(91.0+(-24.0*p21)+(-2.0*p31)))+(4.0*p20*(91.0+(4.0*p31)))))+(3.0*p10*((198.0*p112)+(108.0*p212)+(28.0*p21*(-13.0+(2.0*p31)))+(36.0*p11*((9.0*p21)+(2.0*p31)))+(p31*(-91.0+(9.0*p31)))))))+(-3.0*p10*((162.0*p113)+(81.0*p213)+(52.0*p21*(-5.0+p31)*p31)+(9.0*p212*(-39.0+(11.0*p31)))+(p312*(-65.0+(12.0*p31)))+(6.0*p112*(-91.0+(54.0*p21)+(14.0*p31)))+(3.0*p11*((84.0*p212)+(p31*(-78.0+(11.0*p31)))+(3.0*p21*(-91.0+(18.0*p31)))))))))+(-3.0*((-6.0*p113*((27.0*p202)+(27.0*p20*p30)+(8.0*p302)))+(-3.0*p112*((3.0*p202*(-65.0+(36.0*p21)+(8.0*p31)))+(6.0*p20*p30*(-39.0+(28.0*p21)+(12.0*p31)))+(p302*(-91.0+(72.0*p21)+(48.0*p31)))))+(3.0*p102*((54.0*p213)+(36.0*p112*((2.0*p21)+p31))+(18.0*p21*p31*(-13.0+(4.0*p31)))+(p312*(-91.0+(24.0*p31)))+(3.0*p212*(-65.0+(32.0*p31)))+(2.0*p11*((54.0*p212)+(9.0*p21*(-13.0+(6.0*p31)))+(p31*(-65.0+(16.0*p31)))))))+(-2.0*p11*((27.0*p202*((-13.0*p21)+(4.0*p212)+(-2.0*p312)))+(p20*p30*((324.0*p212)+(2.0*p31*(-182.0+(33.0*p31)))+(9.0*p21*(-91.0+(36.0*p31)))))+(6.0*p302*((36.0*p212)+(p31*(-91.0+(44.0*p31)))+(p21*(-91.0+(66.0*p31)))))))+(2.0*((-6.0*p20*p30*((27.0*p213)+(-66.0*p21*p312)+(13.0*(35.0+(-22.0*p31))*p312)+(p212*(-91.0+(33.0*p31)))))+(3.0*p202*p31*((54.0*p212)+(3.0*p31*(-91.0+(44.0*p31)))+(2.0*p21*(-91.0+(66.0*p31)))))+(p302*((-198.0*p213)+(1001.0*p312*(-5.0+(4.0*p31)))+(-78.0*p21*p31*(-35.0+(22.0*p31)))+(-9.0*p212*(-91.0+(88.0*p31)))))))+(-2.0*p10*((54.0*p113*((2.0*p20)+p30))+(3.0*p112*((9.0*p20*(-13.0+(3.0*p21)+(-1.0*p31)))+(p30*(-65.0+(36.0*p21)+(8.0*p31)))))+(-3.0*p20*((36.0*p213)+(21.0*p21*p31*(-13.0+(6.0*p31)))+(9.0*p212*(-13.0+(12.0*p31)))+(2.0*p312*(-91.0+(33.0*p31)))))+(-2.0*p30*p31*((54.0*p212)+(3.0*p31*(-91.0+(44.0*p31)))+(2.0*p21*(-91.0+(66.0*p31)))))+(-9.0*p11*((26.0*p21*p30)+(-8.0*p212*p30)+(4.0*p30*p312)+(p20*((9.0*p212)+(24.0*p21*p31)+(2.0*p31*(-13.0+(6.0*p31)))))))))))));
	accum[4] = ((1.0/12.0)*((-3.0*p012)+(2.0*p013)+((3.0+(-2.0*p31))*p312)));
	accum[5] = 0.0;
}
static void cube_11(double *pixel, double *accum, Curve<4,2> *curve)
{
	const double &p00 = curve->p[0].v[0];
	const double &p01 = curve->p[0].v[1];
	const double &p10 = curve->p[1].v[0];
	const double &p11 = curve->p[1].v[1];
	const double &p20 = curve->p[2].v[0];
	const double &p21 = curve->p[2].v[1];
	const double &p30 = curve->p[3].v[0];
	const double &p31 = curve->p[3].v[1];
	const double p002 = p00*p00;
	const double p012 = p01*p01;
	const double p102 = p10*p10;
	const double p112 = p11*p11;
	const double p202 = p20*p20;
	const double p212 = p21*p21;
	const double p302 = p30*p30;
	const double p312 = p31*p31;
	const double p003 = p00*p002;
	const double p013 = p01*p012;
	const double p103 = p10*p102;
	const double p113 = p11*p112;
	const double p203 = p20*p202;
	const double p213 = p21*p212;
	const double p303 = p30*p302;
	const double p313 = p31*p312;
	pixel[0] = ((1.0/18480.0)*((-1.0*p012*((378.0*p102)+(63.0*p202)+(30.0*p20*p30)+(5.0*p302)+(42.0*p10*((6.0*p20)+p30))))+(-924.0*((3.0*p11*p20)+(-3.0*p10*p21)+(3.0*p11*p30)+(6.0*p21*p30)+(p01*((6.0*p10)+(3.0*p20)+p30))+(p00*((10.0*p01)+(-6.0*p11)+(-3.0*p21)+(-1.0*p31)))+(-3.0*p10*p31)+(-6.0*p20*p31)+(-10.0*p30*p31)))+(-1.0*p002*((2310.0*p012)+(-378.0*p112)+(-63.0*p212)+(-30.0*p21*p31)+(-5.0*p312)+(-42.0*p11*((6.0*p21)+p31))+(-28.0*p01*((45.0*p11)+(9.0*p21)+p31))))+(22.0*((45.0*p01*p102)+(45.0*p01*p10*p20)+(27.0*p10*p11*p20)+(18.0*p01*p202)+(27.0*p11*p202)+(-27.0*p102*p21)+(-27.0*p10*p20*p21)+(12.0*p01*p10*p30)+(18.0*p10*p11*p30)+(15.0*p01*p20*p30)+(45.0*p11*p20*p30)+(45.0*p20*p21*p30)+(5.0*p01*p302)+(30.0*p11*p302)+(105.0*p21*p302)+(5.0*p002*((28.0*p01)+(-21.0*p11)+(-6.0*p21)+(-1.0*p31)))+(-18.0*p102*p31)+(-45.0*p10*p20*p31)+(-45.0*p202*p31)+(-30.0*p10*p30*p31)+(-105.0*p20*p30*p31)+(-140.0*p302*p31)+(p00*((-18.0*p20*p21)+(3.0*p11*p30)+(-3.0*p21*p30)+(5.0*p01*((21.0*p10)+(6.0*p20)+p30))+(-12.0*p20*p31)+(-5.0*p30*p31)+(-15.0*p10*((3.0*p11)+(3.0*p21)+p31))))))+(-2.0*p00*((-126.0*p10*p112)+(-189.0*p10*p11*p21)+(-54.0*p11*p20*p21)+(-81.0*p10*p212)+(-45.0*p20*p212)+(9.0*p112*p30)+(-9.0*p212*p30)+(14.0*p012*((45.0*p10)+(9.0*p20)+p30))+(-54.0*p10*p11*p31)+(-30.0*p11*p20*p31)+(-60.0*p10*p21*p31)+(-54.0*p20*p21*p31)+(-6.0*p11*p30*p31)+(-21.0*p21*p30*p31)+(-15.0*p10*p312)+(-21.0*p20*p312)+(-14.0*p30*p312)+(3.0*p01*((2.0*p21*p30)+(7.0*p11*((4.0*p20)+p30))+(-2.0*p20*p31)+(-7.0*p10*((4.0*p21)+p31))))))+(22.0*((27.0*p112*p20)+(-27.0*p10*p11*p21)+(27.0*p11*p20*p21)+(-27.0*p10*p212)+(18.0*p112*p30)+(45.0*p11*p21*p30)+(45.0*p212*p30)+(5.0*p012*((21.0*p10)+(6.0*p20)+p30))+(-18.0*p10*p11*p31)+(-45.0*p10*p21*p31)+(-45.0*p20*p21*p31)+(30.0*p11*p30*p31)+(105.0*p21*p30*p31)+(-30.0*p10*p312)+(-105.0*p20*p312)+(-280.0*p30*p312)+(p01*((45.0*p10*p11)+(45.0*p11*p20)+(18.0*p20*p21)+(15.0*p11*p30)+(12.0*p21*p30)+(-3.0*p10*p31)+(3.0*p20*p31)+(5.0*p30*p31)))+(p00*((280.0*p012)+(-45.0*p112)+(-45.0*p11*p21)+(-18.0*p212)+(-12.0*p11*p31)+(-15.0*p21*p31)+(-5.0*p312)+(-5.0*p01*((21.0*p11)+(6.0*p21)+p31))))))+(-2.0*p01*((45.0*p202*p21)+(54.0*p20*p21*p30)+(21.0*p21*p302)+(3.0*p11*((27.0*p202)+(20.0*p20*p30)+(5.0*p302)))+(9.0*p102*((14.0*p11)+(-1.0*p31)))+(9.0*p202*p31)+(21.0*p20*p30*p31)+(14.0*p302*p31)+(3.0*p10*((9.0*p11*((7.0*p20)+(2.0*p30)))+(2.0*((9.0*p20*p21)+(5.0*p21*p30)+(p30*p31)))))))+(3.0*((-3.0*p112*((15.0*p202)+(18.0*p20*p30)+(7.0*p302)))+(-2.0*p11*((27.0*p202*p21)+(42.0*p302*(p21+p31))+(7.0*p20*p30*((9.0*p21)+(4.0*p31)))))+(3.0*p102*((15.0*p212)+(18.0*p21*p31)+(7.0*p312)+(2.0*p11*((9.0*p21)+(5.0*p31)))))+(p10*((-6.0*p112*((9.0*p20)+(5.0*p30)))+(28.0*p30*p31*((2.0*p21)+(3.0*p31)))+(-36.0*p11*((p21*p30)+(-1.0*p20*p31)))+(6.0*p20*((9.0*p212)+(21.0*p21*p31)+(14.0*p312)))))+(14.0*((3.0*p202*p31*((2.0*p21)+(3.0*p31)))+(-6.0*p20*p30*(p212+(-5.0*p312)))+(p302*((-9.0*p212)+(-30.0*p21*p31)+(55.0*p312)))))))));
	accum[0] = ((1.0/4.0)*((-2.0*p01)+p012+(-1.0*(-2.0+p31)*p31)));
	accum[1] = 0.0;
	pixel[1] = ((1.0/240240.0)*((286.0*((-27.0*p10*p11*p20)+(-27.0*p11*p202)+(27.0*p102*p21)+(27.0*p10*p20*p21)+(-18.0*p10*p11*p30)+(-45.0*p11*p20*p30)+(-45.0*p20*p21*p30)+(-30.0*p11*p302)+(-105.0*p21*p302)+(-1.0*p01*((45.0*p102)+(45.0*p10*p20)+(18.0*p202)+(12.0*p10*p30)+(15.0*p20*p30)+(5.0*p302)))+(18.0*p102*p31)+(45.0*p10*p20*p31)+(45.0*p202*p31)+(30.0*p10*p30*p31)+(105.0*p20*p30*p31)+(140.0*p302*p31)+(5.0*p002*((-28.0*p01)+(21.0*p11)+(6.0*p21)+p31))+(p00*((18.0*p20*p21)+(-3.0*p11*p30)+(3.0*p21*p30)+(-5.0*p01*((21.0*p10)+(6.0*p20)+p30))+(12.0*p20*p31)+(5.0*p30*p31)+(15.0*p10*((3.0*p11)+(3.0*p21)+p31))))))+(13.0*((p012*((378.0*p102)+(63.0*p202)+(30.0*p20*p30)+(5.0*p302)+(42.0*p10*((6.0*p20)+p30))))+(p002*((2310.0*p012)+(-378.0*p112)+(-63.0*p212)+(-30.0*p21*p31)+(-5.0*p312)+(-42.0*p11*((6.0*p21)+p31))+(-28.0*p01*((45.0*p11)+(9.0*p21)+p31))))+(2.0*p00*((-126.0*p10*p112)+(-189.0*p10*p11*p21)+(-54.0*p11*p20*p21)+(-81.0*p10*p212)+(-45.0*p20*p212)+(9.0*p112*p30)+(-9.0*p212*p30)+(14.0*p012*((45.0*p10)+(9.0*p20)+p30))+(-54.0*p10*p11*p31)+(-30.0*p11*p20*p31)+(-60.0*p10*p21*p31)+(-54.0*p20*p21*p31)+(-6.0*p11*p30*p31)+(-21.0*p21*p30*p31)+(-15.0*p10*p312)+(-21.0*p20*p312)+(-14.0*p30*p312)+(3.0*p01*((2.0*p21*p30)+(7.0*p11*((4.0*p20)+p30))+(-2.0*p20*p31)+(-7.0*p10*((4.0*p21)+p31))))))+(2.0*p01*((45.0*p202*p21)+(54.0*p20*p21*p30)+(21.0*p21*p302)+(3.0*p11*((27.0*p202)+(20.0*p20*p30)+(5.0*p302)))+(9.0*p102*((14.0*p11)+(-1.0*p31)))+(9.0*p202*p31)+(21.0*p20*p30*p31)+(14.0*p302*p31)+(3.0*p10*((9.0*p11*((7.0*p20)+(2.0*p30)))+(2.0*((9.0*p20*p21)+(5.0*p21*p30)+(p30*p31)))))))+(-3.0*((-3.0*p112*((15.0*p202)+(18.0*p20*p30)+(7.0*p302)))+(-2.0*p11*((27.0*p202*p21)+(42.0*p302*(p21+p31))+(7.0*p20*p30*((9.0*p21)+(4.0*p31)))))+(3.0*p102*((15.0*p212)+(18.0*p21*p31)+(7.0*p312)+(2.0*p11*((9.0*p21)+(5.0*p31)))))+(p10*((-6.0*p112*((9.0*p20)+(5.0*p30)))+(28.0*p30*p31*((2.0*p21)+(3.0*p31)))+(-36.0*p11*((p21*p30)+(-1.0*p20*p31)))+(6.0*p20*((9.0*p212)+(21.0*p21*p31)+(14.0*p312)))))+(14.0*((3.0*p202*p31*((2.0*p21)+(3.0*p31)))+(-6.0*p20*p30*(p212+(-5.0*p312)))+(p302*((-9.0*p212)+(-30.0*p21*p31)+(55.0*p312)))))))))+(26.0*((126.0*p01*p103)+(189.0*p01*p102*p20)+(81.0*p102*p11*p20)+(135.0*p01*p10*p202)+(135.0*p10*p11*p202)+(45.0*p01*p203)+(81.0*p11*p203)+(-81.0*p103*p21)+(-135.0*p102*p20*p21)+(-81.0*p10*p202*p21)+(45.0*p01*p102*p30)+(45.0*p102*p11*p30)+(90.0*p01*p10*p20*p30)+(162.0*p10*p11*p20*p30)+(63.0*p01*p202*p30)+(189.0*p11*p202*p30)+(-27.0*p102*p21*p30)+(126.0*p202*p21*p30)+(21.0*p01*p10*p302)+(63.0*p10*p11*p302)+(42.0*p01*p20*p302)+(210.0*p11*p20*p302)+(42.0*p10*p21*p302)+(378.0*p20*p21*p302)+(14.0*p01*p303)+(126.0*p11*p303)+(630.0*p21*p303)+(14.0*p003*((55.0*p01)+(-45.0*p11)+(-9.0*p21)+(-1.0*p31)))+(-45.0*p103*p31)+(-135.0*p102*p20*p31)+(-189.0*p10*p202*p31)+(-126.0*p203*p31)+(-63.0*p102*p30*p31)+(-252.0*p10*p20*p30*p31)+(-378.0*p202*p30*p31)+(-126.0*p10*p302*p31)+(-630.0*p20*p302*p31)+(-770.0*p303*p31)+(p002*((-42.0*p11*p20)+(-63.0*p20*p21)+(-9.0*p21*p30)+(14.0*p01*((45.0*p10)+(9.0*p20)+p30))+(-21.0*p20*p31)+(-5.0*p30*p31)+(-42.0*p10*((9.0*p11)+(5.0*p21)+p31))))+(p00*((27.0*p11*p202)+(-45.0*p202*p21)+(30.0*p11*p20*p30)+(-18.0*p20*p21*p30)+(9.0*p11*p302)+(p01*((378.0*p102)+(63.0*p202)+(30.0*p20*p30)+(5.0*p302)+(42.0*p10*((6.0*p20)+p30))))+(-45.0*p202*p31)+(-42.0*p20*p30*p31)+(-14.0*p302*p31)+(-63.0*p102*((2.0*p11)+(3.0*p21)+p31))+(-6.0*p10*((3.0*p20*((9.0*p21)+(5.0*p31)))+(p30*((-3.0*p11)+(5.0*(p21+p31))))))))))+(2.0*((-324.0*p102*p112*p20)+(-486.0*p10*p112*p202)+(-243.0*p112*p203)+(324.0*p103*p11*p21)+(243.0*p102*p11*p20*p21)+(-243.0*p10*p11*p202*p21)+(-324.0*p11*p203*p21)+(243.0*p103*p212)+(486.0*p102*p20*p212)+(324.0*p10*p202*p212)+(-162.0*p102*p112*p30)+(-486.0*p10*p112*p20*p30)+(-432.0*p112*p202*p30)+(-81.0*p102*p11*p21*p30)+(-648.0*p10*p11*p20*p21*p30)+(-972.0*p11*p202*p21*p30)+(108.0*p102*p212*p30)+(-486.0*p202*p212*p30)+(-144.0*p10*p112*p302)+(-324.0*p112*p20*p302)+(-324.0*p10*p11*p21*p302)+(-1134.0*p11*p20*p21*p302)+(-162.0*p10*p212*p302)+(-1188.0*p20*p212*p302)+(-108.0*p112*p303)+(-594.0*p11*p21*p303)+(-1188.0*p212*p303)+(-1.0*p012*((594.0*p103)+(72.0*p203)+(63.0*p202*p30)+(24.0*p20*p302)+(4.0*p303)+(108.0*p102*((6.0*p20)+p30))+(3.0*p10*((108.0*p202)+(48.0*p20*p30)+(7.0*p302)))))+(162.0*p103*p11*p31)+(324.0*p102*p11*p20*p31)+(216.0*p10*p11*p202*p31)+(243.0*p103*p21*p31)+(756.0*p102*p20*p21*p31)+(972.0*p10*p202*p21*p31)+(486.0*p203*p21*p31)+(72.0*p102*p11*p30*p31)+(-324.0*p11*p202*p30*p31)+(324.0*p102*p21*p30*p31)+(972.0*p10*p20*p21*p30*p31)+(594.0*p202*p21*p30*p31)+(-108.0*p10*p11*p302*p31)+(-792.0*p11*p20*p302*p31)+(198.0*p10*p21*p302*p31)+(-1188.0*p20*p21*p302*p31)+(-792.0*p11*p303*p31)+(-5148.0*p21*p303*p31)+(72.0*p103*p312)+(324.0*p102*p20*p312)+(648.0*p10*p202*p312)+(594.0*p203*p312)+(216.0*p102*p30*p312)+(1188.0*p10*p20*p30*p312)+(2376.0*p202*p30*p312)+(792.0*p10*p302*p312)+(5148.0*p20*p302*p312)+(8008.0*p303*p312)+(-2.0*p003*((4004.0*p012)+(-594.0*p112)+(-33.0*p01*((78.0*p11)+(12.0*p21)+p31))+(-9.0*p11*((33.0*p21)+(4.0*p31)))+(-2.0*((27.0*p212)+(9.0*p21*p31)+p312))))+(-3.0*p01*((81.0*p11*p203)+(54.0*p203*p21)+(99.0*p11*p202*p30)+(96.0*p202*p21*p30)+(52.0*p11*p20*p302)+(72.0*p20*p21*p302)+(12.0*p11*p303)+(24.0*p21*p303)+(6.0*p103*((27.0*p11)+(-2.0*p31)))+(12.0*p203*p31)+(36.0*p202*p30*p31)+(42.0*p20*p302*p31)+(22.0*p303*p31)+(3.0*p102*((24.0*p20*p21)+(12.0*p21*p30)+(4.0*p11*((27.0*p20)+(7.0*p30)))+(-3.0*p20*p31)+(p30*p31)))+(p10*((3.0*p11*((84.0*p202)+(54.0*p20*p30)+(11.0*p302)))+(9.0*p202*((12.0*p21)+p31))+(12.0*p20*p30*((9.0*p21)+(2.0*p31)))+(4.0*p302*((8.0*p21)+(3.0*p31)))))))+(-1.0*p002*((-1188.0*p10*p112)+(-162.0*p112*p20)+(-1134.0*p10*p11*p21)+(-324.0*p11*p20*p21)+(-324.0*p10*p212)+(-144.0*p20*p212)+(-36.0*p11*p21*p30)+(-27.0*p212*p30)+(66.0*p012*((78.0*p10)+(12.0*p20)+p30))+(-216.0*p10*p11*p31)+(-96.0*p11*p20*p31)+(-156.0*p10*p21*p31)+(-99.0*p20*p21*p31)+(-18.0*p11*p30*p31)+(-27.0*p21*p30*p31)+(-24.0*p10*p312)+(-21.0*p20*p312)+(-8.0*p30*p312)+(-2.0*p01*((-99.0*p11*p20)+(54.0*p20*p21)+(-27.0*p11*p30)+(18.0*p20*p31)+(2.0*p30*p31)+(9.0*p10*((66.0*p11)+(44.0*p21)+(7.0*p31)))))))+(-1.0*p00*((4.0*p012*((594.0*p102)+(9.0*p10*((33.0*p20)+(4.0*p30)))+(2.0*((27.0*p202)+(9.0*p20*p30)+p302))))+(p01*((72.0*p202*p21)+(72.0*p20*p21*p30)+(18.0*p21*p302)+(3.0*p11*((108.0*p202)+(56.0*p20*p30)+(9.0*p302)))+(-9.0*p202*p31)+(6.0*p20*p30*p31)+(4.0*p302*p31)+(6.0*p10*((8.0*p21*p30)+(18.0*p11*((9.0*p20)+(2.0*p30)))+(-1.0*((12.0*p20)+p30)*p31)))+(54.0*p102*((11.0*p11)+(-2.0*((3.0*p21)+p31))))))+(-3.0*((54.0*p202*p212)+(24.0*p20*p212*p30)+(-9.0*p112*(((2.0*p20)+p30)*((2.0*p20)+p30)))+(84.0*p202*p21*p31)+(72.0*p20*p21*p30*p31)+(18.0*p21*p302*p31)+(36.0*p202*p312)+(48.0*p20*p30*p312)+(22.0*p302*p312)+(p11*((-12.0*p21*p302)+(-2.0*p20*p30*((9.0*p21)+(-8.0*p31)))+(9.0*p202*((3.0*p21)+(4.0*p31)))))+(3.0*p102*((54.0*p112)+(48.0*p212)+(33.0*p21*p31)+(7.0*p312)+(4.0*p11*((27.0*p21)+(8.0*p31)))))+(2.0*p10*((-12.0*p112*p30)+(2.0*p30*((9.0*p212)+(14.0*p21*p31)+(6.0*p312)))+(3.0*p20*((27.0*p212)+(27.0*p21*p31)+(8.0*p312)))+(3.0*p11*((18.0*p20*((2.0*p21)+p31))+(p30*((3.0*p21)+(4.0*p31)))))))))))))));
	accum[2] = ((1.0/6.0)*((2.0*p01)+(-1.0*p012)+((-2.0+p31)*p31)));
	accum[3] = ((1.0/4.0)*((-2.0*p01)+p012+(-1.0*(-2.0+p31)*p31)));
	pixel[2] = ((1.0/240240.0)*((286.0*((-27.0*p112*p20)+(27.0*p10*p11*p21)+(-27.0*p11*p20*p21)+(27.0*p10*p212)+(-18.0*p112*p30)+(-45.0*p11*p21*p30)+(-45.0*p212*p30)+(-5.0*p012*((21.0*p10)+(6.0*p20)+p30))+(18.0*p10*p11*p31)+(45.0*p10*p21*p31)+(45.0*p20*p21*p31)+(-30.0*p11*p30*p31)+(-105.0*p21*p30*p31)+(30.0*p10*p312)+(105.0*p20*p312)+(280.0*p30*p312)+(-1.0*p01*((45.0*p10*p11)+(45.0*p11*p20)+(18.0*p20*p21)+(15.0*p11*p30)+(12.0*p21*p30)+(-3.0*p10*p31)+(3.0*p20*p31)+(5.0*p30*p31)))+(p00*((-280.0*p012)+(45.0*p112)+(45.0*p11*p21)+(18.0*p212)+(12.0*p11*p31)+(15.0*p21*p31)+(5.0*p312)+(5.0*p01*((21.0*p11)+(6.0*p21)+p31))))))+(26.0*((14.0*p013*((45.0*p10)+(9.0*p20)+p30))+(p012*((63.0*p20*p21)+(42.0*p10*((9.0*p11)+p21))+(21.0*p21*p30)+(42.0*p11*((5.0*p20)+p30))+(9.0*p20*p31)+(5.0*p30*p31)))+(p01*((45.0*p20*p212)+(45.0*p212*p30)+(63.0*p112*((3.0*p20)+p30))+(18.0*p20*p21*p31)+(42.0*p21*p30*p31)+(14.0*p30*p312)+(6.0*p11*((27.0*p20*p21)+(15.0*p21*p30)+(5.0*p20*p31)+(5.0*p30*p31)))+(3.0*p10*((42.0*p112)+(-9.0*p212)+(-6.0*p11*p31)+(-10.0*p21*p31)+(-3.0*p312)))))+(p00*((2310.0*p013)+(-126.0*p113)+(-189.0*p112*p21)+(-135.0*p11*p212)+(-45.0*p213)+(-45.0*p112*p31)+(-90.0*p11*p21*p31)+(-63.0*p212*p31)+(-21.0*p11*p312)+(-42.0*p21*p312)+(-14.0*p313)+(-14.0*p012*((45.0*p11)+(9.0*p21)+p31))+(-1.0*p01*((378.0*p112)+(63.0*p212)+(30.0*p21*p31)+(5.0*p312)+(42.0*p11*((6.0*p21)+p31))))))+(-3.0*((-3.0*p113*((9.0*p20)+(5.0*p30)))+(-3.0*p112*((-9.0*p10*p21)+(15.0*p20*p21)+(15.0*p21*p30)+(-5.0*p10*p31)+(3.0*p20*p31)+(7.0*p30*p31)))+(p10*((27.0*p213)+(63.0*p212*p31)+(70.0*p21*p312)+(42.0*p313)))+(14.0*((-3.0*p213*p30)+(3.0*p212*(p20+(-3.0*p30))*p31)+(3.0*p21*((3.0*p20)+(-5.0*p30))*p312)+(5.0*((3.0*p20)+(11.0*p30))*p313)))+(p11*((-21.0*p30*((3.0*p212)+(4.0*p21*p31)+(2.0*p312)))+(3.0*p10*((15.0*p212)+(18.0*p21*p31)+(7.0*p312)))+(p20*((-27.0*p212)+(14.0*p312)))))))))+(13.0*((p012*((378.0*p102)+(63.0*p202)+(30.0*p20*p30)+(5.0*p302)+(42.0*p10*((6.0*p20)+p30))))+(p002*((2310.0*p012)+(-378.0*p112)+(-63.0*p212)+(-30.0*p21*p31)+(-5.0*p312)+(-42.0*p11*((6.0*p21)+p31))+(-28.0*p01*((45.0*p11)+(9.0*p21)+p31))))+(2.0*p00*((-126.0*p10*p112)+(-189.0*p10*p11*p21)+(-54.0*p11*p20*p21)+(-81.0*p10*p212)+(-45.0*p20*p212)+(9.0*p112*p30)+(-9.0*p212*p30)+(14.0*p012*((45.0*p10)+(9.0*p20)+p30))+(-54.0*p10*p11*p31)+(-30.0*p11*p20*p31)+(-60.0*p10*p21*p31)+(-54.0*p20*p21*p31)+(-6.0*p11*p30*p31)+(-21.0*p21*p30*p31)+(-15.0*p10*p312)+(-21.0*p20*p312)+(-14.0*p30*p312)+(3.0*p01*((2.0*p21*p30)+(7.0*p11*((4.0*p20)+p30))+(-2.0*p20*p31)+(-7.0*p10*((4.0*p21)+p31))))))+(2.0*p01*((45.0*p202*p21)+(54.0*p20*p21*p30)+(21.0*p21*p302)+(3.0*p11*((27.0*p202)+(20.0*p20*p30)+(5.0*p302)))+(9.0*p102*((14.0*p11)+(-1.0*p31)))+(9.0*p202*p31)+(21.0*p20*p30*p31)+(14.0*p302*p31)+(3.0*p10*((9.0*p11*((7.0*p20)+(2.0*p30)))+(2.0*((9.0*p20*p21)+(5.0*p21*p30)+(p30*p31)))))))+(-3.0*((-3.0*p112*((15.0*p202)+(18.0*p20*p30)+(7.0*p302)))+(-2.0*p11*((27.0*p202*p21)+(42.0*p302*(p21+p31))+(7.0*p20*p30*((9.0*p21)+(4.0*p31)))))+(3.0*p102*((15.0*p212)+(18.0*p21*p31)+(7.0*p312)+(2.0*p11*((9.0*p21)+(5.0*p31)))))+(p10*((-6.0*p112*((9.0*p20)+(5.0*p30)))+(28.0*p30*p31*((2.0*p21)+(3.0*p31)))+(-36.0*p11*((p21*p30)+(-1.0*p20*p31)))+(6.0*p20*((9.0*p212)+(21.0*p21*p31)+(14.0*p312)))))+(14.0*((3.0*p202*p31*((2.0*p21)+(3.0*p31)))+(-6.0*p20*p30*(p212+(-5.0*p312)))+(p302*((-9.0*p212)+(-30.0*p21*p31)+(55.0*p312)))))))))+(2.0*((-2.0*p013*((594.0*p102)+(9.0*p10*((33.0*p20)+(4.0*p30)))+(2.0*((27.0*p202)+(9.0*p20*p30)+p302))))+(-1.0*p012*((144.0*p202*p21)+(54.0*p102*((22.0*p11)+(3.0*p21)))+(99.0*p20*p21*p30)+(21.0*p21*p302)+(12.0*p11*((27.0*p202)+(13.0*p20*p30)+(2.0*p302)))+(27.0*p202*p31)+(27.0*p20*p30*p31)+(8.0*p302*p31)+(6.0*p10*((54.0*p20*p21)+(16.0*p21*p30)+(9.0*p11*((21.0*p20)+(4.0*p30)))+(6.0*p20*p31)+(3.0*p30*p31)))))+(-3.0*p01*((54.0*p202*p212)+(84.0*p20*p212*p30)+(36.0*p212*p302)+(3.0*p112*((48.0*p202)+(33.0*p20*p30)+(7.0*p302)))+(24.0*p202*p21*p31)+(72.0*p20*p21*p30*p31)+(48.0*p21*p302*p31)+(18.0*p20*p30*p312)+(22.0*p302*p312)+(3.0*p102*((54.0*p112)+(-8.0*p11*p31)+(-3.0*(((2.0*p21)+p31)*((2.0*p21)+p31)))))+(2.0*p11*((12.0*p302*((2.0*p21)+p31))+(9.0*p202*((9.0*p21)+(2.0*p31)))+(p20*p30*((81.0*p21)+(28.0*p31)))))+(p10*((12.0*p112*((27.0*p20)+(8.0*p30)))+(4.0*p21*p30*((9.0*p21)+(4.0*p31)))+(6.0*p11*((36.0*p20*p21)+(18.0*p21*p30)+(3.0*p20*p31)+(4.0*p30*p31)))+(3.0*p20*((9.0*p212)+(-6.0*p21*p31)+(-4.0*p312)))))))+(-1.0*p002*((12012.0*p013)+(-594.0*p113)+(-72.0*p213)+(-63.0*p212*p31)+(-24.0*p21*p312)+(-4.0*p313)+(-108.0*p112*((6.0*p21)+p31))+(-66.0*p012*((78.0*p11)+(12.0*p21)+p31))+(-3.0*p11*((108.0*p212)+(48.0*p21*p31)+(7.0*p312)))+(-4.0*p01*((594.0*p112)+(9.0*p11*((33.0*p21)+(4.0*p31)))+(2.0*((27.0*p212)+(9.0*p21*p31)+p312))))))+(-1.0*p00*((66.0*p013*((78.0*p10)+(12.0*p20)+p30))+(2.0*p012*((396.0*p11*p20)+(54.0*p20*p21)+(63.0*p11*p30)+(18.0*p21*p30)+(9.0*p10*((66.0*p11)+(-11.0*p21)+(-3.0*p31)))+(2.0*p30*p31)))+(-1.0*p01*((72.0*p20*p212)+(-9.0*p212*p30)+(-108.0*p112*((3.0*p20)+p30))+(72.0*p20*p21*p31)+(6.0*p21*p30*p31)+(18.0*p20*p312)+(4.0*p30*p312)+(-6.0*p11*((12.0*p21*p30)+(-8.0*p20*p31)+(p30*p31)))+(3.0*p10*((198.0*p112)+(108.0*p212)+(56.0*p21*p31)+(9.0*p312)+(36.0*p11*((9.0*p21)+(2.0*p31)))))))+(-3.0*((54.0*p20*p213)+(-12.0*p113*p30)+(12.0*p213*p30)+(96.0*p20*p212*p31)+(36.0*p212*p30*p31)+(72.0*p20*p21*p312)+(42.0*p21*p30*p312)+(24.0*p20*p313)+(22.0*p30*p313)+(3.0*p112*((p30*((-3.0*p21)+p31))+(12.0*p20*((2.0*p21)+p31))))+(p11*((3.0*p30*((3.0*p212)+(8.0*p21*p31)+(4.0*p312)))+(4.0*p20*((27.0*p212)+(27.0*p21*p31)+(8.0*p312)))))+(p10*((162.0*p113)+(81.0*p213)+(99.0*p212*p31)+(52.0*p21*p312)+(12.0*p313)+(12.0*p112*((27.0*p21)+(7.0*p31)))+(3.0*p11*((84.0*p212)+(54.0*p21*p31)+(11.0*p312)))))))))+(3.0*((-3.0*p113*((27.0*p202)+(27.0*p20*p30)+(8.0*p302)))+(-18.0*p112*((2.0*p302*((3.0*p21)+(2.0*p31)))+(p202*((9.0*p21)+(2.0*p31)))+(2.0*p20*p30*((7.0*p21)+(3.0*p31)))))+(-6.0*p11*((9.0*p202*((2.0*p212)+(-1.0*p312)))+(p20*p30*((54.0*p212)+(54.0*p21*p31)+(11.0*p312)))+(2.0*p302*((18.0*p212)+(33.0*p21*p31)+(22.0*p312)))))+(3.0*p102*((18.0*p112*((2.0*p21)+p31))+(2.0*p11*((27.0*p212)+(27.0*p21*p31)+(8.0*p312)))+(3.0*((9.0*p213)+(16.0*p212*p31)+(12.0*p21*p312)+(4.0*p313)))))+(2.0*((9.0*p202*p31*((9.0*p212)+(22.0*p21*p31)+(22.0*p312)))+(-11.0*p302*((9.0*p213)+(36.0*p212*p31)+(78.0*p21*p312)+(-182.0*p313)))+(3.0*p20*p30*((-27.0*p213)+(-33.0*p212*p31)+(66.0*p21*p312)+(286.0*p313)))))+(-3.0*p10*((18.0*p113*((2.0*p20)+p30))+(p112*((27.0*p20*p21)+(36.0*p21*p30)+(-9.0*p20*p31)+(8.0*p30*p31)))+(-3.0*p11*((4.0*p30*((-2.0*p212)+p312))+(3.0*p20*((3.0*p212)+(8.0*p21*p31)+(4.0*p312)))))+(-2.0*((2.0*p30*p31*((9.0*p212)+(22.0*p21*p31)+(22.0*p312)))+(3.0*p20*((6.0*p213)+(18.0*p212*p31)+(21.0*p21*p312)+(11.0*p313)))))))))))));
	accum[4] = ((1.0/12.0)*((-3.0*p012)+(2.0*p013)+((3.0+(-2.0*p31))*p312)));
	accum[5] = 0.0;
}

//=============================================================================//
//=========================== Rational Quadratics =============================//
//=============================================================================//

static void rquad(double *pixel, double *accum, Curve<3,3> *curve)
{
}

//=============================================================================//
//============================== Constructors =================================//
//=============================================================================//

template<>
FilterTent<2>::FilterTent()
{
	filter22[filter_elem_flip<W>(0,0)] = line_00;
	filter22[filter_elem_flip<W>(1,0)] = line_10;
	filter22[filter_elem_flip<W>(0,1)] = line_01;
	filter22[filter_elem_flip<W>(1,1)] = line_11;

	filter32[filter_elem_flip<W>(0,0)] = quad_00;
	filter32[filter_elem_flip<W>(1,0)] = quad_10;
	filter32[filter_elem_flip<W>(0,1)] = quad_01;
	filter32[filter_elem_flip<W>(1,1)] = quad_11;

	filter42[filter_elem_flip<W>(0,0)] = cube_00;
	filter42[filter_elem_flip<W>(1,0)] = cube_10;
	filter42[filter_elem_flip<W>(0,1)] = cube_01;
	filter42[filter_elem_flip<W>(1,1)] = cube_11;

	filter33[filter_elem_flip<W>(0,0)] = rquad;
	filter33[filter_elem_flip<W>(1,0)] = rquad;
	filter33[filter_elem_flip<W>(0,1)] = rquad;
	filter33[filter_elem_flip<W>(1,1)] = rquad;
}
